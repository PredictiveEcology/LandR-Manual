[{"path":"index.html","id":"preface","chapter":"Preface","heading":"Preface","text":"LandR collection SpaDES modules (see Chubaty & McIntire 2019) aimed \nsimulating forest dynamics across large spatial scales, taking \naccount various disturbances affect (e.g., wildfire climate\nchange), well interactions components forest systems, \nbird communities ungulates (via changes habitat species),\ncarbon cycling.present manual “live” document, grows changes according \nexisting number LandR modules, well development. addition,\n“sub-manuals” may produced describing particular collections LandR modules\nused simulation project group similar modules – e.g., LandR\nBiomass manual describe LandR modules essential \nsimulation vegetation components forest succession, excluding\ndisturbances carbon cycling.manual cover SpaDES toolkit, use create run\nLandR modules. learn SpaDES go SpaDES\nwebpage.Previous versions:LandR Manual v1.0.0LandR Manual v1.0.1LandR Manual v1.0.2","code":""},{"path":"landr-biomass_core-module.html","id":"landr-biomass_core-module","chapter":"1 LandR Biomass_core Module","heading":"1 LandR Biomass_core Module","text":"","code":""},{"path":"landr-biomass_core-module.html","id":"authors","chapter":"1 LandR Biomass_core Module","heading":"1.0.0.1 Authors:","text":"Yong Luo yluo1@lakeheadu.ca [aut], Eliot J B McIntire eliot.mcintire@nrcan-rncan.gc.ca [aut, cre], Ceres Barros ceres.barros@ubc.ca [aut], Alex M. Chubaty achubaty@-cast.ca [aut], Ian Eddy ian.eddy@nrcan-rncan.gc.ca [ctb], Jean Marchal jean.d.marchal@gmail.com [ctb]\ndocumentation work progress. Potential discrepancies omissions\nmay exist time . find , contact us using “Get help”\nlink .","code":""},{"path":"landr-biomass_core-module.html","id":"module-overview","chapter":"1 LandR Biomass_core Module","heading":"1.1 Module Overview","text":"","code":""},{"path":"landr-biomass_core-module.html","id":"quick-links","chapter":"1 LandR Biomass_core Module","heading":"1.1.1 Quick links","text":"General functioningGeneral functioningList input objectsList input objectsList parametersList parametersList outputsList outputsSimulation flow module eventsSimulation flow module events","code":""},{"path":"landr-biomass_core-module.html","id":"summary","chapter":"1 LandR Biomass_core Module","heading":"1.1.2 Summary","text":"LandR Biomass_core (hereafter Biomass_core) core forest succession\nsimulation module LandR ecosystem SpaDES modules (see Chubaty & McIntire 2019). simulates tree cohort ageing, growth, mortality \ncompetition light resources, well seed dispersal (Fig.\n1.1), spatially explicit manner using yearly\ntime step. model based LANDIS-II Biomass Succession Extension\nv.3.2.1 (LBSE, Scheller & Miranda 2015b), changes (see Differences\nBiomass_core LBSE). Nonetheless, \nessential functioning succession model still largely follows \nLANDIS-II counterpart, refer reader corresponding LBSE manual\n(Scheller & Miranda 2015b) detailed reading mechanisms implemented \nmodel.\nFigure 1.1: Biomass_core simulates tree cohort growth, mortality, recruitment dispersal dynamics, function cohort ageing competition light (shading) space, well disturbances like fire (simulated using modules).\n","code":""},{"path":"landr-biomass_core-module.html","id":"links-modules","chapter":"1 LandR Biomass_core Module","heading":"1.1.3 Links to other modules","text":"Biomass_core intended used data/calibration modules, disturbance\nmodules validation modules, amongst others. following list \nmodules commonly used Biomass_core. yet LandR\nManual see individual module’s\ndocumentation (.Rmd file) available repository.See \navailable modules select Biomass_core drop-menu see\nlinkages.Data calibration modules:Biomass_speciesData:\ngrabs merges several sources species cover data, making species\npercent cover (% cover) layers used LandR Biomass\nmodules. Default source data spans entire Canadian territory;Biomass_speciesData:\ngrabs merges several sources species cover data, making species\npercent cover (% cover) layers used LandR Biomass\nmodules. Default source data spans entire Canadian territory;Biomass_borealDataPrep:\nprepares parameters inputs (including initial landscape conditions)\nBiomass_core needs run realistic simulation. Default\nvalues/inputs produced relevant boreal forests Western Canada;Biomass_borealDataPrep:\nprepares parameters inputs (including initial landscape conditions)\nBiomass_core needs run realistic simulation. Default\nvalues/inputs produced relevant boreal forests Western Canada;Biomass_speciesParameters:\ncalibrates four-species level traits using permanent sample plot data (.e.,\nrepeated tree biomass measurements) across Western Canada.Biomass_speciesParameters:\ncalibrates four-species level traits using permanent sample plot data (.e.,\nrepeated tree biomass measurements) across Western Canada.Disturbance-related modules:Biomass_regeneration:\nsimulates cohort biomass responses stand-replacing fires (LBSE),\nincluding cohort mortality regeneration resprouting /\nserotiny;Biomass_regeneration:\nsimulates cohort biomass responses stand-replacing fires (LBSE),\nincluding cohort mortality regeneration resprouting /\nserotiny;Biomass_regenerationPM:\nlike Biomass_regeneration, allowing partial mortality. Based \nLANDIS-II Dynamic Fuels & Fire System extension (Sturtevant et al. 2018);Biomass_regenerationPM:\nlike Biomass_regeneration, allowing partial mortality. Based \nLANDIS-II Dynamic Fuels & Fire System extension (Sturtevant et al. 2018);fireSense: climate- land-cover-sensitive fire model simulating fire\nignition, escape spread processes function climate \nland-cover. Includes built-parameterisation processes using\nclimate, land-cover, fire occurrence fire perimeter data. Requires using\nBiomass_regeneration Biomass_regenerationPM. See modules prefixed\n“fireSense_” https://github.com/PredictiveEcology/;fireSense: climate- land-cover-sensitive fire model simulating fire\nignition, escape spread processes function climate \nland-cover. Includes built-parameterisation processes using\nclimate, land-cover, fire occurrence fire perimeter data. Requires using\nBiomass_regeneration Biomass_regenerationPM. See modules prefixed\n“fireSense_” https://github.com/PredictiveEcology/;LandMine: wildfire\nignition cover-sensitive wildfire spread model based fire return\ninterval input. Requires using Biomass_regeneration \nBiomass_regenerationPM;LandMine: wildfire\nignition cover-sensitive wildfire spread model based fire return\ninterval input. Requires using Biomass_regeneration \nBiomass_regenerationPM;scfm: spatially explicit fire\nspread module parameterised modelled stochastic three-part process\nignition, escape, spread. Requires using Biomass_regeneration \nBiomass_regenerationPM.scfm: spatially explicit fire\nspread module parameterised modelled stochastic three-part process\nignition, escape, spread. Requires using Biomass_regeneration \nBiomass_regenerationPM.Validation modules:Biomass_validationKNN:\ncalculates two validation metrics (mean absolute deviation sum \nnegative log-likelihoods) species presences/absences biomass-related\nproperties across simulated landscape. default, uses \nindependent dataset species % cover stand biomass \n2011, assuming second snapshot landscape.","code":""},{"path":"landr-biomass_core-module.html","id":"module-manual","chapter":"1 LandR Biomass_core Module","heading":"1.2 Module manual","text":"","code":""},{"path":"landr-biomass_core-module.html","id":"general-functioning","chapter":"1 LandR Biomass_core Module","heading":"1.2.1 General functioning","text":"Biomass_core forest landscape model based LANDIS-II Biomass\nSuccession Extension v.3.2.1 model (LBSE, Scheller & Miranda 2015b). core\nforest succession model LandR ecosystem SpaDES modules. Similarly \nLBSE, Biomass_core simulates changes tree cohort aboveground biomass\n(\\(g/m^2\\)) calculating growth, mortality recruitment functions pixel\nspecies characteristics, competition disturbances (Fig.\n1.1). Note , default, cohorts unique\ncombinations species age, can changed via \ncohortDefinitionCols parameter (see List parameters).Specifically, cohort growth driven invariant (growth shape parameter,\ngrowthcurve) spatio-temporally varying species traits (maximum biomass,\nmaxB, maximum annual net primary productivity, maxANPP), \nbackground mortality (.e., caused disturbances) depends \ninvariant species traits (longevity mortality shape parameter,\nmortalityshape). five traits directly influence realised shape\nspecies growth curves, determining fast grow (growthcurve \nmaxANPP), soon age mortality starts respect longevity\n(mortalityshape) biomass cohort can potentially achieve (maxB).Cohort recruitment determined available “space” (.e., pixel shade),\ninvariant species traits (regeneration mode, postfireregen, age maturity,\nsexualmature, shade tolerance, shadetolerance) third spatio-temporally\nvarying trait (species establishment probability, establishprob, called SEP\nhereafter). available “growing space” calculated species’ maxB\nminus occupied biomass (summed across cohorts pixel). \n“space”, cohort can establish one three recruitment modes:\nserotiny, resprouting germination.Disturbances (e.g., fire) can cause cohort mortality trigger\npost-disturbance regeneration. Two post-disturbance regeneration mechanisms \nimplemented, following LBSE: serotiny resprouting\n(Scheller & Miranda 2015b). Post-disturbance mortality regeneration occur\nresponse fire simulated two separate, interchangeable\nmodules, Biomass_regeneration Biomass_regenerationPM differ \nrespect level post-fire mortality simulate (complete partial\nmortality, respectively).Cohort germination (also called cohort establishment) occurs seeds \navailable local sources (pixel), via seed dispersal. Seed dispersal\ncan three modes: ‘dispersal’, ‘universal dispersal’ (arguably, \ninteresting dummy case studies) ‘ward dispersal’ (Scheller & Miranda 2015b).\nBriefly, ‘ward dispersal’ algorithm describes flexible kernel \ncalculates probability species colonising neighbour pixel \nfunction distance source dispersal-related (invariant)\nspecies traits, used default.Finally, germination regeneration success depend species’\nprobability germination given pixel (probabilities \ngermination).refer reader Scheller & Miranda (2015b), Scheller & Domingo (2011) \nScheller & Domingo (2012) details respect mentioned\nmechanisms implemented Biomass_core. later section manual, \nhighlight existing differences Biomass_core \nLBSE, together comparisons two\nmodules.","code":""},{"path":"landr-biomass_core-module.html","id":"init-inputs-params","chapter":"1 LandR Biomass_core Module","heading":"1.2.2 Initialisation, inputs and parameters","text":"initialise simulate forest dynamics given landscape,\nBiomass_core requires number inputs parameters namely:initial cohort biomass age values across landscape;initial cohort biomass age values across landscape;invariant species traits values;invariant species traits values;spatio-temporally varying species traits values (just\nspatially-varying);spatio-temporally varying species traits values (just\nspatially-varying);location- (ecolocation-) specific parameters;location- (ecolocation-) specific parameters;probabilities germination given species’ shade\ntolerance site shade.probabilities germination given species’ shade\ntolerance site shade.detailed full list input objects.\nBiomass_borealDataPrep module manual also provides information \nestimation many traits/inputs available data, \nadjustment using published values best knowledge boreal forest\ndynamics Western Canada.Unlike initialisation LBSE1, Biomass_core initialises\nsimulation using data-derived initial cohort biomass age. \ninformation ideally supplied data calibration modules like\nBiomass_borealDataPrep (Links modules), \nBiomass_core can also initialise using theoretical data.Similarly, although Biomass_core can create necessary traits \nparameters using theoretical values, realistic simulations \nprovided data calibration modules, like Biomass_borealDataPrep \nBiomass_speciesParameters. advise future users developers become\nfamiliar data modules try create modules (\nmodify existing ones) purpose.","code":""},{"path":"landr-biomass_core-module.html","id":"initial-objs","chapter":"1 LandR Biomass_core Module","heading":"1.2.2.1 Initial cohort biomass and age","text":"Initial cohort biomass age derived stand biomass (biomassMap\nraster layer), stand age (standAgeMap raster layer) species %\ncover (speciesLayers raster layers) data (see Table\n1.5) formatted cohortData\nobject. cohortData table central simulation object tracks \ncurrent year’s cohort biomass, age, mortality (lost biomass) aboveground net\nprimary productivity (ANPP) per species pixel group (pixelGroup). \nstart simulation, cohortData values cohort\nmortality ANPP.pixelGroup collection pixels share ecolocation\n(coded ecoregionMap raster layer) cohort composition. \ndefault, ecolocation combination land-cover ecological zonation\n(see ecoregionMap full list inputs) unique\ncohort compositions defined unique combinations species, age \nbiomass. cohortData table therefore always associated current\nyear’s pixelGroupMap raster layer, provides spatial location \npixelGroups, allowing “spatialise” cohort information dynamics (e.g.,\ndispersal) pixel pixel basis (see also\nHashing).user, another module, may provide initial cohortData \npixelGroupMap objects start simulation, input objects necessary\nproduce : study area polygon (studyArea), biomassMap,\nstandAgeMap, speciesLayers ecoregionMap raster layers (see list\ninput objects detail).","code":""},{"path":"landr-biomass_core-module.html","id":"invariant-traits","chapter":"1 LandR Biomass_core Module","heading":"1.2.2.2 Invariant species traits","text":"spatio-temporally constant traits mostly influence population\ndynamics (e.g., growth, mortality, dispersal) responses fire (fire\ntolerance regeneration).default, Biomass_core obtains trait values available LANDIS-II tables\n(see Table 1.5), traits can \nadjusted/supplied user modules. instance, using\nBiomass_borealDataPrep adjust trait values Western Canadian\nboreal forests (e.g., longevity values adjusted following Burton & Cumming 1995a), using Biomass_speciesParameters calibrates \ngrowthcurve mortalityshape parameters estimates two additional\nspecies traits (inflationFactor mANPPproportion) calibrate maxB \nmaxANPP (respectively).Table 1.1 shows example table invariant\nspecies traits. Note Biomass_core (alone) requires columns Table\n1.1 present, exception \nfiretolerance, postfireregen, resproutprob, resproutage_min \nresproutage_max, used post-fire regeneration modules\n(Biomass_regeneration Biomass_regenerationPM).Please see Scheller & Domingo (2011) Scheller & Miranda (2015b) \ndetail.\nTable 1.1: Example invariant species traits table (species table object module), species Abies sp. (Abie_sp), Picea engelmannii (Pice_eng), Picea glauca (Pice_gla), Pinus sp. (Pinu_sp), Populus sp. (Popu_sp) Pseudotsuga menziesii (Pseu_men). Note theoretical values.\n","code":""},{"path":"landr-biomass_core-module.html","id":"varying-traits","chapter":"1 LandR Biomass_core Module","heading":"1.2.2.3 Spatio-temporally varying species traits","text":"traits vary species, ecolocation , potentially, year \nyear column omitted several years exist (case last\nyear’s values current simulation year always used). \nmaximum biomass, maxB, maximum -ground net primary productivity,\nmaxANPP, species establishment probability, SEP (called establishprob \nmodule). default, Biomass_core assigns theoretical values \ntraits, thus recommend using Biomass_borealDataPrep obtain realistic\ntrait values derived data (default, pertinent Canadian boreal forest\napplications), passing custom table directly. Biomass_speciesParameters\ncalibrates maxB maxANPP estimating two additional invariant\nspecies traits (inflationFactor mANPPproportion; also Western\nCanadian forests). See Table 1.2 example.\nTable 1.2: Example spatio-temporally varying species traits table (speciesEcoregion table object module), two ecolocations (called ecoregionGroups) species Abies sp. (Abie_sp), Picea engelmannii (Pice_eng), Picea glauca (Pice_gla), Pinus sp. (Pinu_sp), Populus sp. (Popu_sp) Pseudotsuga menziesii (Pseu_men). simulation runs 10 year using table, trait values year 2 used simulation years 2-10.\n","code":""},{"path":"landr-biomass_core-module.html","id":"ecolocation-traits","chapter":"1 LandR Biomass_core Module","heading":"1.2.2.4 Ecolocation-specific parameters – minimum relative biomass","text":"Minimum relative biomass (minRelativeB) ecolocation-specific\nparameter used Biomass_core. used determine shade level \npixel (.e., site shade) respect total potential maximum\nbiomass pixel (.e., sum maxB values pixel’s\necolocation). relative biomass stand (regards total\npotential maximum biomass) minimum relative biomass thresholds, \npixel assigned threshold’s site shade value (Scheller & Miranda 2015b).shade level influences germination regeneration new cohorts,\ndepending shade tolerance (see Probabilities \ngermination).Site shade varies X0 (shade) X5 (maximum shade). default,\nBiomass_core uses minimum realtive biomass threshold values across\necolocations, adjusted publicly available LANDIS-II\ntable better reflect\nWestern Canada boreal forest dynamics (see Table 1.3).\nBiomass_borealDataPrep adjustment default. \ninputs, values can adjusted using modules passing\nuser-defined tables.\nTable 1.3: Example minimum relative biomass table (minRelativeB table object module), two ecolocations (ecoregionGroups) sharing values\n","code":""},{"path":"landr-biomass_core-module.html","id":"prob-germ","chapter":"1 LandR Biomass_core Module","heading":"1.2.2.5 Probabilities of germination","text":"species’ probability germination results combination shade\ntolerance level (invariant species trait species table; Table\n1.1) site shade (defined amount \nbiomass pixel – see minimum relative biomass\nparameter Scheller & Miranda 2015b). default, \nBiomass_core Biomass_borealDataPrep use publicly available LANDIS-II\ntable (called sufficientLight module; Table 1.4).\nTable 1.4: Default species probability germination values used Biomass_core Biomass_borealDataPrep. Columns X0-X5 different site shade levels line probability germination site shade species shade tolerance combination.\n","code":""},{"path":"landr-biomass_core-module.html","id":"other-inputs","chapter":"1 LandR Biomass_core Module","heading":"1.2.2.6 Other module inputs","text":"remaining module input objects either directly influence basic\nmechanisms implemented Biomass_core (e.g., sppColorVect \nstudyAreaReporting used plotting purposes), objects keep\ntrack property/process module (e.g., lastReg counter \nlast year regeneration occurred), define study area \nsimulation (e.g., studyArea rasterToMatch).next section provides complete list input objects, including \nalready mentioned .","code":""},{"path":"landr-biomass_core-module.html","id":"inputs-list","chapter":"1 LandR Biomass_core Module","heading":"1.2.3 List of input objects","text":"Biomass_core’s input objects (theoretical) defaults \nproduced automatically module2. suggest new users\nrun Biomass_core supplying studyArea polygon, \nattempting supply combining Biomass_core modules.\nenable become familiar input objects \ntheoretical setting.inputs listed Table 1.5, \nfollowing particularly important deserve special attention:Spatial layersecoregionMap – raster layer ecolocation IDs. Note term\n“ecoregion” inherited LBSE kept consistency original\nLBSE code, prefer call ecolocations avoid confusion \necoregion-level classification National Ecological\nClassification Canada\n(NECC).\nEcolocations group pixels similar biophysical conditions. default,\nuse two levels grouping applications: first level \necological classification ecodistricts NECC, second\nlevel land-cover classification. Hence, ecolocations contain\nrelatively coarse scale regional information plus finer scale land cover\ninformation. ecoregionMap layer must defined categorical\nraster, associated Raster Attribute Table (RAT; see, e.g.,\nraster::ratify). RAT must contain columns: ID (value \nraster layer), ecoregion (first level grouping) \necoregionGroup (full ecolocation “name” written \n<firstlevel_secondlevel>). Note creating ecoregionGroup’s \ncombining two raster layers whose values numeric (\nBiomass_borealDataPrep), group label character combination two\nnumeric grouping levels. instance, Natural Ecoregion 2 \nland-cover types 1, 2 3, RAT contain ID = {1,2,3},\necoregion = {2} ecoregionGroup = {2_1, 2_2, 2_3}. However, user\nfree use groupings wish. Finally, note ecolocations\n(ecoregionGroup’s) listed ecoregion table.ecoregionMap – raster layer ecolocation IDs. Note term\n“ecoregion” inherited LBSE kept consistency original\nLBSE code, prefer call ecolocations avoid confusion \necoregion-level classification National Ecological\nClassification Canada\n(NECC).\nEcolocations group pixels similar biophysical conditions. default,\nuse two levels grouping applications: first level \necological classification ecodistricts NECC, second\nlevel land-cover classification. Hence, ecolocations contain\nrelatively coarse scale regional information plus finer scale land cover\ninformation. ecoregionMap layer must defined categorical\nraster, associated Raster Attribute Table (RAT; see, e.g.,\nraster::ratify). RAT must contain columns: ID (value \nraster layer), ecoregion (first level grouping) \necoregionGroup (full ecolocation “name” written \n<firstlevel_secondlevel>). Note creating ecoregionGroup’s \ncombining two raster layers whose values numeric (\nBiomass_borealDataPrep), group label character combination two\nnumeric grouping levels. instance, Natural Ecoregion 2 \nland-cover types 1, 2 3, RAT contain ID = {1,2,3},\necoregion = {2} ecoregionGroup = {2_1, 2_2, 2_3}. However, user\nfree use groupings wish. Finally, note ecolocations\n(ecoregionGroup’s) listed ecoregion table.rasterToMatch – RasterLayer, given resolution projection\ndetermining pixels (.e., non-NA values) forest dynamics \nsimulated. Needs match studyArea. supplied, Biomass_core\nattempts produce studyArea, using biomassMap template\nspatial resolution projection.rasterToMatch – RasterLayer, given resolution projection\ndetermining pixels (.e., non-NA values) forest dynamics \nsimulated. Needs match studyArea. supplied, Biomass_core\nattempts produce studyArea, using biomassMap template\nspatial resolution projection.studyArea – SpatialPolygonsDataFrame single polygon\ndetermining simulation take place. input\nobject must supplied user another module.studyArea – SpatialPolygonsDataFrame single polygon\ndetermining simulation take place. input\nobject must supplied user another module.Species traits parameter tablesecoregion – data.table listing ecolocation “names”\n(ecoregionGroup column; see ecoregionMap details) \nstate (active – yes – inactive – )ecoregion – data.table listing ecolocation “names”\n(ecoregionGroup column; see ecoregionMap details) \nstate (active – yes – inactive – )minRelativeB – data.table minimum relative biomass values. See\nEcolocation-specific parameters – minimum relative\nbiomass.minRelativeB – data.table minimum relative biomass values. See\nEcolocation-specific parameters – minimum relative\nbiomass.species – data.table invariant species\ntraits.species – data.table invariant species\ntraits.speciesEcoregion – data.table spatio-temporally varying species\ntraits.speciesEcoregion – data.table spatio-temporally varying species\ntraits.sufficientLight – data.table defining probability germination\nspecies, given shadetolerance level (see species ) \nshade level pixel (see minRelativeB ). See Probabilities\ngermination.sufficientLight – data.table defining probability germination\nspecies, given shadetolerance level (see species ) \nshade level pixel (see minRelativeB ). See Probabilities\ngermination.sppEquiv – data.table species name equivalences various\nconventions. must contain columns LandR (species IDs LandR\nformat), EN_generic_short (short generic species names English – \nlanguage – used plotting), Type (type species, Conifer\nDeciduous, “broadleaf”) Leading (EN_generic_short\n“leading” appended – e.g., “Poplar\nleading”).\nSee ?LandR::sppEquivalencies_CA information.sppEquiv – data.table species name equivalences various\nconventions. must contain columns LandR (species IDs LandR\nformat), EN_generic_short (short generic species names English – \nlanguage – used plotting), Type (type species, Conifer\nDeciduous, “broadleaf”) Leading (EN_generic_short\n“leading” appended – e.g., “Poplar\nleading”).\nSee ?LandR::sppEquivalencies_CA information.sppColorVect – character. named vector colours used plot species\ndynamics. contain one colour per species species table ,\npotentially colour species mixtures (named “Mixed”). Vector names must\nfollow species$speciesCode.sppColorVect – character. named vector colours used plot species\ndynamics. contain one colour per species species table ,\npotentially colour species mixtures (named “Mixed”). Vector names must\nfollow species$speciesCode.Cohort-simulation-related objectscohortData – data.table containing initial cohort information per\npixelGroup (see pixelGroupMap ). table updated \nsimulation cohort dynamics simulated. must contain following\ncolumns:\npixelGroup – integer. pixelGroup ID. See\nHashing.\necoregionGroup – character. Ecolocation names. See ecoregionMap \necoregion objects .\nspeciesCode – character. Species ID.\nage – integer. Cohort age.\nB – integer. Cohort biomass current year \\(g/m^2\\).\nmortality – integer. Cohort dead biomass current year \n\\(g/m^2\\). Usually filled 0s initial conditions.\naNPPAct – integer. Actual aboveground net primary productivity \ncurrent year \\(g/m^2\\). B result previous year’s B\nminus current year’s mortality plus aNPPAct. Usually filled \n0s initial conditions. See “1.1.3 Cohort growth ageing” section\nScheller & Miranda (2015b).\ncohortData – data.table containing initial cohort information per\npixelGroup (see pixelGroupMap ). table updated \nsimulation cohort dynamics simulated. must contain following\ncolumns:pixelGroup – integer. pixelGroup ID. See\nHashing.pixelGroup – integer. pixelGroup ID. See\nHashing.ecoregionGroup – character. Ecolocation names. See ecoregionMap \necoregion objects .ecoregionGroup – character. Ecolocation names. See ecoregionMap \necoregion objects .speciesCode – character. Species ID.speciesCode – character. Species ID.age – integer. Cohort age.age – integer. Cohort age.B – integer. Cohort biomass current year \\(g/m^2\\).B – integer. Cohort biomass current year \\(g/m^2\\).mortality – integer. Cohort dead biomass current year \n\\(g/m^2\\). Usually filled 0s initial conditions.mortality – integer. Cohort dead biomass current year \n\\(g/m^2\\). Usually filled 0s initial conditions.aNPPAct – integer. Actual aboveground net primary productivity \ncurrent year \\(g/m^2\\). B result previous year’s B\nminus current year’s mortality plus aNPPAct. Usually filled \n0s initial conditions. See “1.1.3 Cohort growth ageing” section\nScheller & Miranda (2015b).aNPPAct – integer. Actual aboveground net primary productivity \ncurrent year \\(g/m^2\\). B result previous year’s B\nminus current year’s mortality plus aNPPAct. Usually filled \n0s initial conditions. See “1.1.3 Cohort growth ageing” section\nScheller & Miranda (2015b).pixelGroupMap – raster layer pixelGroup IDs per pixel. Pixels\nalways grouped based identical ecoregionGroup, speciesCode, age\nB composition, even user supplies initial groupings\n(e.g., possible Biomass_borealDataPrep data module).\npixelGroupMap – raster layer pixelGroup IDs per pixel. Pixels\nalways grouped based identical ecoregionGroup, speciesCode, age\nB composition, even user supplies initial groupings\n(e.g., possible Biomass_borealDataPrep data module).\n\nTable 1.5: List Biomass_core input objects description.\n","code":""},{"path":"landr-biomass_core-module.html","id":"params-list","chapter":"1 LandR Biomass_core Module","heading":"1.2.4 List of parameters","text":"addition inputs objects, Biomass_core uses several\nparameters3 control aspects like simulation length, \n“succession” time step, plotting saving intervals, amongst others. Note \nparameters relevant simulating climate effects \ncohort growth mortality, require also loading LandR.CS R\npackage4 (another similar package). discussed\ndetail , since climate effects calculated externally \nBiomass_core LandR.CS functions thus documented .list useful parameters description listed , \nfull set parameters Table 1.6. Like\ninput objects, default values supplied parameters \nsuggest user becomes familiarized attempting changes.\nalso note \"spin-\" \"biomassMap\" options \ninitialBiomassSource parameter currently deactivated, since Biomass_core\nlonger generates initial cohort biomass conditions using spin-based \ninitial stand age like LANDIS-II (\"spin-\"), attempt fill\ninitial cohort biomasses using biomassMap.Plotting saving.plots – activates/deactivates plotting defines\ntype plotting (see ?Plots);.plots – activates/deactivates plotting defines\ntype plotting (see ?Plots);.plotInitialTime – defines plotting starts;.plotInitialTime – defines plotting starts;.plotInterval – defines plotting frequency;.plotInterval – defines plotting frequency;.plotMaps – activates/deactivates map plotting;.plotMaps – activates/deactivates map plotting;.saveInitialTime – defines saving starts;.saveInitialTime – defines saving starts;.saveInterval – defines saving frequency;.saveInterval – defines saving frequency;SimulationseedingAlgorithm – dispersal type (see );seedingAlgorithm – dispersal type (see );successionTimestep – defines frequency dispersal/local recruitment\nevent (growth mortality always yearly);successionTimestep – defines frequency dispersal/local recruitment\nevent (growth mortality always yearly);OthermixedType – mixed forest stands defined;mixedType – mixed forest stands defined;vegLeadingProportion – relative biomass threshold consider species\n“leading” (.e., dominant);vegLeadingProportion – relative biomass threshold consider species\n“leading” (.e., dominant);\nTable 1.6: List Biomass_core parameters description.\n","code":""},{"path":"landr-biomass_core-module.html","id":"outputs-list","chapter":"1 LandR Biomass_core Module","heading":"1.2.5 List of outputs","text":"main outputs Biomass_core cohortData pixelGroupMap\ncontaining cohort information per year (note saved \ndefault), visual outputs species level biomass, age dominance across \nlandscape simulation length, several maps stand biomass,\nmortality reproductive success (.e, new biomass) yearly basis.However, objects changed/output Biomass_core (listed Table\n1.7) can saved via outputs argument\nsimInit5.\nTable 1.7: List Biomass_core output objects description.\n","code":""},{"path":"landr-biomass_core-module.html","id":"sim-flow","chapter":"1 LandR Biomass_core Module","heading":"1.2.6 Simulation flow and module events","text":"Biomass_core simulate disturbances effect \nvegetation (.e., post-disturbance mortality regeneration). \ndisturbance post-disturbance mortality/regeneration modules used (e.g.,\nLandMine Biomass_regeneration), user make sure \npost-disturbance effects occur disturbance, dispersal\nbackground vegetation growth mortality (simulated Biomass_core).\nHence, disturbance take place either beginning \nend simulation time step guarantee happens\nimmediately post-disturbance effects calculated.general flow Biomass_core processes without disturbances :Preparation necessary objects simulation – either data \ncalibration modules Biomass_core (simInit \ninit event6);Preparation necessary objects simulation – either data \ncalibration modules Biomass_core (simInit \ninit event6);Disturbances (OPTIONAL) – simulated disturbance module (e.g.,\nLandMine);Disturbances (OPTIONAL) – simulated disturbance module (e.g.,\nLandMine);Post-disturbance mortality/regeneration (OPTIONAL) – simulated \nregeneration module (e.g., Biomass_regeneration);Post-disturbance mortality/regeneration (OPTIONAL) – simulated \nregeneration module (e.g., Biomass_regeneration);Seed dispersal (every successionTimestep; Dispersal event):\nseed dispersal can slow process adapted occur every\n10 years (default successionTimestep). user can set occur\n/less often, caveat using Biomass_borealDataPrep\nestimate species establishment probabilities, values \nintegrated 10 years.\nsee Scheller & Domingo (2012) details dispersal algorithms.\nSeed dispersal (every successionTimestep; Dispersal event):seed dispersal can slow process adapted occur every\n10 years (default successionTimestep). user can set occur\n/less often, caveat using Biomass_borealDataPrep\nestimate species establishment probabilities, values \nintegrated 10 years.see Scheller & Domingo (2012) details dispersal algorithms.Growth mortality (mortalityAndGrowth event):\nunlike dispersal, growth mortality always occur time step (year).\nsee Scheller & Mladenoff (2004) detail.\nGrowth mortality (mortalityAndGrowth event):unlike dispersal, growth mortality always occur time step (year).see Scheller & Mladenoff (2004) detail.Cohort age binning (every successionTimestep; cohortAgeReclassification\nevent):\nfollows frequency dispersal, collapsing cohorts (.e.,\nsumming biomass/mortality/aNPP) ages classes resolution\nequal successionTimestep.\nsee Scheller & Miranda (2015b) detail.\nCohort age binning (every successionTimestep; cohortAgeReclassification\nevent):follows frequency dispersal, collapsing cohorts (.e.,\nsumming biomass/mortality/aNPP) ages classes resolution\nequal successionTimestep.see Scheller & Miranda (2015b) detail.Summary tables regeneration (summaryRegen event), biomass, age, growth\nmortality (summaryBGM event);Summary tables regeneration (summaryRegen event), biomass, age, growth\nmortality (summaryBGM event);Plots maps (plotMaps event) averages (plotAvgs \nplotSummaryBySpecies events);Plots maps (plotMaps event) averages (plotAvgs \nplotSummaryBySpecies events);Save outputs (save event).Save outputs (save event).… (repeat 2-9) …","code":""},{"path":"landr-biomass_core-module.html","id":"biomass-core-vs-lbse","chapter":"1 LandR Biomass_core Module","heading":"1.2.7 Differences between Biomass_core and the LANDIS-II Biomass Succession Extension model (LBSE)","text":"","code":""},{"path":"landr-biomass_core-module.html","id":"biomass-core-vs-lbse-algo","chapter":"1 LandR Biomass_core Module","heading":"1.2.7.1 Algorithm changes","text":"Upon porting LBSE R, made six minor modifications original\nmodel’s algorithms better reflect ecological processes. \nsignificantly alter simulation outputs note changes might\nalso implemented recent versions LBSE.First, year community (.e., ‘pixel group’ Biomass_core, see\n), LBSE calculates competition index cohort sequentially (.e.,\none cohort time) updating growth mortality cohorts\n(.e., biomass gain loss, respectively) , calculation\nsequence following cohort age descending order, explicit order \nspecies. sorting growth mortality calculations oldest \nyoungest cohorts LBSE aimed capturing size-asymmetric competition\ncohorts, assumption older cohorts priority \ngrowing space given greater height (Scheller pers. comm.). felt \nwithin-year sequential growth, death recruitment may ecologically\naccurate, size-asymmetric competition accounted \ntwice, calculation competition index already considers \ncompetitive advantage older cohorts (shown User’s Guide, Scheller & Miranda 2015b). Hence, Biomass_core growth, mortality, recruitment\ncompetition index calculated time across cohorts \nspecies.Second, unknown species-level sorting mechanism contained within LBSE (\nchanged depending species order input species list file), led \ndifferent simulation results depending input species list file (e.g.,\nTable 1.8 Fig. 1.2). \ncalculation competition, growth mortality cohorts \ntime also circumvented issue.\nFigure 1.2: Differences total landscape aboveground biomass using two different input species orders community. simulations demonstrate sequential calculation competition index, combined lack explicit species ordering affect overall landscape aboveground biomass time using different input species orders (see Table 1.8). order prevent differences introduced cohort recruitment, species’ ages sexual maturity changed species’ longevity values, simulation ran 75 years prevent cohorts reaching sexual maturity. bottom panel shows difference two simulations percentage, calculated \\(\\frac{Biomass_{order2} - Biomass_{order1}}{Biomass_{order2}} * 100\\)\nThird, LBSE calculation total pixel biomass purpose \ncalculating initial biomass new cohort included (previously\ncalculated) biomass new cohorts succession time step = 1, \ntime step > 1. reflect documentation User’s\nGuide, stated “Bsum [total pixel biomass] current total\nbiomass site (including new cohorts)”\n(Scheller & Miranda 2015b), succession time step set 1.\nAdditionally, together lack explicit ordering, generated\ndifferent results terms biomass assigned new cohort (e.g.,\nTable 1.9 Fig. 1.3). \nBiomass_core initial biomass new cohorts longer calculated\nsequentially (competition, growth mortality), thus biomass\nnew cohorts never included calculation total pixel biomass.\nFigure 1.3: Differences biomass assigned new cohorts, summed species across pixels, using two different input species orders community succession time step 1. simulations demonstrate different summation total cohort biomass succession time step 1 lack explicit species ordering affect simulation results changing species order input file (see Table 1.9). , initial cohort ages also set 1. Values refer initial total biomass attributed species end year 1.\nFourth, LBSE, serotiny resprouting occur pixel\nfollowing fire, serotiny taking precedence activated. understand\nprovides advantage serotinous species, perhaps \ndisadvantaged respect fast-growing resprouters. However, feel \necologically realistic serotinous resprouter species able \nregenerate given pixel following fire allow competition\nserotinous resprouting species arise species traits. Note\nchange implemented Biomass_regeneration \nBiomass_regenerationPM modules, since post-disturbance effects separated\nbackground vegetation dynamics simulated Biomass_core.Fifth, Biomass_core, species shade tolerance values can decimal values\nallow finer adjustments -species competition.Sixth, added new parameter called minCohortBiomass, allows user\ncontrol cohort removal bellow certain threshold biomass. \nsimulation set-ups, noticed Biomass_core (LBSE) able \ngenerate many small cohorts understory , due cohort\ncompetition, able gain biomass grow. However, \ncompetition decreases growth increase mortality, cohorts\nsurvived low biomass levels reached sufficient age suffer\nage-related mortality. felt unlikely realistic many cases.\ndefault, parameter left 0 follow LBSE behaviour (.e., \ncohorts removal based minimum biomass).","code":""},{"path":"landr-biomass_core-module.html","id":"biomass-core-vs-lbse-enhan","chapter":"1 LandR Biomass_core Module","heading":"1.2.7.2 Other enhancements","text":"addition sixth changes growth, mortality regeneration mentioned\n, enhanced modularity separating components govern\nvegetation responses disturbances Biomass_core, implemented\nhashing, caching testing improve computational efficiency insure\nperformance.","code":""},{"path":"landr-biomass_core-module.html","id":"biomass-core-vs-lbse-enhan1","chapter":"1 LandR Biomass_core Module","heading":"1.2.7.2.1 Modularity","text":"Unlike LBSE, post-disturbance effects part Biomass_core per\nse, belong two separate modules, used interchangeably\n(Biomass_regeneration\n\nBiomass_regenerationPM).\nneed loaded added “modules folder” project case\nuser wants simulate forest responses disturbances (fire\ndisturbances moment). , enables higher flexibility \nswapping different approaches regeneration.Climate effects growth mortality also implemented modular way. \neffects climate biomass increase (growth) loss (mortality) \nwritten functions grouped two packages. LandR R package contains\ndefault, “non-climate-sensitive” functions, LandR.CS R package\ncontains functions simulate climate effects (CS stands “climate\nsensitive”). Note functions simulate actual growth/mortality\nprocesses, estimate modifiers increase/decrease cohort biomass top\nbackground growth/mortality. Biomass_core uses LandR functions \ndefault (see growthAndMortalityDrivers parameter full parameters\nlist). user wish change climate effects \ngrowth/mortality calculated, can provide new compatible functions\n(.e., names, inputs outputs) via another R package.","code":""},{"path":"landr-biomass_core-module.html","id":"biomass-core-vs-lbse-enhan2","chapter":"1 LandR Biomass_core Module","heading":"1.2.7.2.2 Hashing","text":"first strategy improve simulation efficiency Biomass_core use\nhashing mechanism (Yang et al. 2011). Instead assigning key pixel \nraster tracking simulation pixel lookup table, \nindexed pixels using pixelGroup key contained unique combinations \necolocation community composition (.e., species, age biomass\ncomposition), tracked stored simulation data pixelGroup (Fig.\n1.4). algorithm able ease computational\nburden significantly reducing size lookup table speeding-\nsimulation process. recruitment disturbance events, pixels \nrehashed new pixel groups.\nFigure 1.4: Hashing design Biomass_core. re-coded Biomass_core, pixel group map hashed based unique combination species composition (‘community map’) ecolocation map, associated lookup table. insert top-right corner original design linked map lookup table pixel key.\n","code":""},{"path":"landr-biomass_core-module.html","id":"biomass-core-vs-lbse-enhan3","chapter":"1 LandR Biomass_core Module","heading":"1.2.7.2.3 Caching","text":"second strategy aimed improving model efficacy implementation \ncaching data-driven parametrisation initialisation. Caching\nautomatically archives outputs given function disk (memory) reads\nback subsequent calls function given identical inputs. \ncaching operations achieved using reproducible R package\n(McIntire & Chubaty 2020).current version Biomass_core, spin-phase replaced \ndata-driven landscape initialisation many model parameters derived \ndata, using data calibration modules (e.g., Biomass_borealDataPrep). \navoid repeat data downloads treatment, statistical estimation \nparameters landscape initialisation every time simulation re-run\nconditions, many pre-simulation steps automatically\ncached. means pre-simulation phase significantly faster upon \nsecond call inputs changed (e.g., input data \nparametrisation methods), inputs change directly affected steps\nre-run (see main text examples). using data modules,\nBiomass_core still relies caching preparation theoretical\ninputs.","code":""},{"path":"landr-biomass_core-module.html","id":"biomass-core-vs-lbse-enhan4","chapter":"1 LandR Biomass_core Module","heading":"1.2.7.2.4 Testing","text":"Finally, implemented code testing facilitate bug detection comparing\noutputs functions (etc.) expected outputs (Wickham 2011). built \nintegrated code tests Biomass_core across LandR modules \nLandR R package  form assertions,\nunit tests integration tests. Assertions unit tests run\nautomatically simulations (can turned ) evaluate individual\ncode components (e.g., one function object’s class). Integration tests\nevaluate several coded processes integrated correctly usually run\nmanually. However, embedded assertions within module code, R\npackage dependencies Biomass_core, LandR R package\n SpaDES, also provide means test\nmodule integration. also implemented GitHub Actions continuous integration\n(CI), routinely test GitHub hosted packages (e.g., LandR) modules.\nCRAN-hosted packages (e.g., SpaDES) also automatically tested checked\nCRAN.Finally, Biomass_core (LandR modules) code hosted \npublic GitHub repositories, module code subject scrutiny \nmany users, can identify issues contribute improve module code.","code":""},{"path":"landr-biomass_core-module.html","id":"biomass-core-vs-lbse-comparisons","chapter":"1 LandR Biomass_core Module","heading":"1.2.7.3 Performance and accuracy of Biomass_core with respect to LBSE","text":"recoding Biomass_core, used integration tests ensured similar\noutputs demographic process (namely, growth, mortality recruitment)\noutputs counterpart LBSE. , report \ncomparisons overall simulation (.e., including demographic\nprocesses) LBSE Biomass_core using three randomly generated\ninitial communities (Tables\n1.10-1.12). remaining input\nparameters taken LANDIS-II training course (Tables\n1.13-1.16), contained species\nattributes information 16 common tree species boreal forests 2\necolocations. ran simulations 1000 years, succession time step \n10 three replicates, enough account variability\nproduced stochastic processes. Seed dispersal set “ward dispersal”.results suggested Biomass_core good agreement LBSE using\nthree randomly generated initial communities (Fig. 1.5),\nsmall deviations LBSE-generated biomasses. Notably, mean\ndifferences LBSE Biomass_core 0.03% (range:\n-0.01% ~ 0.13%), 0.03% (range:\n-0.01% ~ 0.11%) 0.05%\n(-0.02% ~ 0.15%) initial community,\nrespectively (right panels Fig. 1.5 appendix).\nFigure 1.5: Visual comparison simulation outputs three randomly generated initial communities (left panels) difference outputs (right panels). % difference LBSE Biomass_core calculated \\(\\frac{Biomass_{LBSE} - Biomass_{Biomass_core}}{Biomass_{LBSE}} * 100\\)\nexamine running time changed map size, ran simulations using maps\nincreasing number pixels, 22,201 638,401 pixels. maps \ninitialised single ecolocation 7 different communities. Simulations\nrun 120 years using succession time step 10 replicated three\ntimes. eliminate effect hardware running time, used machines\npurchased time, equal specifications running\nWindows 7. simulation ran 2 CPU threads total RAM 4000 Mb.LBSE Biomass_core, simulation time increased linearly number\npixels, increase rate smaller Biomass_core (Fig.\n1.6a). meant models similar\nsimulation efficiencies small maps (< 90,000 pixels), map size increased\nBiomass_core ~2 times faster LBSE (maps > 100,000 pixels; Fig.\n1.6a). Biomass_core also scaled better map size, \nLBSE speeds fluctuated 19 25 seconds per 1,000 pixels across map\nsizes, Biomass_core decreased 21 11 seconds per 1,000 pixels\nsmaller larger maps (Fig. 1.6b).\nFigure 1.6: Simulation efficiencies LBSE Biomass_core increasing map size, terms ) mean running time across repetitions (left y-axis) ratio LBSE Biomass_core running times (right y-axis blue line), b) running time scalability mean running time per 1000 pixels.\n","code":""},{"path":"landr-biomass_core-module.html","id":"example","chapter":"1 LandR Biomass_core Module","heading":"1.3 Usage example","text":"","code":""},{"path":"landr-biomass_core-module.html","id":"example-libs","chapter":"1 LandR Biomass_core Module","heading":"1.3.1 Set up R libraries","text":"","code":"\noptions(repos = c(CRAN = \"https://cloud.r-project.org\"))\ntempDir <- tempdir()\n\npkgPath <- file.path(tempDir, \"packages\", version$platform, paste0(version$major,\n    \".\", strsplit(version$minor, \"[.]\")[[1]][1]))\ndir.create(pkgPath, recursive = TRUE)\n.libPaths(pkgPath, include.site = FALSE)\n\nif (!require(Require, lib.loc = pkgPath)) {\n    remotes::install_github(paste0(\"PredictiveEcology/\", \"Require@5c44205bf407f613f53546be652a438ef1248147\"),\n        upgrade = FALSE, force = TRUE)\n    library(Require, lib.loc = pkgPath)\n}\n\nsetLinuxBinaryRepo()"},{"path":"landr-biomass_core-module.html","id":"example-pkg-mods","chapter":"1 LandR Biomass_core Module","heading":"1.3.2 Get the module and module dependencies","text":"can use SpaDES.project::getModule function download module \nmodule folder specified . Alternatively, see SpaDES-modules\nrepository see \ndownload SpaDES modules, fork/clone GitHub\nrepository directly.downloading module, important make sure module R package\ndependencies installed correct version.\nSpaDES.project::packagesInModules makes list necessary packages \nmodules paths$modulePath, Require installs .","code":"\nRequire(paste0(\"PredictiveEcology/\", \"SpaDES.project@6d7de6ee12fc967c7c60de44f1aa3b04e6eeb5db\"),\n    require = FALSE, upgrade = FALSE, standAlone = TRUE)\n\npaths <- list(inputPath = normPath(file.path(tempDir, \"inputs\")),\n    cachePath = normPath(file.path(tempDir, \"cache\")), modulePath = normPath(file.path(tempDir,\n        \"modules\")), outputPath = normPath(file.path(tempDir,\n        \"outputs\")))\n\nSpaDES.project::getModule(modulePath = paths$modulePath, c(\"PredictiveEcology/Biomass_core@master\"),\n    overwrite = TRUE)\n\n## make sure all necessary packages are installed:\nouts <- SpaDES.project::packagesInModules(modulePath = paths$modulePath)\nRequire(c(unname(unlist(outs)), \"SpaDES\"), require = FALSE, standAlone = TRUE)\n\n## load necessary packages\nRequire(c(\"SpaDES\", \"LandR\", \"reproducible\", \"pemisc\"), upgrade = FALSE,\n    install = FALSE)"},{"path":"landr-biomass_core-module.html","id":"example-setupSim","chapter":"1 LandR Biomass_core Module","heading":"1.3.3 Setup simulation","text":"setup simulation random study area, using species within \nLandR::sppEquivalencies_CA table can found (Biomass_core \nretrieve species % cover maps filter present species). also\ndefine colour coding used plotting, type plots produce\nchoose output cohortData tables every year – note \npixel-based, “spatialise” results posteriori pixelBroupMap must\nalso saved.Please see lists input objects,\nparameters outputs information.","code":"\ntimes <- list(start = 0, end = 30)\n\nstudyArea <- Cache(randomStudyArea, size = 1e+07)  # cache this so it creates a random one only once on a machine\n\n# Pick the species you want to work with – using the naming\n# convention in 'Boreal' column of\n# LandR::sppEquivalencies_CA\nspeciesNameConvention <- \"Boreal\"\nspeciesToUse <- c(\"Pice_Gla\", \"Popu_Tre\", \"Pinu_Con\")\n\nsppEquiv <- sppEquivalencies_CA[get(speciesNameConvention) %in%\n    speciesToUse]\n# Assign a colour convention for graphics for each species\nsppColorVect <- sppColors(sppEquiv, speciesNameConvention, newVals = \"Mixed\",\n    palette = \"Set1\")\n\n## Usage example\nmodules <- as.list(\"Biomass_core\")\nobjects <- list(studyArea = studyArea, sppEquiv = sppEquiv, sppColorVect = sppColorVect)\n\nsuccessionTimestep <- 10L\n\n## keep default values for most parameters (omitted from\n## this list)\nparameters <- list(Biomass_core = list(sppEquivCol = speciesNameConvention,\n    successionTimestep = successionTimestep, .plots = c(\"screen\",\n        \"object\"), .plotInitialTime = times$start, .plots = c(\"screen\",\n        \"png\"), .saveInitialTime = times$start, .useCache = \"init\",\n    .useParallel = FALSE))\n\noutputs <- data.frame(expand.grid(objectName = \"cohortData\",\n    saveTime = unique(seq(times$start, times$end, by = 1)), eventPriority = 1,\n    stringsAsFactors = FALSE))"},{"path":"landr-biomass_core-module.html","id":"example-runSim","chapter":"1 LandR Biomass_core Module","heading":"1.3.4 Run simulation","text":"simInitAndSpades wrapper function runs simInit (\ninitialises modules) spades (runs modules, .e., events),\npass necessary setup objects created ., pass useful reproducible options control caching (\"reproducible.useCache\")\ninputs downloaded (\"reproducible.destinationPath\").\nFigure 1.7: Biomass_core automatically generates simulation visuals species dynamics across landscape terms total biomass, number presences age productivity (), well yearly plots total biomass, productivity, mortality, reproduction leading species pixel ().\n","code":"\nopts <- options(reproducible.useCache = TRUE, reproducible.destinationPath = paths$inputPath,\n    spades.useRequire = FALSE)\ngraphics.off()\nmySim <- simInitAndSpades(times = times, params = parameters,\n    modules = modules, objects = objects, paths = paths, outputs = outputs,\n    debug = TRUE)"},{"path":"landr-biomass_core-module.html","id":"appendix","chapter":"1 LandR Biomass_core Module","heading":"1.4 Appendix","text":"","code":""},{"path":"landr-biomass_core-module.html","id":"appendix-tables","chapter":"1 LandR Biomass_core Module","heading":"1.4.1 Tables","text":"\nTable 1.8: Input order processing order (determined LBSE) community used assess impact sequential calculation competition index, combined lack explicit species ordering. input order order species initial communities table input file. processing order order used simulation, obtained Landis-log.txt CalibrateMode set ‘yes’. Species starting ages also shown.\n\nTable 1.9: Input order processing order (determined LBSE) community used assess impact setting succession time step 1, combined lack explicit species ordering. input order order species initial communities table input file. processing order order used simulation, obtained Landis-log.txt CalibrateMode set ‘yes’. Species starting ages also shown.\n\nTable 1.10: Randomly generated community combination . 1 used recruitment comparison runs.\n\nTable 1.11: Randomly generated community combination . 2 used recruitment comparison runs.\n\nTable 1.12: Randomly generated community combination . 3 used recruitment comparison runs.\n\nTable 1.13: Invariant species traits table used comparison runs.\n\nTable 1.14: Minimum relative biomass table used comparison runs. X0-5 represent site shade classes -shade (0) maximum shade (5). ecolocations shared values.\n\nTable 1.15: Probability germination species shade tolerance shade level combinations (called sufficient light table LBSE sufficientLight input data.table LandR Biomass_core) used comparison runs.\n\nTable 1.16: Species ecolocation table used comparison runs. SEP stands species establishment probability, maxB maximum biomass maxANPP maximum aboveground net primary productivity. Values held constant throughout simulation.\n","code":""},{"path":"landr-biomass_core-module.html","id":"refs","chapter":"1 LandR Biomass_core Module","heading":"1.5 References","text":"","code":""},{"path":"landr-data-and-calibration-modules.html","id":"landr-data-and-calibration-modules","chapter":"LandR Data and Calibration Modules","heading":"LandR Data and Calibration Modules","text":"LandR ecosystem SpaDES modules variety data /calibration modules used obtain pre-process input data, well estimate input parameters required core forest landscape simulation module Biomass_core. modules presented next chapters.","code":""},{"path":"landr-biomass_speciesdata-module.html","id":"landr-biomass_speciesdata-module","chapter":"2 LandR Biomass_speciesData Module","heading":"2 LandR Biomass_speciesData Module","text":"","code":""},{"path":"landr-biomass_speciesdata-module.html","id":"authors-1","chapter":"2 LandR Biomass_speciesData Module","heading":"2.0.0.1 Authors:","text":"Ceres Barros ceres.barros@ubc.ca [aut, cre], Eliot J B McIntire eliot.mcintire@nrcan-rncan.gc.ca [aut], Alex M. Chubaty achubaty@-cast.ca [aut]\ndocumentation work progress. Potential discrepancies omissions\nmay exist time . find , contact us using “Get help”\nlink .","code":""},{"path":"landr-biomass_speciesdata-module.html","id":"module-overview-1","chapter":"2 LandR Biomass_speciesData Module","heading":"2.1 Module Overview","text":"","code":""},{"path":"landr-biomass_speciesdata-module.html","id":"quick-links-1","chapter":"2 LandR Biomass_speciesData Module","heading":"2.1.1 Quick links","text":"General functioningGeneral functioningList input objectsList input objectsList parametersList parametersList outputsList outputsSimulation flow module eventsSimulation flow module events","code":""},{"path":"landr-biomass_speciesdata-module.html","id":"module-summary","chapter":"2 LandR Biomass_speciesData Module","heading":"2.1.2 Module summary","text":"LandR Biomass_speciesData (hereafter Biomass_speciesData) downloads \npre-processes species percent (% cover) data layers used \nLandR data modules (e.g., Biomass_borealDataPrep) LandR forest\nsimulation module Biomass_core.","code":""},{"path":"landr-biomass_speciesdata-module.html","id":"bsppdata-links-modules","chapter":"2 LandR Biomass_speciesData Module","heading":"2.1.3 Links to other modules","text":"Biomass_speciesData intended used LandR modules require\nspecies % cover raster layers (see examples ). See\n\navailable modules LandR ecosystem select Biomass_speciesData \ndrop-menu see potential linkages.Biomass_borealDataPrep:\nprepares parameters inputs (including initial landscape conditions)\nBiomass_core needs run realistic simulation. Default\nvalues/inputs produced relevant boreal forests Western Canada.\nUsed downstream Biomass_speciesData;Biomass_borealDataPrep:\nprepares parameters inputs (including initial landscape conditions)\nBiomass_core needs run realistic simulation. Default\nvalues/inputs produced relevant boreal forests Western Canada.\nUsed downstream Biomass_speciesData;Biomass_core: core\nforest dynamics simulation module. Used downstream \nBiomass_speciesData.Biomass_core: core\nforest dynamics simulation module. Used downstream \nBiomass_speciesData.","code":""},{"path":"landr-biomass_speciesdata-module.html","id":"module-manual-1","chapter":"2 LandR Biomass_speciesData Module","heading":"2.2 Module manual","text":"","code":""},{"path":"landr-biomass_speciesdata-module.html","id":"bsppdata-general-functioning","chapter":"2 LandR Biomass_speciesData Module","heading":"2.2.1 General functioning","text":"Biomass_speciesData accesses processes species % cover data\nparametrisation initialisation LandR Biomass_core. module\nensures 1) data use geospatial geometries 2) \ncorrectly re-projected study area used parametrisation\n(studyAreaLarge polygon), 3) attempts sequentially fill-replace\nlowest quality data higher quality data several data sources \nused. ’s primary output RasterStack species % cover,\nlayer corresponding species.Currently, module can access Canadian National Forest Inventory (NFI)\nforest attributes kNN dataset [default; Beaudoin et al. (2017)], Common\nAttribute Schema Forest Resource Inventories dataset [CASFRI; Cosco (2011)],\nOntario Forest Resource Inventory (ONFRI), dataset specific Alberta\ncompiled Paul Pickell, Alberta forest inventory datasets. However,\nNFI kNN data freely available access datasets\nmust granted module developers data owners, requires Google\naccount. Nevertheless, module flexible enough user can use \nprocess additional datasets, provided adequate R function passed \nmodule (see types parameter details list \nparameters)multiple data sources used, module replace lower quality data\nhigher quality data following order specified types parameter.multiple species given data source grouped, %\ncover summed across species group within pixel. Please see\nsppEquiv list input objects \ninformation define species groups.module can also exclude species % cover layers don’t\nminimum % cover value least one pixel. user \nstill inspect species deemed present (e.g., many pixels \ntotal), possible datasets pixels \nspecies present, reported high % cover. case,\nuser may choose exclude species posteriori. summary plot\nautomatically shown Biomass_speciesData can help diagnose whether certain\nspecies present pixels (see Fig.\n2.1).","code":""},{"path":"landr-biomass_speciesdata-module.html","id":"bsppdata-inputs-list","chapter":"2 LandR Biomass_speciesData Module","heading":"2.2.2 List of input objects","text":"full list input objects Biomass_speciesData requires\n(Table 2.2). , input\nmust provided (.e., Biomass_speciesData default\n) studyAreaLarge.inputs Table 2.2, \nfollowing particularly important deserve special attention:studyAreaLarge – polygon defining area species cover\ndata desired. can larger (never smaller) study area\nused simulation forest dynamics (.e., studyArea object \nBiomass_core), case fully cover .studyAreaLarge – polygon defining area species cover\ndata desired. can larger (never smaller) study area\nused simulation forest dynamics (.e., studyArea object \nBiomass_core), case fully cover .sppEquiv – table correspondences different species naming\nconventions. table used across several LandR modules, including\nBiomass_core. particularly important determine\nwhether species (cover layers) merged. instance,\nuser wishes simulate generic Picea spp. includes, Picea\nglauca, Picea mariana Picea engelmannii, need provide\nthree species names data column (e.g., KNN obtaining\nforest attribute kNN data layers National Forest Inventory), \nname (e.g., “Pice_Spp”) column chosen naming\nconvention used throughout simulation (defined sppEquivCol\nparameter). See Table 2.1 \nexample.sppEquiv – table correspondences different species naming\nconventions. table used across several LandR modules, including\nBiomass_core. particularly important determine\nwhether species (cover layers) merged. instance,\nuser wishes simulate generic Picea spp. includes, Picea\nglauca, Picea mariana Picea engelmannii, need provide\nthree species names data column (e.g., KNN obtaining\nforest attribute kNN data layers National Forest Inventory), \nname (e.g., “Pice_Spp”) column chosen naming\nconvention used throughout simulation (defined sppEquivCol\nparameter). See Table 2.1 \nexample.\nTable 2.1: Example species merging simulation. user wants model Abies balsamea, . lasiocarpa Pinus contorta separate species, Picea spp. genus-level group. , six species separately identified ‘KNN’ column, % cover layers can obtained, ‘Boreal’ column (defines naming convention used simulation example) Picea spp. name. Biomass_speciesData merge % cover data single layer summing cover per pixel.\n\nTable 2.2: List Biomass_speciesData input objects description.\n","code":""},{"path":"landr-biomass_speciesdata-module.html","id":"bsppdata-params-list","chapter":"2 LandR Biomass_speciesData Module","heading":"2.2.3 List of parameters","text":"Table 2.3 lists parameters used \nBiomass_speciesData detailed information. parameters \ndefault values specified module’s metadata.parameters, following particularly important:coverThresh – integer. Defines minimum % cover value (\n0-100) species must least one pixel considered\npresent study area, otherwise excluded final stack \nspecies layers (speciesLayers). Note affect species\ndata eventual simulation user need adjust\nsimulation parameters accordingly (e.g., species trait tables need\nmatch species speciesLayers).coverThresh – integer. Defines minimum % cover value (\n0-100) species must least one pixel considered\npresent study area, otherwise excluded final stack \nspecies layers (speciesLayers). Note affect species\ndata eventual simulation user need adjust\nsimulation parameters accordingly (e.g., species trait tables need\nmatch species speciesLayers).types – character. % cover data sources used\n(see General functioning). Several data\nsources can passed, case module overlay lower\nquality layers higher quality ones following order data sources\ntypes. instance, \ntypes == c(\"KNN\", \"CASFRI\", \"ForestInventory\"), KNN assumed \nlowest quality data set ForestInventory highest, hence values KNN\nlayers replaced overlapping values CASFRI layers values\nKNN CASFRI layers replaced overlapping values \nForestInventory layers.types – character. % cover data sources used\n(see General functioning). Several data\nsources can passed, case module overlay lower\nquality layers higher quality ones following order data sources\ntypes. instance, \ntypes == c(\"KNN\", \"CASFRI\", \"ForestInventory\"), KNN assumed \nlowest quality data set ForestInventory highest, hence values KNN\nlayers replaced overlapping values CASFRI layers values\nKNN CASFRI layers replaced overlapping values \nForestInventory layers.\nTable 2.3: List Biomass_speciesData parameters description.\n","code":""},{"path":"landr-biomass_speciesdata-module.html","id":"bsppdata-outputs-list","chapter":"2 LandR Biomass_speciesData Module","heading":"2.2.4 List of outputs","text":"module produces outputs Table\n2.4, automatically saves \nprocessed species cover layers output path defined \ngetPaths(sim)$outputPath.\nTable 2.4: List Biomass_speciesData output objects description.\n","code":""},{"path":"landr-biomass_speciesdata-module.html","id":"bsppdata-sim-flow","chapter":"2 LandR Biomass_speciesData Module","heading":"2.2.5 Simulation flow and module events","text":"Biomass_speciesData initialises prepares inputs provided \ninternet access download raw data layers, layers\npreviously downloaded stored folder specified \noptions(\"reproducible.destinationPath\")7.module defaults processing cover data fo species listed \nBoreal column default sppEquiv input data.table object, \navailable % cover layers kNN dataset (Table\n2.5; see ?LandR::sppEquivalencies_CA \ninformation):\nTable 2.5: List species cover data downloaded default Biomass_speciesData.\nBiomass_speciesData runs two events, init event species\ncover layers processed plotting event (initPlot) plots \nfinal layers.general flow Biomass_speciesData processes :Download (necessary) spatial processing species cover layers \nfirst data source listed types parameter. Spatial processing\nconsists sub-setting data area defined studyAreaLarge \nensuring spatial projection resolution match \nrasterToMatchLarge. spatial processing, species layers \npixels values \\(\\ge\\) coverThresh excluded.Download (necessary) spatial processing species cover layers \nfirst data source listed types parameter. Spatial processing\nconsists sub-setting data area defined studyAreaLarge \nensuring spatial projection resolution match \nrasterToMatchLarge. spatial processing, species layers \npixels values \\(\\ge\\) coverThresh excluded.one data source listed types, second set species\ncover layers downloaded processed .one data source listed types, second set species\ncover layers downloaded processed .second set layers assumed highest quality dataset \nused replaced overlapping pixel values first (including \nspecies whose layers may initially excluded applying \ncoverThresh filter).second set layers assumed highest quality dataset \nused replaced overlapping pixel values first (including \nspecies whose layers may initially excluded applying \ncoverThresh filter).Steps 2 3 repeated remaining data sources listed types.Steps 2 3 repeated remaining data sources listed types.Final layers saved disk plotted (initPlot event). summary \nnumber pixels forest cover calculated (treedand numTreed\noutput objects; see list outputs).Final layers saved disk plotted (initPlot event). summary \nnumber pixels forest cover calculated (treedand numTreed\noutput objects; see list outputs).","code":""},{"path":"landr-biomass_speciesdata-module.html","id":"bsppdata-example","chapter":"2 LandR Biomass_speciesData Module","heading":"2.3 Usage example","text":"module can run stand-alone, compiles species %\ncover data layers used modules.","code":""},{"path":"landr-biomass_speciesdata-module.html","id":"load-spades-and-other-packages.","chapter":"2 LandR Biomass_speciesData Module","heading":"2.3.1 Load SpaDES and other packages.","text":"","code":""},{"path":"landr-biomass_speciesdata-module.html","id":"bsppdata-example-libs","chapter":"2 LandR Biomass_speciesData Module","heading":"2.3.2 Set up R libraries","text":"","code":"\noptions(repos = c(CRAN = \"https://cloud.r-project.org\"))\ntempDir <- tempdir()\n\npkgPath <- file.path(tempDir, \"packages\", version$platform, paste0(version$major,\n    \".\", strsplit(version$minor, \"[.]\")[[1]][1]))\ndir.create(pkgPath, recursive = TRUE)\n.libPaths(pkgPath, include.site = FALSE)\n\nif (!require(Require, lib.loc = pkgPath)) {\n    remotes::install_github(paste0(\"PredictiveEcology/\", \"Require@5c44205bf407f613f53546be652a438ef1248147\"),\n        upgrade = FALSE, force = TRUE)\n    library(Require, lib.loc = pkgPath)\n}\n\nsetLinuxBinaryRepo()"},{"path":"landr-biomass_speciesdata-module.html","id":"bsppdata-example-pkg-mods","chapter":"2 LandR Biomass_speciesData Module","heading":"2.3.3 Get the module and module dependencies","text":"","code":"\nRequire(paste0(\"PredictiveEcology/\", \"SpaDES.project@6d7de6ee12fc967c7c60de44f1aa3b04e6eeb5db\"),\n    require = FALSE, upgrade = FALSE, standAlone = TRUE)\n\npaths <- list(inputPath = normPath(file.path(tempDir, \"inputs\")),\n    cachePath = normPath(file.path(tempDir, \"cache\")), modulePath = normPath(file.path(tempDir,\n        \"modules\")), outputPath = normPath(file.path(tempDir,\n        \"outputs\")))\n\nSpaDES.project::getModule(modulePath = paths$modulePath, c(\"PredictiveEcology/Biomass_speciesData@master\"),\n    overwrite = TRUE)\n\n## make sure all necessary packages are installed:\nouts <- SpaDES.project::packagesInModules(modulePath = paths$modulePath)\nRequire(c(unname(unlist(outs)), \"SpaDES\"), require = FALSE, standAlone = TRUE)\n\n## load necessary packages\nRequire(c(\"SpaDES\", \"LandR\", \"reproducible\"), upgrade = FALSE,\n    install = FALSE)"},{"path":"landr-biomass_speciesdata-module.html","id":"setup-simulation","chapter":"2 LandR Biomass_speciesData Module","heading":"2.3.4 Setup simulation","text":"demonstration using default parameter values, except\ncoverThresh , lowered 5%. species layers (\nmajor output interest) saved automatically, need tell\nspades save using outputs argument (see\n?SpaDES.core::outputs).pass global parameter .plotInitialTime = 1 simInitAndSpades\nfunction activate plotting.","code":"\n# User may want to set some options -- see\n# ?reproducibleOptions -- e.g., often the path to the\n# 'inputs' folder will be set outside of project by user:\n# options(reproducible.inputPaths =\n# 'E:/Data/LandR_related/') # to re-use datasets across\n# projects\nstudyAreaLarge <- Cache(randomStudyArea, size = 1e+07, cacheRepo = paths$cachePath)  # cache this so it creates a random one only once on a machine\n\n# Pick the species you want to work with -- here we use the\n# naming convention in 'Boreal' column of\n# LandR::sppEquivalencies_CA (default)\nspeciesNameConvention <- \"Boreal\"\nspeciesToUse <- c(\"Pice_Gla\", \"Popu_Tre\", \"Pinu_Con\")\n\nsppEquiv <- LandR::sppEquivalencies_CA[get(speciesNameConvention) %in%\n    speciesToUse]\n# Assign a colour convention for graphics for each species\nsppColorVect <- LandR::sppColors(sppEquiv, speciesNameConvention,\n    newVals = \"Mixed\", palette = \"Set1\")\n\n## Usage example\nmodules <- list(\"Biomass_speciesData\")\nobjects <- list(studyAreaLarge = studyAreaLarge, sppEquiv = sppEquiv,\n    sppColorVect = sppColorVect)\nparams <- list(Biomass_speciesData = list(coverThresh = 5L))"},{"path":"landr-biomass_speciesdata-module.html","id":"run-module","chapter":"2 LandR Biomass_speciesData Module","heading":"2.3.5 Run module","text":"Note data module (.e., attempts prepare data \nsimulation) iterating start end times \nset 1 .outputs Biomass_speciesData (dominant species) \nrandomly generated study area within Canada.\nFigure 2.1: Biomass_speciesData automatically generates plot species dominance number presences study area .plotInitialTime=1 passed argument.\n","code":"\nopts <- options(reproducible.useCache = TRUE, reproducible.destinationPath = paths$inputPath,\n    reproducible.useCache)\n\nmySimOut <- simInitAndSpades(times = list(start = 1, end = 1),\n    modules = modules, parameters = params, objects = objects,\n    paths = paths, .plotInitialTime = 1)\noptions(opts)"},{"path":"landr-biomass_speciesdata-module.html","id":"bsppdata-refs","chapter":"2 LandR Biomass_speciesData Module","heading":"2.4 References","text":"","code":""},{"path":"landr-biomass_borealdataprep-module.html","id":"landr-biomass_borealdataprep-module","chapter":"3 LandR Biomass_borealDataPrep Module","heading":"3 LandR Biomass_borealDataPrep Module","text":"","code":""},{"path":"landr-biomass_borealdataprep-module.html","id":"authors-2","chapter":"3 LandR Biomass_borealDataPrep Module","heading":"3.0.0.1 Authors:","text":"Yong Luo yong.luo@canada.ca [aut], Eliot J B McIntire eliot.mcintire@nrcan-rncan.gc.ca [aut, cre], Ceres Barros ceres.barros@ubc.ca [aut], Alex M. Chubaty achubaty@-cast.ca [aut]\ndocumentation work progress. Potential discrepancies omissions\nmay exist time . find , contact us using “Get help”\nlink .","code":""},{"path":"landr-biomass_borealdataprep-module.html","id":"module-overview-2","chapter":"3 LandR Biomass_borealDataPrep Module","heading":"3.1 Module Overview","text":"","code":""},{"path":"landr-biomass_borealdataprep-module.html","id":"quick-links-2","chapter":"3 LandR Biomass_borealDataPrep Module","heading":"3.1.1 Quick links","text":"General functioningGeneral functioningList input objectsList input objectsList parametersList parametersList outputsList outputsSimulation flow module eventsSimulation flow module events","code":""},{"path":"landr-biomass_borealdataprep-module.html","id":"summary-1","chapter":"3 LandR Biomass_borealDataPrep Module","heading":"3.1.2 Summary","text":"LandR Biomass_borealDataPrep (hereafter Biomass_borealDataPrep), prepares\nnecessary inputs Biomass_core based data available forests\nacross Canada forests, focused Western Canada boreal forest systems.\nNevertheless, provides good foundation develop modules aimed\ndifferent geographical contexts. keeping data preparation parameter\nestimation outside Biomass_core, promote modularity \nLandR-based model systems facilitate interoperability parameter\nestimation procedures.Specifically, prepares adjusts invariant spatially-varying species\ntrait values, well ecolocation-specific parameters, probabilities \ngermination initial conditions necessary run Biomass_core. ,\nBiomass_borealDataPrep requires internet access retrieve default\ndata8.advise future users run Biomass_borealDataPrep defaults inspect\nresulting input objects like supplying alternative data (data\nURLs).","code":""},{"path":"landr-biomass_borealdataprep-module.html","id":"bboreal-links-modules","chapter":"3 LandR Biomass_borealDataPrep Module","heading":"3.1.3 Links to other modules","text":"Biomass_borealDataPrep intended used \nBiomass_core, can \nlinked data modules prepare inputs. See\n\navailable modules LandR ecosystem select Biomass_borealDataPrep\ndrop-menu see potential linkages.Biomass_core: core\nforest dynamics simulation module. Used downstream \nBiomass_borealDataPrep;Biomass_core: core\nforest dynamics simulation module. Used downstream \nBiomass_borealDataPrep;Biomass_speciesData:\ngrabs merges several sources species cover data, making species\npercent cover (% cover) layers used LandR Biomass\nmodules. Default source data spans entire Canadian territory. Used\nupstream Biomass_borealDataPrep;Biomass_speciesData:\ngrabs merges several sources species cover data, making species\npercent cover (% cover) layers used LandR Biomass\nmodules. Default source data spans entire Canadian territory. Used\nupstream Biomass_borealDataPrep;Biomass_speciesParameters:\ncalibrates four-species level traits using permanent sample plot data (.e.,\nrepeated tree biomass measurements) across Western Canada. Used downstream\nBiomass_borealDataPrep.Biomass_speciesParameters:\ncalibrates four-species level traits using permanent sample plot data (.e.,\nrepeated tree biomass measurements) across Western Canada. Used downstream\nBiomass_borealDataPrep.","code":""},{"path":"landr-biomass_borealdataprep-module.html","id":"module-manual-2","chapter":"3 LandR Biomass_borealDataPrep Module","heading":"3.2 Module manual","text":"","code":""},{"path":"landr-biomass_borealdataprep-module.html","id":"bboreal-general-functioning","chapter":"3 LandR Biomass_borealDataPrep Module","heading":"3.2.1 General functioning","text":"Biomass_borealDataPrep prepares inputs necessary run realistic\nsimulation forest dynamics Western Canadian boreal forests using\nBiomass_core. Part process involves cleaning input data \nimputing missing data cases, discussed detail Data\nacquisition treatment.cleaning formatting raw input data, module:calculates species biomass per pixel multiplying observed species\n% cover observed stand biomass adjustment factor,\ncan statistically calibrated study area. Given \nadjusts species biomass, calibration step contributes \ncalibration maxB maxANPP trait values, whose estimation also\nbased species biomass (see Initial species age biomass per\npixel Adjustment species\nbiomass);calculates species biomass per pixel multiplying observed species\n% cover observed stand biomass adjustment factor,\ncan statistically calibrated study area. Given \nadjusts species biomass, calibration step contributes \ncalibration maxB maxANPP trait values, whose estimation also\nbased species biomass (see Initial species age biomass per\npixel Adjustment species\nbiomass);prepares invariant species traits – spatio-temporally\nconstant species traits influence population dynamics (e.g., growth,\nmortality, dispersal) responses fire (see Invariant species\ntraits);prepares invariant species traits – spatio-temporally\nconstant species traits influence population dynamics (e.g., growth,\nmortality, dispersal) responses fire (see Invariant species\ntraits);defines ecolocations – groupings pixels similar biophysical\nconditions. default, ecolocations defined spatial combination\necodistricts National Ecological Framework Canada, \nLand Cover Canada 2010 map (see Defining simulation pixels \necolocations). Note ecolocation\ntermed ecoregionGroup across LandR modules.defines ecolocations – groupings pixels similar biophysical\nconditions. default, ecolocations defined spatial combination\necodistricts National Ecological Framework Canada, \nLand Cover Canada 2010 map (see Defining simulation pixels \necolocations). Note ecolocation\ntermed ecoregionGroup across LandR modules.prepares ecolocation-specific parameters probabilities \ngermination – one ecolocation-specific parameter used, \nminimum relative biomass thresholds, defines \nlevel shade pixel. Together level shade \nprobabilities germination influence germination\nsuccess given pixel;prepares ecolocation-specific parameters probabilities \ngermination – one ecolocation-specific parameter used, \nminimum relative biomass thresholds, defines \nlevel shade pixel. Together level shade \nprobabilities germination influence germination\nsuccess given pixel;estimates spatio-temporally varying species traits – species traits\ncan vary ecolocation time. maximum biomass\n(maxB), maximum -ground net primary productivity (maxANPP; see\nMaximum biomass maximum aboveground net primary\nproductivity) species establishment probability\n(SEP, called establishprob module traits table; see Species\nestablishment probability). default,\nBiomass_borealDataPrep estimates temporally constant values maxB,\nmaxANPP SEP;estimates spatio-temporally varying species traits – species traits\ncan vary ecolocation time. maximum biomass\n(maxB), maximum -ground net primary productivity (maxANPP; see\nMaximum biomass maximum aboveground net primary\nproductivity) species establishment probability\n(SEP, called establishprob module traits table; see Species\nestablishment probability). default,\nBiomass_borealDataPrep estimates temporally constant values maxB,\nmaxANPP SEP;creates initial landscape conditions – Biomass_borealDataPrep\nperforms data-based landscape initialisation, creating species cohort\ntable (cohortData) corresponding map (pixelGroupMap; used \ninitialise track cohorts across landscape) based observed stand\nage species biomass.creates initial landscape conditions – Biomass_borealDataPrep\nperforms data-based landscape initialisation, creating species cohort\ntable (cohortData) corresponding map (pixelGroupMap; used \ninitialise track cohorts across landscape) based observed stand\nage species biomass.Biomass_core simulates tree species dynamics, Biomass_borealDataPrep\nprepares inputs estimates parameters pixels within forested\nland-cover classes (see Defining simulation pixels \necolocations).studyAreaLarge supplied, module uses parameter estimation\naccount larger spatial variability.next sections, describe greater detail various data processing\nparameter estimation steps carried Biomass_borealDataPrep.","code":""},{"path":"landr-biomass_borealdataprep-module.html","id":"bboreal-dataprep","chapter":"3 LandR Biomass_borealDataPrep Module","heading":"3.2.2 Data acquisition and treatment","text":"two objects user must supply shapefiles define \nstudy area used derive parameters (studyAreaLarge) study area \nsimulation happen (studyArea). two objects can identical \nuser chooses parametrise run simulations area. \nidentical, studyArea must fully within studyAreaLarge. \nstudyAreaLarge studyArea Canada, module can\nautomatically estimate prepare input parameters objects \nBiomass_core, default raw data FAIR data (sensu Wilkinson et al. 2016) national-scale.inputs supplied, Biomass_borealDataPrep create raster\nlayer versions studyAreaLarge studyArea (rasterToMatchLarge \nrasterToMatch, respectively), using stand biomass map layer\n(rawBiomassMap) template (.e., source information spatial\nresolution).","code":""},{"path":"landr-biomass_borealdataprep-module.html","id":"bboreal-forestedPix-ecolocations","chapter":"3 LandR Biomass_borealDataPrep Module","heading":"3.2.2.1 Defining simulation pixels and ecolocations","text":"Biomass_borealDataPrep uses land-cover data define assign parameter\nvalues pixels forest dynamics simulated (forested pixels).\ndefault uses land-cover classes Land Cover Canada 2010 v1\nmap,\nraster-based database distinguishes several forest non-forest\nland-cover types. Pixels classes 1 6 included forested pixels\n(see parameter forestedLCCClasses).land-cover raster (rstLCC) includes transient cover types (e.g.,\nrecent burns) user may pass vector transient class IDs (via \nparameter LCCClassesToReplaceNN) reclassified “stable”\nforested class (defined via parameter forestedLCCClasses). \nreclassification done searching focal neighbourhood replacement\nforested cover class (radius 1250m focal cell). \nforested class found within perimeter, pixel used simulate\nforest dynamics. Reclassified pixels omitted fitting statistical\nmodels used parameter estimation, assigned predicted values \nmodels.Sub-regional spatial variation maxBiomass, maxANPP, SEP species\ntraits accounted ecolocation. Ecolocations used proxies \nbiophysical variation across landscape estimating model parameters \nvary spatially. default, defined combination \n“ecodistricts” National Ecological Framework \nCanada\n(broad-scale polygon layer captures sub-regional variation)\n(ecoregionLayer) land cover (rstLCC), user can change\nsupplying different ecozonation land-cover layers.","code":""},{"path":"landr-biomass_borealdataprep-module.html","id":"bboreal-sppcover","chapter":"3 LandR Biomass_borealDataPrep Module","heading":"3.2.2.2 Species cover","text":"Species cover (% cover) raster layers (speciesLayers) can\nautomatically obtained pre-processed Biomass_borealDataPrep. \nmodule ensures :data geospatial properties (extent, resolution);layers correctly re-projected studyAreaLarge \nrasterToMatchLarge;species cover values 10% excluded.default uses species % cover rasters derived MODIS\nsatellite imagery 2001, obtained Canadian National Forest\nInventory (Beaudoin et al. 2017) – hereafter ‘kNN species data’.","code":""},{"path":"landr-biomass_borealdataprep-module.html","id":"bboreal-init-B-age","chapter":"3 LandR Biomass_borealDataPrep Module","heading":"3.2.2.3 Initial species age and biomass per pixel","text":"Stand age aboveground stand biomass (hereafter ‘stand biomass’) used \nderive parameters define initial species age biomass across \nlandscape. also derived MODIS satellite imagery 2001\nprepared NFI (Beaudoin et al. 2017) default.Biomass_borealDataPrep downloads data performs number data\nharmonization operations deal data inconsistencies. first searches \nmismatches stand age (standAge), stand biomass (standB) total\nstand cover (standCover), assuming cover accurate \nthree, biomass least, following order:Pixels standCover < 5% removed;Pixels standCover < 5% removed;Pixels standAge == 0, assigned standB == 0;Pixels standAge == 0, assigned standB == 0;Pixels standB == 0, assigned standAge == 0.Pixels standB == 0, assigned standAge == 0., species assigned one cohort per pixel according corrected stand\nage, stand biomass % cover values. Cohort age assumed \nstand age biomass product stand biomass species\n% cover. , stand cover rescaled vary 0\n100%.next set data inconsistencies cohort age (age), biomass (B) \ncover (cover) looked solved following order:cover > 0 age == 0, B set 0 (stand biomass\nrecalculated);cover > 0 age == 0, B set 0 (stand biomass\nrecalculated);cover == 0 age > 0, age == NA, age empirically\nestimated using remainder data fit model supplied \nP(sim)$imputeBadAgeModel, defaults :cover == 0 age > 0, age == NA, age empirically\nestimated using remainder data fit model supplied \nP(sim)$imputeBadAgeModel, defaults :Cohort biomass adjusted reflect different cover biomass\nrelationship conifer broadleaf species (see Adjustment initial\nspecies biomass).Finally, Biomass_borealDataPrep can use fire perimeters correct stand ages.\n, downloads latest fire perimeter data Canadian\nWildfire Data Base changes pixel\nage inside fire perimeters match time since last fire, using fire years\nfirst year simulation.assumes 1) last fire stand replacing fire 2) \nfirst year simulation later first fire year fire\nperimeter data. user want assume 1), data imputation\nstep can bypassed setting parameter P(sim)$overrideBiomassInFires \nFALSE P(sim)$fireURL NULL NA.pixels ages changed match time since last fire, cohort\nbiomass needs corrected – default datasets noticed\nbiomass inflated pixels recent burns. Consequently, module uses \nspin-simulation grows cohorts fixed age inside pixel using\nestimated maxB maxANPP parameters (see Maximum biomass maximum\naboveground net primary productivity).Note pixels data imputation can removed simulation\nsetting P(sim)$rmImputedPix == TRUE.","code":"## [[1]]\n## lme4::lmer(age ~ log(totalBiomass) * cover * speciesCode + (log(totalBiomass) | \n##     initialEcoregionCode))"},{"path":"landr-biomass_borealdataprep-module.html","id":"bboreal-invariant-traits","chapter":"3 LandR Biomass_borealDataPrep Module","heading":"3.2.2.4 Invariant species traits","text":"invariant species traits obtained available species trait tables\nused LANDIS-II applications Canada’s boreal forests (available Dominic\nCyr’s GitHub repository).\nadapted minor adjustments match Western Canadian boreal\nforests using published literature. Others (key growth mortality traits) can\ncalibrated Biomass_speciesParameters (see Calibrating species\ngrowth/mortality traits using\nBiomass_speciesParameters).LANDIS-II species trait table contains species trait values \nCanadian Ecozone (NRCan 2013), default filtered Boreal\nShield West (BSW), Boreal Plains (BP) Montane Cordillera Canadian Ecozones\n(via P(sim)$speciesTableAreas). trait values vary across \necozones given species, minimum value used.function LandR::speciesTableUpdate used default \nadjustments trait values table (intended, custom\nfunction call NULL can passed P(sim)$speciesUpdateFunction):Longevity values adjusted match values Burton & Cumming (1995b), \nmatch BSP, BP MC ecozones. adjustments result higher longevity\nspecies;Longevity values adjusted match values Burton & Cumming (1995b), \nmatch BSP, BP MC ecozones. adjustments result higher longevity\nspecies;Shade tolerance values lowered Abies balsamifera, Abies\nlasiocarpa, Picea engelmanii, Picea glauca, Picea mariana, Tsuga\nheterophylla Tsuga mertensiana better relative shade tolerance\nlevels Western Canada. relative shade tolerances, \nuser always check values respect study\nareas species pool.Shade tolerance values lowered Abies balsamifera, Abies\nlasiocarpa, Picea engelmanii, Picea glauca, Picea mariana, Tsuga\nheterophylla Tsuga mertensiana better relative shade tolerance\nlevels Western Canada. relative shade tolerances, \nuser always check values respect study\nareas species pool.user can also pass one function call \nP(sim)$speciesUpdateFunction want make adjustments \naddition listed (see ?LandR::updateSpeciesTable).","code":""},{"path":"landr-biomass_borealdataprep-module.html","id":"bboreal-prob-germ","chapter":"3 LandR Biomass_borealDataPrep Module","heading":"3.2.2.5 Probabilities of germination","text":"default, Biomass_borealDataPrep uses probabilities germination\n(called sufficientLight module) Biomass_core. obtained\npublicly available LANDIS-II\ntable.","code":""},{"path":"landr-biomass_borealdataprep-module.html","id":"parameter-estimationcalibration","chapter":"3 LandR Biomass_borealDataPrep Module","heading":"3.2.3 Parameter estimation/calibration","text":"","code":""},{"path":"landr-biomass_borealdataprep-module.html","id":"bboreal-adjustB","chapter":"3 LandR Biomass_borealDataPrep Module","heading":"3.2.3.1 Adjustment of initial species biomass","text":"Biomass_borealDataPrep estimates initial values species aboveground biomass\n(B) based stand biomass (standB) individual species %\ncover. Initial B estimated species pixel multiplying\nstandB species % cover. default cover layers \nsatellite-derived, relationship relative cover relative biomass\nbroadleaf conifer species needs adjusted reflect different\ncanopy architectures (using P(sim)$deciduousCoverDiscount).default, Biomass_borealDataPrep uses previously estimated\nP(sim)$deciduousCoverDiscount based Northwest Territories data. However,\nuser can chose re-estimate setting\nP(sim)$fitDeciduousCoverDiscount == TRUE. case, default\nBiomass_borealDataPrep fit following model:relates estimated biomass (B) interaction term \nlog-age (logAge), standB (‘totalBiomass’), speciesCode (.e. species ID)\nland cover (‘lcc’). model fitted standB species cover \nstudyAreaLarge, using optimization routine searches best\nconversion factor broadleaf species cover B minimizing AIC.","code":"## [[1]]\n## glm(I(log(B/100)) ~ logAge * I(log(totalBiomass/100)) * speciesCode * \n##     lcc)"},{"path":"landr-biomass_borealdataprep-module.html","id":"bboreal-maxB-maxANPP","chapter":"3 LandR Biomass_borealDataPrep Module","heading":"3.2.3.2 Maximum biomass and maximum aboveground net primary productivity","text":"Biomass_borealDataPrep statistically estimates maximum biomass (maxB) \nmaximum aboveground net primary productivity (maxANPP) using processed\nspecies ages biomass.maxB estimated modelling response species biomass (B) \nspecies age cover, accounting variation ecolocations\n(ecoregionGroup ):coefficients estimated maximum likelihood model fit calculated\nproportion explained variance explained fixed effects \n(marginal r2) entire model (conditional r2) – \nprinted messages.model can take fit, default sample pixels within\nspecies ecolocation combination (sample size defined \nP(sim)$subsetDataBiomassModel parameter).convergence issues occur P(sim)$fixModelBiomass == TRUE, module\nattempts refit model re-sampling data, re-fitting lmer \nbobyqa optimizer, re-scaling continuous predictors (default,\ncover logAge). steps tried additively convergence\nissue resolved. module still unable solve convergence issue \nmessage printed module uses last fitted model.Note convergence issues usually problematic estimation \ncoefficient values, estimation standard errors. However, \nuser always inspect final model (especially converged) \nmake sure problems significant fitted model meets\nresidual assumptions. , user make sure model objects \nexported simList using exportModels parameter.Alternative model calls/formulas can supplied via P(sim)$biomassModel\nparameter. Note supplying model call use lme4::lmer\nrefitting process likely fail may disabled (via \nP(sim)$fixModelBiomass parameter).Another consideration add respect estimation maxB, \nchoosing linear model relate B ~ log(age) + cover. \nideal ecological point view, biomass unlikely vary linearly\nage cover, likely saturate beyond certain high value \ncover follow hump-shaped curve age (.e., reaching maximum values \ngiven age, starting decrease trees approach longevity). Also,\nfitting linear model can lead negative B values young ages low\ncover. However, tests revealed linear mixed effects model \nproducing abnormal estimates B maximum values age cover (hence,\nmaxB estimates), allowing leverage powerful statistical\nmachinery lme4.Finally, highlight modelling log(B) appropriate solution,\nwrongly assume exponential relationship \nB ~ log(age) + cover, leading serious overestimation maxB(Fig.\n3.1) steep increases species biomasses\nfirst years simulation (Fig. 3.2).\nFigure 3.1: Modelling biomass linear vs. exponential relationship. ) modelBiomass B ~ logAge * speciesCode + cover * speciesCode + (logAge + cover | ecoregionGroup). b) modelBiomass logB ~ logAge * speciesCode + cover * speciesCode + (logAge + cover | ecoregionGroup). Blue dots marginal mean B values (back-transformed b) cross ages confidence intervals bars.\n\nFigure 3.2: Thirty years simulation maxB values estimated logB ~ ... biomassModel (see Fig. 3.1). steep increase little time abnormal.\nbiomass model fit, maxB predicted species ecolocation\ncombination, maximum species cover values (100%) maximum\nlog-age (log species longevity). using Biomass_speciesParameters,\nmaxB calibrated species can achieve maximum observed biomass\nsimulation (see Calibrating species growth/mortality traits using\nBiomass_speciesParameters).maxANPP calculated maxB * mANPPproportion/100, \nmANPPproportion defaults 3.33, unless calibrated \nBiomass_speciesParameters (see Calibrating species growth/mortality traits\nusing Biomass_speciesParameters). default\nvalue, 3.33, comes inversion rationale used calculate maxB\nScheller & Mladenoff (2004). , authors estimated maxANPP using \nmodel PnET-II (adjusted values manually) estimates\ncalculated maxB multiplying estimated maxANPP 30.","code":"## [[1]]\n## lme4::lmer(B ~ logAge * speciesCode + cover * speciesCode + (logAge + \n##     cover | ecoregionGroup))"},{"path":"landr-biomass_borealdataprep-module.html","id":"bboreal-SEP","chapter":"3 LandR Biomass_borealDataPrep Module","heading":"3.2.3.3 Species establishment probability","text":"Species establishment probability (SEP, establishprob module) \nestimated modelling probability observing given species \necolocation. , Biomass_borealDataPrep models relationship \nprobability occurrence species (\\(\\pi\\)) using following model \ndefault:whereby probability occurrence species (\\(\\pi\\)) – calculated \nproportion pixels % cover > 0 – modelled per species \necolocation following binomial distribution logit link function. \ndata sub-sampling done fitting SEP statistical model, \nmodel fits quickly even large sample sizes (e.g., > 20 million\npoints).SEP predicted species ecolocation combination resulting\nvalues integrated length succession time step\n(successionTimestep parameter) :important, since seed establishment occurs every\nP(sim)$successionTimestep, thus probabilities seed establishment\nneed temporally integrated reflect probability seed\nestablishing period time.Finally, since observed species cover used fit coverModel result\nseed establishment resprouting/clonal growth, final species\nestablishment probabilities calculated function temporally\nintegrated presence probabilities species’ probabilities resprouting\n(resproutprob, species table) (bounded 0 1):\\(SEP > 1\\), :\\(SEP < 0\\), :","code":"## [[1]]\n## glm(cbind(coverPres, coverNum - coverPres) ~ speciesCode * ecoregionGroup, \n##     family = binomial)"},{"path":"landr-biomass_borealdataprep-module.html","id":"bboreal-minRelB","chapter":"3 LandR Biomass_borealDataPrep Module","heading":"3.2.3.4 Ecolocation-specific parameter – minimum relative biomass","text":"Minimum relative biomass (minRelativeB) spatially-varying parameter used\ndetermine shade level pixel. shade class (X0-X5) defined\nminimum relative biomass threshold compared pixel’s current relative\nbiomass, calculated sum pixel’s total biomass divided \ntotal potential maximum biomass pixel (sum maxB \npixel’s ecolocation).Since found data base parametrisation shade class\nthresholds, default values based publicly available values used \nLANDIS-II applications Canada’s boreal forests (available Dominic Cyr’s\nGitHub repository), \necolocations share values.Initial runs revealed excessive recruitment moderately shade-intolerant\nspecies even stand biomass increased, values shade levels X4 X5\nadjusted downwards (X4: 0.8 0.75; X5: 0.90 0.85) reflect higher\ncompetition resources (e.g. higher water limitation) Western Canadian\nforests regards Eastern Canadian forests (Messier et al. 1998), \nlikely driven higher moisture limitation west (Hogg et al. 2008; Peng et al. 2011).adjustment can bypassed either supplying minRelativeB table, \nalternative function call P(sim)$minRelativeBFunction (default\nLandR::makeMinRelativeB.minimum biomass threshold shade level X0 0 standB.","code":""},{"path":"landr-biomass_borealdataprep-module.html","id":"bboreal-B_sppParams-calib","chapter":"3 LandR Biomass_borealDataPrep Module","heading":"3.2.3.5 Calibrating species growth/mortality traits using Biomass_speciesParameters","text":"using Biomass_borealDataPrep Biomass_speciesParameters, later\nmodule calibrates several species traits first prepared \nBiomass_borealDataPrep:growthcurve, mortalityshape – initially come publicly\navailable LANDIS-II tables;growthcurve, mortalityshape – initially come publicly\navailable LANDIS-II tables;maxBiomass, maxANPP – estimated statistically \nBiomass_borealDataPrep (see Maximum biomass maximum aboveground net\nprimary productivity).maxBiomass, maxANPP – estimated statistically \nBiomass_borealDataPrep (see Maximum biomass maximum aboveground net\nprimary productivity).Briefly, Biomass_speciesParameters:Uses ~41,000,000 hypothetical species’ growth curves (generated \nBiomass_core), cover fully factorial combination longevity,\nratio maxANPP maxBiomass, growthcurve, mortalityshape;Uses ~41,000,000 hypothetical species’ growth curves (generated \nBiomass_core), cover fully factorial combination longevity,\nratio maxANPP maxBiomass, growthcurve, mortalityshape;Takes permanent temporary sample plot (PSP) data near study\narea target species, finds hypothetical species’ growth\ncurve closely matches growth curve observed PSP data – \nspecies--species base. gives us species’ growthcurve,\nmortalityshape, new species trait, mANPPproportion, ratio \nmaximum aboveground net primary productivity (maxANPP) maximum biomass\n(maxBiomass, confounded maxB) study area.Takes permanent temporary sample plot (PSP) data near study\narea target species, finds hypothetical species’ growth\ncurve closely matches growth curve observed PSP data – \nspecies--species base. gives us species’ growthcurve,\nmortalityshape, new species trait, mANPPproportion, ratio \nmaximum aboveground net primary productivity (maxANPP) maximum biomass\n(maxBiomass, confounded maxB) study area.Introduces second new species trait, inflationFactor, re-calibrates\nmaxB. recognize maxB, obtained empirically \nBiomass_borealDataPrep, easily reached simulations \nreasonable values growthcurve, mortalityshape longevity\nprevent equation reaching maxB (acts asymptote \nnever approached). inflationFactor calculated ratio \nmaxBiomass (parameter used generate theoretical growth curves \nstep 1) maximum biomass actually achieved theoretical growth\ncurves (step 1). maxB recalibrated multiplying \ninflationFactor. , resulting non-linear growth curves\ngenerated Biomass_core simulation able achieve \nempirically estimated maxB.Introduces second new species trait, inflationFactor, re-calibrates\nmaxB. recognize maxB, obtained empirically \nBiomass_borealDataPrep, easily reached simulations \nreasonable values growthcurve, mortalityshape longevity\nprevent equation reaching maxB (acts asymptote \nnever approached). inflationFactor calculated ratio \nmaxBiomass (parameter used generate theoretical growth curves \nstep 1) maximum biomass actually achieved theoretical growth\ncurves (step 1). maxB recalibrated multiplying \ninflationFactor. , resulting non-linear growth curves\ngenerated Biomass_core simulation able achieve \nempirically estimated maxB.Estimates species-specific maxANPP multiplying final maxB \nmANPPproportion (estimated step 2).Estimates species-specific maxANPP multiplying final maxB \nmANPPproportion (estimated step 2).cases insufficient PSP data perform steps, maxB\nmaxANPP left estimated Biomass_borealDataPrep (see Maximum\nbiomass maximum aboveground net primary\nproductivity) inflationFactor \nmANPPproportion take default values 1 3.33.","code":""},{"path":"landr-biomass_borealdataprep-module.html","id":"aggregating-species","chapter":"3 LandR Biomass_borealDataPrep Module","heading":"3.2.4 Aggregating species","text":"Biomass_borealDataPrep use input table sppEquiv parameter\nP(sim)$sppEquivCol select naming convention use \nsimulation (see full list input objects \nparameters details). user can use table \nparameter define groupings “merge” similar species invariant\ntrait values (see Invariant species traits) (e.g.\ngenus-level group functional group). , name species group\nsppEquivCol column sppEquiv table must identical grouped species.\nTable 3.1: Example species merging simulation. user wants model Abies balsamea, . lasiocarpa Pinus contorta separate species, Picea spp. genus-level group. , six species identified ‘KNN’ column, % cover layers can obtained, ‘Boreal’ column (defines naming convention used simulation example) Picea spp. name. Biomass_borealDataPrep merge % cover data single layer summing cover per pixel.\ngroups contain species different (invariant) trait values, minimum\nvalue across species used. default species % cover\nlayers, Biomass_borealDataPrep proceeds way \nBiomass_speciesData sums cover across species group per pixel.","code":""},{"path":"landr-biomass_borealdataprep-module.html","id":"bboreal-inputs-list","chapter":"3 LandR Biomass_borealDataPrep Module","heading":"3.2.5 List of input objects","text":"full lists input objects (Table\n3.2) Biomass_borealDataPrep\nexpects.inputs must provided (.e., Biomass_borealDataPrep \ndefault ) studyArea (study area used simulate forest\ndynamics Biomass_core) studyAreaLarge (potentially larger study area\nused derive parameter values – e.g., species traits).input objects parameters internal defaults.inputs, following particularly important deserve special\nattention:Spatial layersecoregionLayer ecoregionRst – shapefile map containing\necological zones.ecoregionLayer ecoregionRst – shapefile map containing\necological zones.rawBiomassMap – map observed stand biomass (\\(g/m^2\\)).rawBiomassMap – map observed stand biomass (\\(g/m^2\\)).rstLCC – land-cover raster.rstLCC – land-cover raster.speciesLayers – layers species % cover data. species\nmust match available default (provided) species traits tables\n(species speciesEcoregion tables).speciesLayers – layers species % cover data. species\nmust match available default (provided) species traits tables\n(species speciesEcoregion tables).standAgeMap – map observed stand ages (years).standAgeMap – map observed stand ages (years).studyArea – shapefile. SpatialPolygonsDataFrame single polygon\ndetermining simulation take place. input object\nmust supplied user.studyArea – shapefile. SpatialPolygonsDataFrame single polygon\ndetermining simulation take place. input object\nmust supplied user.studyAreaLarge – shapefile. SpatialPolygonsDataFrame single\npolygon determining statistical models parameter\nestimation fitted. must contain studyArea fully, \nidentical. object must supplied user.studyAreaLarge – shapefile. SpatialPolygonsDataFrame single\npolygon determining statistical models parameter\nestimation fitted. must contain studyArea fully, \nidentical. object must supplied user.TablesspeciesTable – table invariant species traits must \nfollowing columns (even necessary simulation):\n“species”, “Area”, “longevity”, “sexualmature”, “shadetolerance”,\n“firetolerance”, “seeddistance_eff”, “seeddistance_max”, “resproutprob”,\n“resproutage_min”, “resproutage_max”, “postfireregen”, “leaflongevity”,\n“wooddecayrate”, “mortalityshape”, “growthcurve”, “leafLignin”, “hardsoft”.\norder can vary column names must identical. See Scheller & Miranda (2015a)\nBiomass_core manual detail columns.\nTable 3.2: List Biomass_borealDataPrep input objects description.\n","code":""},{"path":"landr-biomass_borealdataprep-module.html","id":"bboreal-params-list","chapter":"3 LandR Biomass_borealDataPrep Module","heading":"3.2.6 List of parameters","text":"Table 3.3 lists parameters used\nBiomass_borealDataPrep detailed information. default\nvalues specified module’s metadata.parameters, following particularly important:Estimation simulation parametersbiomassModel – statistical model (function call) used \nestimate maxB maxANPP.biomassModel – statistical model (function call) used \nestimate maxB maxANPP.coverModel – statistical model (function call) used estimate\nSEP.coverModel – statistical model (function call) used estimate\nSEP.fixModelBiomass – determines whether biomassModel re-fit \nconvergence issues arise.fixModelBiomass – determines whether biomassModel re-fit \nconvergence issues arise.imputeBadAgeModel – model used impute ages missing, \nmatch input cover biomass data. confounded \ncorrecting ages fire dataimputeBadAgeModel – model used impute ages missing, \nmatch input cover biomass data. confounded \ncorrecting ages fire datasubsetDataAgeModel subsetDataBiomassModel – control data\nsub-sampling fitting imputeBadAgeModel biomassModel,\nrespectivelysubsetDataAgeModel subsetDataBiomassModel – control data\nsub-sampling fitting imputeBadAgeModel biomassModel,\nrespectivelyexportModels – controls whether biomassModel coverModel ()\nexported simulation simList, can useful \ninspect fitted models report statistical fit.exportModels – controls whether biomassModel coverModel ()\nexported simulation simList, can useful \ninspect fitted models report statistical fit.sppEquivCol – character. column name speciesEquivalency\ndata.table defines naming convention use throughout \nsimulation.sppEquivCol – character. column name speciesEquivalency\ndata.table defines naming convention use throughout \nsimulation.Data processingforestedLCCClasses LCCClassesToReplaceNN – define land-cover\nclasses rstLCC forested reclassified \nforested classes, respectively.forestedLCCClasses LCCClassesToReplaceNN – define land-cover\nclasses rstLCC forested reclassified \nforested classes, respectively.deciduousCoverDiscount, coverPctToBiomassPctModel \nfitDeciduousCoverDiscount – first adjustment factor \nbroadleaf species cover biomass relationships; second third \nmodel used refit deciduousCoverDiscount supplied\nstudyAreaLarge whether refitting attempted (respectively).deciduousCoverDiscount, coverPctToBiomassPctModel \nfitDeciduousCoverDiscount – first adjustment factor \nbroadleaf species cover biomass relationships; second third \nmodel used refit deciduousCoverDiscount supplied\nstudyAreaLarge whether refitting attempted (respectively).\nTable 3.3: List Biomass_borealDataPrep parameters description.\n","code":""},{"path":"landr-biomass_borealdataprep-module.html","id":"bboreal-outputs-list","chapter":"3 LandR Biomass_borealDataPrep Module","heading":"3.2.7 List of outputs","text":"module produces following outputs (Table\n3.4), key inputs \nBiomass_core.TablescohortData – initial community table, containing corrected biomass\n(g/m2), age species cover data, well ecolocation pixelGroup\ninformation. table defines initial community composition \nstructure used Biomass_core.cohortData – initial community table, containing corrected biomass\n(g/m2), age species cover data, well ecolocation pixelGroup\ninformation. table defines initial community composition \nstructure used Biomass_core.species – table invariant species traits. contain traits\nspeciesTable , adjusted necessary.species – table invariant species traits. contain traits\nspeciesTable , adjusted necessary.speciesEcoregion – table spatially-varying species traits (maxB,\nmaxANPP, SEP).speciesEcoregion – table spatially-varying species traits (maxB,\nmaxANPP, SEP).minRelativeB – minimum relative biomass thresholds determine shade\nlevel pixel. X0-5 represent site shade classes -shade (0) \nmaximum shade (5).minRelativeB – minimum relative biomass thresholds determine shade\nlevel pixel. X0-5 represent site shade classes -shade (0) \nmaximum shade (5).sufficientLight – probability germination species shade tolerance\n(species) shade level(defined byminRelativeB`)sufficientLight – probability germination species shade tolerance\n(species) shade level(defined byminRelativeB`)Spatial layersbiomassMap – map initial stand biomass values adjustments \ndata mismatches.biomassMap – map initial stand biomass values adjustments \ndata mismatches.pixelGroupMap – map containing pixelGroup IDs per pixel. defines\ninitial map used hashing within Biomass_core, conjunction \ncohortData.pixelGroupMap – map containing pixelGroup IDs per pixel. defines\ninitial map used hashing within Biomass_core, conjunction \ncohortData.ecoregionMap – map ecolocations.ecoregionMap – map ecolocations.\nTable 3.4: List Biomass_borealDataPrep output objects description.\n","code":""},{"path":"landr-biomass_borealdataprep-module.html","id":"bboreal-sim-flow","chapter":"3 LandR Biomass_borealDataPrep Module","heading":"3.2.8 Simulation flow and module events","text":"Biomass_borealDataPrep initialises prepares inputs, provided \ninternet access retrieve raw datasets, parametrisation \nuse Biomass_core.module runs one time step contains general flow \nBiomass_borealDataPrep processes :Preparation necessary data input objects require\nparameter fitting (e.g., invariant species traits table, creating\necolocations);Preparation necessary data input objects require\nparameter fitting (e.g., invariant species traits table, creating\necolocations);Fixing mismatched raw cover, biomass age data;Fixing mismatched raw cover, biomass age data;Imputing age values pixels mismatches exist age data missing;Imputing age values pixels mismatches exist age data missing;Construction initial data.table cohort biomass age per pixel\n(ecolocation information);Construction initial data.table cohort biomass age per pixel\n(ecolocation information);Sub-setting pixels forested land-cover classes (optional) converting\ntransient land-cover classes forested classes;Sub-setting pixels forested land-cover classes (optional) converting\ntransient land-cover classes forested classes;Fitting coverModel;Fitting coverModel;Fitting biomassModel (re-fitting necessary – optional);Fitting biomassModel (re-fitting necessary – optional);Estimating maxB, maxANPP SEP per species ecolocation.Estimating maxB, maxANPP SEP per species ecolocation.(OPTIONAL) Correcting ages pixels inside fire perimeters reassigning\nbiomass.(OPTIONAL) Correcting ages pixels inside fire perimeters reassigning\nbiomass.[steps 1-9 part init event. step 1, data downloaded\nrun .inputObjects function](OPTIONAL) Plots maxB, maxANPP SEP maps (plot event);(OPTIONAL) Plots maxB, maxANPP SEP maps (plot event);(OPTIONAL) Save outputs (save event)(OPTIONAL) Save outputs (save event)","code":""},{"path":"landr-biomass_borealdataprep-module.html","id":"bboreal-example","chapter":"3 LandR Biomass_borealDataPrep Module","heading":"3.3 Usage example","text":"module can run stand-alone, won’t much prepare\ninputs Biomass_core. Hence, provide usage example module \nothers \nrepository \nBarros et al. (review).","code":""},{"path":"landr-biomass_borealdataprep-module.html","id":"bboreal-refs","chapter":"3 LandR Biomass_borealDataPrep Module","heading":"3.4 References","text":"","code":""},{"path":"landr-biomass_speciesparameters-module.html","id":"landr-biomass_speciesparameters-module","chapter":"4 LandR Biomass_speciesParameters Module","heading":"4 LandR Biomass_speciesParameters Module","text":"","code":""},{"path":"landr-biomass_speciesparameters-module.html","id":"authors-3","chapter":"4 LandR Biomass_speciesParameters Module","heading":"4.0.0.1 Authors:","text":"Ian Eddy ian.eddy@nrcan-rncan.gc.ca [aut, cre], Eliot McIntire eliot.mcintire@nrcan-rncan.gc.ca [aut], Ceres Barros ceres.barros@ubc.ca [ctb]\ndocumentation work progress. Potential discrepancies omissions\nmay exist time . find , contact us using “Get help”\nlink .","code":""},{"path":"landr-biomass_speciesparameters-module.html","id":"module-overview-3","chapter":"4 LandR Biomass_speciesParameters Module","heading":"4.1 Module Overview","text":"","code":""},{"path":"landr-biomass_speciesparameters-module.html","id":"quick-links-3","chapter":"4 LandR Biomass_speciesParameters Module","heading":"4.1.1 Quick links","text":"General functioningGeneral functioningList input objectsList input objectsList parametersList parametersList outputsList outputsSimulation flow module eventsSimulation flow module events","code":""},{"path":"landr-biomass_speciesparameters-module.html","id":"summary-2","chapter":"4 LandR Biomass_speciesParameters Module","heading":"4.1.2 Summary","text":"LandR Biomass_speciesParameters (hereafter Biomass_speciesParameters)\ncalibrates species growth mortality trait values used Biomass_core, \nmatching theoretical species’ growth curves obtained different trait values\n(see Simulated species data) observed growth\ncurves derived Permanent Sample Plots (PSP data) across Canada (see\nPermanent sample plot data), find combination \ntrait values allows better match observed curves.particular, directly calibrates growthcurve, mortalityshape\ninvariant species traits two new traits inflationFactor \nmANPPproportion, used calibrate previously estimated species\nmaximum biomass (maxB) maximum aboveground net primary productivity\n(maxANPP) values (see Parameter estimation/calibration).module obtain traits parameters used \nBiomass_core must used conjunction another data/calibration\nmodule (e.g., Biomass_borealDataPrep).can however used stand-alone initial developmental phase easier\ninspection statistical calibration procedure employed.November 04, 2022, raw PSP data used module freely\navailable, data sharing agreements must obtained governments \nSK, AB, BC obtain . However, processed anonymized PSP data \nprovided via Google Drive folder accessed automatically module.Google Account therefore necessary access data used \ncalibration.Google Account, access data, please report \nissue clicking “Get help” link .","code":""},{"path":"landr-biomass_speciesparameters-module.html","id":"bsppparam-links-modules","chapter":"4 LandR Biomass_speciesParameters Module","heading":"4.1.3 Links to other modules","text":"Biomass_speciesParameters intended used another data module,\nlike Biomass_borealDataPrep, prepares traits parameters\n(including maxB maxANPP) Biomass_core. See\n\navailable modules LandR ecosystem select Biomass_speciesParameters\ndrop-menu see potential linkages.Biomass_borealDataPrep:\nprepares parameters inputs (including initial landscape conditions)\nBiomass_core needs run realistic simulation. Default\nvalues/inputs produced relevant boreal forests Western Canada.\nUsed upstream Biomass_speciesParameters;Biomass_borealDataPrep:\nprepares parameters inputs (including initial landscape conditions)\nBiomass_core needs run realistic simulation. Default\nvalues/inputs produced relevant boreal forests Western Canada.\nUsed upstream Biomass_speciesParameters;Biomass_core: core\nforest dynamics simulation module. Used downstream \nBiomass_speciesParameters;Biomass_core: core\nforest dynamics simulation module. Used downstream \nBiomass_speciesParameters;","code":""},{"path":"landr-biomass_speciesparameters-module.html","id":"module-manual-3","chapter":"4 LandR Biomass_speciesParameters Module","heading":"4.2 Module manual","text":"","code":""},{"path":"landr-biomass_speciesparameters-module.html","id":"bsppparam-general-functioning","chapter":"4 LandR Biomass_speciesParameters Module","heading":"4.2.1 General functioning","text":"Tree cohort growth mortality Biomass_core essentially determined \nfive parameters: invariant species traits ‘growth curve’ (growthcurve),\n‘mortality shape’, (mortalityshape) longevity, spatio-temporally\nvarying traits maximum biomass (maxB) maximum aboveground net primary\nproductivity (maxANPP).five traits strongly modulate shape species growth curves \nimportant calibrated study area question.Also, growth mortality equations used Biomass_core non-linear\nresulting actual biomass accumulation curve emergent phenomenon\ndue competition effects. means ideal trait/parameter values\nestimated pure single species growth conditions, \nresulting dynamics different multi-species context.Biomass_speciesParameters attempts address issues (\nleast partially) using “curve-matching” approach. compares GAMM fitted \npermanent sample plot (PSP) data large collection theoretical species\ncurves, representing different set growth mortality parameters.\nalso provides means calibrate traits using dataset \nindependent one used derive initial landscape conditions initial\nvalues maxB maxANPP.longevity adjusted using published values (see\nBiomass_borealDataPrep manual), remaining four parameters calibrated\nusing PSP data. Hence, Biomass_speciesParameters generally follows \ndata modules, like Biomass_boreaDataPrep, prepare traits \nlongevity, maxB maxANPP.","code":""},{"path":"landr-biomass_speciesparameters-module.html","id":"bsppparam-PSPdata","chapter":"4 LandR Biomass_speciesParameters Module","heading":"4.2.1.1 Permanent sample plot data","text":"Biomass_speciesParameters can use PSP data available (note may\nspan several thousands kilometres), select data based polygon\n(studyAreaANPP; see List input objects).default PSP data initially obtained National Forest Inventory\n(NFI), Alberta Ministry Agriculture, Saskatchewan Ministry \nEnvironment, British Columbia Ministry Forests, treated errors\nstandardized single data set exact location identifying\nattributes anonymized. share randomized anonymized dataset, data sharing\nagreements must met access raw data.data include individual species, diameter breast height (DBH), \nsometimes tree height measurements tree plot, well stand\nage. part standardization process, dead trees removed \ndataset. Tree biomass estimated tree species, \\(g/m^2\\), using either DBH-model \nDBH-height model either Lambert et al. (2005) Ung et al. (2008) (see P(sim)$biomassModel module parameter\nlist parameters).","code":""},{"path":"landr-biomass_speciesparameters-module.html","id":"bsppparam-simdata","chapter":"4 LandR Biomass_speciesParameters Module","heading":"4.2.1.2 Simulated species data","text":"Biomass_speciesFactorial module used create library \ntheoretical species curves (biomass accumulation curves, precise) \nempirical species curves derived PSP-biomass matched \nspecies trait combination study area. library curves \ncreated running several Biomass_core simulations reproduction, competition,\ndisturbance, dispersal effects, study area. simulation differed \ncombination species trait values influence growth mortality\ndynamics, namely: growthcurve, mortalityshape, longevity, maxANPP \nmaximum biomass (maxBiomass, confused data-driven maxB\nlater calibrated).values maxANPP explored via mANPPproportion, ratio \nmaxANPP maxBiomass (parameter used theroetical curves), \nreflects relationship.growthcurve values varied 0 1, increments 0.1; mortalityshape\nvaried 5 25, increments 1; longevity varied 150 700 \nincrements 25; mANPPproportion varied 0.25 10 increments \n0.25. maxBiomass held constant 5000.resulted 64,000,000 theoretical curves.Results simulations compiled table (cohortDataFactorial\n; see List input objects) accessed \nBiomass_speciesParameters, module can run without needing \nre-simulate theoretical curves.","code":""},{"path":"landr-biomass_speciesparameters-module.html","id":"bsppparam-calib","chapter":"4 LandR Biomass_speciesParameters Module","heading":"4.2.1.3 Parameter estimation/calibration","text":"Biomass_speciesParameters calibrates growthcurve, mortalityshape \nmANPPproportion matching theoretical species curves produced \nBiomass_speciesFactorial (cohortDataFactorial object) observed\nspecies growth curves permanent sample plot (PSP) data.fitting observed species growth curves, module subsets PSP\ndata stand ages 95th percent quantile species (can \nchanged via P(sim)$quantileAgeSubset module parameter), records \nlarger age classes limited constituted statistical outliers. \nspecies, changing quantile value may improve results, however. Two examples\nPinus banksiana Populus sp, using 99th percent\nquantile improved models, short-lived species \ndata advanced ages scarce.module attempts fit models using stands focal species \ndominant (monocultures), balancing sample size (see biomass\nweighting ). Hence, given species, includes plots \nspecies’ relative biomass least 50%. , calibrating Populus\ntremuloides traits, PSP daa plots included 50% stand biomass\ncomposed P. tremuloides.addition, 50 points added origin (age = 0 biomass = 0) \nforce intercept essentially 0 age 0 biomass.Observed growth curves species fit using generalized additive\nmixed models (GAMMs) relate species biomass (\\(B\\)) stand age\n(\\(standAge\\)), accounting random effects measurement year\n(\\(measureYear\\)) plot (\\(plotID\\)) intercept:\\(f_{1}\\) denotes smoother function. avoid overfitting, module\nconstrains smoother stand age maximum smoothing degree 3 (.e. 3\nknots polynomial degree 2) default point constraint 0 attempts \nforce intercept 0. smoother degree constraint, however,\ncan changed via P(sim)$GAMMknots module parameter.","code":""},{"path":"landr-biomass_speciesparameters-module.html","id":"bsppparam-calibbw","chapter":"4 LandR Biomass_speciesParameters Module","heading":"4.2.1.3.1 Biomass-weighting","text":"addition, \\(B\\) weighted respect species dominance. consisted\n1) calculating average biomass dominant species (.e. relative\nbiomass plot > 0.5; \\(domSpeciesB_{1}\\)), plot measurement year,\n2) dividing species average biomass average biomass across \nn dominant species (\\(allDomSpeciesB\\)):added 0 age 0 biomass data module uses weights equal 1.possible selected species enough data allow \nmodel convergence. case, Biomass_speciesParameters skips trait\n(re-)calibration, values remain unchanged.fitting species GAMM, Biomass_speciesParameters compares \ntheoretical curves obtained longevity value matches focal\nspecies’ longevity, picks best one based maximum likelihood. best\ntheoretical curve associated given combination growthcurve,\nmortalityshape mANPPproportion values, used directly \ncalibrated values, case growthcurve mortalityshape, \ncalibrate maxANPP case mANPPproportion (see ).user option constrain values growthcurve \nmortalityshape parameters. default, growthcurve forced 0.5,\nmortalityshape allowed vary 15 25, mANPPproportion\n2.0 5.0 (see module parameters P(sim)$constrainGrowthCurve,\nP(sim)constrainMortalityShape P(sim)constrainMaxANPP). boundary\nvalues based preliminary runs analyses using default data \nmay apply data sets, different spatial subsets default\ndata.boundary values used, Biomass_speciesParameters subsets theoretical\nspecies growth curves trait values within selected boundaries.Since simulated growth curves never achieve maximum biomass parameter (\nmaxBiomass parameter set 5000 simulations theoretical species\ncurves, maxB parameter Biomass_core simulations), acts \nasymptotic limit reflects potential maximum biomass species \necolocation (ecological zone land cover combination).Biomass_speciesParameters uses ratio potential maximum biomass\n(maxBiomass, always 5000) achieved maximum biomass theoretical\ncurves, rescale maxB. ratio called inflationFactor \nmultiplied maxB values previously estimated data (e.g. \nBiomass_borealDataPrep). way, species simulated Biomass_core \nable achieve maximum observed biomasses used initially estimate\nmaxB.Finally, module calibrates maxANPP using mANPPproportion value \nbest matching theoretical growth curve :maxB already (re-)calibrated version. already stated , \nfinal maxANPP value constrained 2.0 5.0 default.cases insufficient PSP data prevent fitting GAMMs performing\ncalibration, mANPPproportion defaults 3.33 (value used LANDIS-II\napplications Canada’s boreal forests) inflationFactor 1.","code":""},{"path":"landr-biomass_speciesparameters-module.html","id":"bsppparam-inputs-list","chapter":"4 LandR Biomass_speciesParameters Module","heading":"4.2.2 List of input objects","text":"full list input objects required module presented (Table\n4.1). input \nmust provided studyAreaANPP (study area used extract PSP\ndata ). input objects internal defaults, user may\nneed request access online files.inputs, following particularly important deserve special\nattention:Spatial layersstudyAreaANPP – shapefile. SpatialPolygonsDataFrame single\npolygon determining PSP subset simulation \ntake place. input object must supplied user another module.TablesfactorialSpeciesTable reducedFactorialCohortData – tables \nspecies trait combinations theoretical species grwoth curve data\n(respectively).PSPmeasure, PSPplot PSPgis – tree measurement, biomass growth \ngeographical data PSP datasets used build observed species growth\ncurves.species – table invariant species traits may produced\nanother module. must contain columns ‘species’, ‘growthcurve’\n‘mortality shape’, whose values calibrated.speciesEcoregion – table spatially-varying species traits may\nproduced another module. must contain columns\n‘speciesCode’, ‘maxB’ ‘maxANPP’ ‘ecoregionGroup’ (ecolocation\nID). ‘maxB’ ‘maxANPP’ values (re-)calibrated species.\nTable 4.1: List Biomass_speciesParameters input objects description.\n","code":""},{"path":"landr-biomass_speciesparameters-module.html","id":"bsppparam-params-list","chapter":"4 LandR Biomass_speciesParameters Module","heading":"4.2.3 List of parameters","text":"full list parameters used module presented (Table\n4.2), default\nvalues specified module’s metadata.parameters, following particularly important:Calibration parametersGAMMiterations GAMMknots – control number iterations \nsmoother degree used fit GAMMs, respectively.GAMMiterations GAMMknots – control number iterations \nsmoother degree used fit GAMMs, respectively.constrainGrowthCurve, constrainMortalityShape constrainMaxANPP –\ndetermine upper lower boundaries calibrated values \ngrowthcurve, mortalityshape maxANPP, respectively.constrainGrowthCurve, constrainMortalityShape constrainMaxANPP –\ndetermine upper lower boundaries calibrated values \ngrowthcurve, mortalityshape maxANPP, respectively.Data processingminimumPlotsPerGamm – define minimum number PSP plots needed fit\nGAMMs.minimumPlotsPerGamm – define minimum number PSP plots needed fit\nGAMMs.PSPperiod – PSP data period use.PSPperiod – PSP data period use.quantileAgeSubset – upper quantile age value used subset PSP data.quantileAgeSubset – upper quantile age value used subset PSP data.\nTable 4.2: List Biomass_speciesParameters parameters description.\n","code":""},{"path":"landr-biomass_speciesparameters-module.html","id":"bsppparam-outputs-list","chapter":"4 LandR Biomass_speciesParameters Module","heading":"4.2.4 List of outputs","text":"module produces following outputs (Table\n4.3). Note species \nspeciesEcoregion modified versions inputed objects \nname.Tablesspecies speciesEcoregion – tables calibrated trait values.species speciesEcoregion – tables calibrated trait values.speciesGAMMs – fitted GAMM model objects species.speciesGAMMs – fitted GAMM model objects species.\nTable 4.3: List Biomass_speciesParameters output objects description.\n","code":""},{"path":"landr-biomass_speciesparameters-module.html","id":"bsppparam-sim-flow","chapter":"4 LandR Biomass_speciesParameters Module","heading":"4.2.5 Simulation flow and module events","text":"Biomass_speciesParameters initialies prepares inputs provided\nactive internet connection user access data (\nGoogle Account ).advise future users run Biomass_speciesParameters defaults \ninspect objects like supplying data. user \nneed run Biomass_speciesFactorial generate theoretical\ncurves (unless wish ), module accesses pre-generated -line\nlibrary simulated data.Note module runs (one “time step”) executes one\nevent (init). general flow Biomass_speciesParameters processes :Preparation necessary data input objects require\nparameter fitting (e.g., theoretical species growth curve data);Preparation necessary data input objects require\nparameter fitting (e.g., theoretical species growth curve data);Sub-setting PSP data calculating observed species growth curves\nusing GAMMs;Sub-setting PSP data calculating observed species growth curves\nusing GAMMs;Finding theoretical species growth curve best matches observed\ncurve, species. Theoretical curves subset longevity\nmatching species’ longevity (species table) \ngrowthcurve mortalityshape values within chosen boundaries\n(P(sim)$constrainGrowthCurve, P(sim)$constrainMortalityShape);Finding theoretical species growth curve best matches observed\ncurve, species. Theoretical curves subset longevity\nmatching species’ longevity (species table) \ngrowthcurve mortalityshape values within chosen boundaries\n(P(sim)$constrainGrowthCurve, P(sim)$constrainMortalityShape);Calibrating maxB maxANPPCalibrating maxB maxANPPAdjusting maxANPP match chosen boundaries\n(P(sim)$constrainMaxANPP)Adjusting maxANPP match chosen boundaries\n(P(sim)$constrainMaxANPP)","code":""},{"path":"landr-biomass_speciesparameters-module.html","id":"bsppparam-example","chapter":"4 LandR Biomass_speciesParameters Module","heading":"4.3 Usage example","text":"module can run stand-alone, won’t much calibrate\nspecies trait values based dummy input trait values. provide example \n, since may value run module become\nacquainted calibration process explore fitted GAMMs. However,\nremind run example need Google Account, access \ndata may need granted.realistic usage example module others can found \nrepository \nBarros et al. (review).","code":""},{"path":"landr-biomass_speciesparameters-module.html","id":"load-spades-and-other-packages.-1","chapter":"4 LandR Biomass_speciesParameters Module","heading":"4.3.1 Load SpaDES and other packages.","text":"","code":""},{"path":"landr-biomass_speciesparameters-module.html","id":"bsppparam-example-libs","chapter":"4 LandR Biomass_speciesParameters Module","heading":"4.3.2 Set up R libraries","text":"","code":"\noptions(repos = c(CRAN = \"https://cloud.r-project.org\"))\ntempDir <- tempdir()\n\npkgPath <- file.path(tempDir, \"packages\", version$platform, paste0(version$major,\n    \".\", strsplit(version$minor, \"[.]\")[[1]][1]))\ndir.create(pkgPath, recursive = TRUE)\n.libPaths(pkgPath, include.site = FALSE)\n\nif (!require(Require, lib.loc = pkgPath)) {\n    remotes::install_github(paste0(\"PredictiveEcology/\", \"Require@5c44205bf407f613f53546be652a438ef1248147\"),\n        upgrade = FALSE, force = TRUE)\n    library(Require, lib.loc = pkgPath)\n}\n\nsetLinuxBinaryRepo()"},{"path":"landr-biomass_speciesparameters-module.html","id":"bsppparam-example-pkg-mods","chapter":"4 LandR Biomass_speciesParameters Module","heading":"4.3.3 Get the module and module dependencies","text":"","code":"\nRequire(pasteo(\"PredictiveEcology/\", \"SpaDES.project@6d7de6ee12fc967c7c60de44f1aa3b04e6eeb5db\"),\n    require = FALSE, upgrade = FALSE, standAlone = TRUE)\n\npaths <- list(inputPath = normPath(file.path(tempDir, \"inputs\")),\n    cachePath = normPath(file.path(tempDir, \"cache\")), modulePath = normPath(file.path(tempDir,\n        \"modules\")), outputPath = normPath(file.path(tempDir,\n        \"outputs\")))\n\nSpaDES.project::getModule(modulePath = paths$modulePath, c(\"PredictiveEcology/Biomass_speciesParameters@master\"),\n    overwrite = TRUE)\n\n## make sure all necessary packages are installed:\nouts <- SpaDES.project::packagesInModules(modulePath = paths$modulePath)\nRequire(c(unname(unlist(outs)), \"SpaDES\"), require = FALSE, standAlone = TRUE)\n\n## load necessary packages\nRequire(c(\"SpaDES\"), upgrade = FALSE, install = FALSE)"},{"path":"landr-biomass_speciesparameters-module.html","id":"setup-simulation-1","chapter":"4 LandR Biomass_speciesParameters Module","heading":"4.3.4 Setup simulation","text":"","code":"\ntimes <- list(start = 0, end = 1)\n\nmodules <- list(\"Biomass_speciesParameters\")\n\n# the purpose of this table is experiment with modify longevity -\n# longevity is not estimated by the module but it is used in trait\n# estimation.\ninputSpecies <- data.table(species = c(\"Abie_bal\", \"Abie_las\", \"Betu_pap\",\n    \"Lari_lar\", \"Pice_eng\", \"Pice_gla\", \"Pice_mar\", \"Pinu_ban\", \"Pinu_con\",\n    \"Pseu_men\", \"Popu_tre\"), longevity = c(300, 300, 170, 170, 330, 250,\n    250, 175, 300, 600, 200), mortalityshape = 15, growthcurve = 0)\nobjects <- list(species = inputSpecies)\n\ninputs <- list()\noutputs <- list()\n\nparameters <- list(Biomass_speciesParameters = list(GAMMiterations = 2,\n    GAMMknots = list(Abie_bal = 3, Abie_las = 3, Betu_pap = 3, Lari_lar = 4,\n        Pice_eng = 4, Pice_gla = 3, Pice_mar = 4, Pinu_ban = 3, Pinu_con = 4,\n        Popu_tre = 4, Pseu_men = 3), minimumPlotsPerGamm = 40, constrainMortalityShape = list(Abie_bal = c(15,\n        25), Abie_las = c(15, 25), Betu_pap = c(15, 20), Lari_lar = c(20,\n        25), Pice_eng = c(20, 25), Pice_gla = c(20, 25), Pice_mar = c(15,\n        25), Pinu_ban = c(15, 25), Pinu_con = c(15, 25), Popu_tre = c(20,\n        25), Pseu_men = c(20, 25)), constrainGrowthCurve = list(Abie_bal = c(0,\n        1), Abie_las = c(0, 1), Betu_pap = c(0, 1), Lari_lar = c(0, 1),\n        Pice_eng = c(0, 1), Pice_gla = c(0, 1), Pice_mar = c(0, 1), Pinu_ban = c(0,\n            1), Pinu_con = c(0, 1), Popu_tre = c(0, 1), Pseu_men = c(0,\n            1)), quantileAgeSubset = list(Abie_bal = 95, Abie_las = 95,\n        Betu_pap = 95, Lari_lar = 95, Pice_eng = 95, Pice_gla = 95, Pice_mar = 95,\n        Pinu_ban = 95, Pinu_con = 99, Popu_tre = 99, Pseu_men = 99)))\n\n\nmySim <- simInitAndSpades(times = times, params = parameters, modules = modules,\n    paths = paths, objects = objects)\n\n## to inspect the fitted GAMM models:\nmySim$speciesGAMMs$Pice_mar"},{"path":"landr-biomass_speciesparameters-module.html","id":"bsppparam-refs","chapter":"4 LandR Biomass_speciesParameters Module","heading":"4.4 References","text":"","code":""},{"path":"landr-validation-modules.html","id":"landr-validation-modules","chapter":"LandR Validation Modules","heading":"LandR Validation Modules","text":"LandR ‘validation modules’ differ ‘data modules’ objective obtain input data estimate parameters run simulation, rather confront simulation outputs observed data – even modules can potentially obtain pre-process validation data.\nmoment, one validation module available, Biomass_validationKNN, expect increment number validation modules LandR usage expands.","code":""},{"path":"landr-biomass_validationknn-module.html","id":"landr-biomass_validationknn-module","chapter":"5 LandR Biomass_validationKNN Module","heading":"5 LandR Biomass_validationKNN Module","text":"","code":""},{"path":"landr-biomass_validationknn-module.html","id":"authors-4","chapter":"5 LandR Biomass_validationKNN Module","heading":"5.0.0.1 Authors:","text":"Ceres Barros ceres.barros@ubc.ca [aut, cre], Eliot McIntire eliot.mcintire@nrcan-rncan.gc.ca [aut]\ndocumentation work progress. Potential discrepancies omissions\nmay exist time . find , contact us using “Get help”\nlink .","code":""},{"path":"landr-biomass_validationknn-module.html","id":"module-overview-4","chapter":"5 LandR Biomass_validationKNN Module","heading":"5.1 Module Overview","text":"","code":""},{"path":"landr-biomass_validationknn-module.html","id":"quick-links-4","chapter":"5 LandR Biomass_validationKNN Module","heading":"5.1.1 Quick links","text":"General functioningGeneral functioningList input objectsList input objectsList parametersList parametersList outputsList outputsSimulation flow module eventsSimulation flow module events","code":""},{"path":"landr-biomass_validationknn-module.html","id":"summary-3","chapter":"5 LandR Biomass_validationKNN Module","heading":"5.1.2 Summary","text":"LandR Biomass_validationKNN (hereafter Biomass_validationKNN) provides \napproach validate outputs LandR Biomass (.e., Biomass_core linked\nmodules ) simulations, using publicly available data \nCanadian forests. produces visual statistical validation \nBiomass_core outputs related species abundance presence/absence \nlandscape. , downloads prepares necessary data (observed \nsimulated), calculates validation statistics produces/saves validation\nplots.","code":""},{"path":"landr-biomass_validationknn-module.html","id":"bvalid-links-modules","chapter":"5 LandR Biomass_validationKNN Module","heading":"5.1.3 Links to other modules","text":"Biomass_validationKNN intended used Biomass_core \nmodules link affect cohort biomass (e.g., disturbance modules \ncalibration modules may affect resulting biomass). See\n\navailable modules LandR ecosystem select Biomass_validationKNN \ndrop-menu see potential linkages. default, disturbed pixels \nexcluded validation, user can bypass option. \nfollowing list modules commonly validated \nBiomass_validationKNN.Biomass_core: core\nforest dynamics simulation module. Used downstream \nBiomass_borealDataPrep;Data calibration modules:Biomass_speciesData:\ngrabs merges several sources species cover data, making species\npercent cover (% cover) layers used LandR Biomass\nmodules. Default source data spans entire Canadian territory;Biomass_speciesData:\ngrabs merges several sources species cover data, making species\npercent cover (% cover) layers used LandR Biomass\nmodules. Default source data spans entire Canadian territory;Biomass_borealDataPrep:\nprepares parameters inputs (including initial landscape conditions)\nBiomass_core needs run realistic simulation. Default\nvalues/inputs produced relevant boreal forests Western Canada;Biomass_borealDataPrep:\nprepares parameters inputs (including initial landscape conditions)\nBiomass_core needs run realistic simulation. Default\nvalues/inputs produced relevant boreal forests Western Canada;Biomass_speciesParameters:\ncalibrates four-species level traits using permanent sample plot data (.e.,\nrepeated tree biomass measurements) across Western Canada.Biomass_speciesParameters:\ncalibrates four-species level traits using permanent sample plot data (.e.,\nrepeated tree biomass measurements) across Western Canada.Disturbance-related modules:Biomass_regeneration:\nsimulates cohort biomass responses stand-replacing fires (LANDIS-II\nBiomass Succession Extension v.3.2.1),\nincluding cohort mortality regeneration resprouting /\nserotiny;Biomass_regeneration:\nsimulates cohort biomass responses stand-replacing fires (LANDIS-II\nBiomass Succession Extension v.3.2.1),\nincluding cohort mortality regeneration resprouting /\nserotiny;Biomass_regenerationPM:\nlike Biomass_regeneration, allowing partial mortality. Based \nLANDIS-II Dynamic Fuels & Fire System extension (Sturtevant et al. 2018);Biomass_regenerationPM:\nlike Biomass_regeneration, allowing partial mortality. Based \nLANDIS-II Dynamic Fuels & Fire System extension (Sturtevant et al. 2018);fireSense: climate- land-cover-sensitive fire model simulating fire\nignition, escape spread processes function climate \nland-cover. Includes built-parameterisation processes using\nclimate, land-cover, fire occurrence fire perimeter data. Requires using\nBiomass_regeneration Biomass_regenerationPM. See modules prefixed\n“fireSense_” https://github.com/PredictiveEcology/;fireSense: climate- land-cover-sensitive fire model simulating fire\nignition, escape spread processes function climate \nland-cover. Includes built-parameterisation processes using\nclimate, land-cover, fire occurrence fire perimeter data. Requires using\nBiomass_regeneration Biomass_regenerationPM. See modules prefixed\n“fireSense_” https://github.com/PredictiveEcology/;LandMine: wildfire\nignition cover-sensitive wildfire spread model based fire return\ninterval input. Requires using Biomass_regeneration \nBiomass_regenerationPM;LandMine: wildfire\nignition cover-sensitive wildfire spread model based fire return\ninterval input. Requires using Biomass_regeneration \nBiomass_regenerationPM;scfm: spatially explicit fire\nspread module parameterised modelled stochastic three-part process\nignition, escape, spread. Requires using Biomass_regeneration \nBiomass_regenerationPM.scfm: spatially explicit fire\nspread module parameterised modelled stochastic three-part process\nignition, escape, spread. Requires using Biomass_regeneration \nBiomass_regenerationPM.","code":""},{"path":"landr-biomass_validationknn-module.html","id":"module-manual-4","chapter":"5 LandR Biomass_validationKNN Module","heading":"5.2 Module manual","text":"","code":""},{"path":"landr-biomass_validationknn-module.html","id":"bvalid-general-functioning","chapter":"5 LandR Biomass_validationKNN Module","heading":"5.2.1 General functioning","text":"Biomass_validationKNN compares simulated outputs two years (across\nreplicates), corresponding years observed data. designed \ncompare observed data years 2001 (start point simulation) \n2011 (.e., 10 years simulation) kNN forest layers \nCanadian National Forest Inventory – currently available\nFAIR datasets (sensu Stall et al. 2019) stand biomass species\n% cover changes across Canada. However, user can supply \nsources observed data, long identical format.validation done visually (using barplots boxplots) using two\nstatistics: mean absolute deviation simulated biomass (per species) \nsum negative log-likelihoods (SNLL) predictions respect observed\ndata species biomass, species presences/absences changes biomass\n(\\(\\Delta\\)B) – later still development.module assumes simulation data preparation carried \nBiomass_borealDataPrep, , ensure comparison \nsimulated datasets built assumptions, data treatment steps\nBiomass_borealDataPrep repeated .module may also exclude disturbed pixels identified rstLCCChange raster\nlayer fire perimeter data (firePerimeters layer). \nintended, user can provide rstLCCChange NA’s /empty\nfirePerimeters sf object.Biomass_validationKNN compares simulated species biomass, presences,\ndominance, changes biomass observed data available \nstarting conditions (2011 default) second time point (e.g. 2011, \n10 years simulation). , year replicate, \nsimulated observed data, module calculates:species relative abundances pixel- landscape-level (across \npixels);species relative abundances pixel- landscape-level (across \npixels);species presences dominance landscape level;species presences dominance landscape level;changes species biomass (\\(\\Delta\\)B) pixel- landscape-level \nsimulated observed data. Biomass units respect used \nBiomass_core (\\(g/m^2\\)).changes species biomass (\\(\\Delta\\)B) pixel- landscape-level \nsimulated observed data. Biomass units respect used \nBiomass_core (\\(g/m^2\\)).Pixel-level relative abundances calculated species biomass (summed\nacross cohorts) divided total pixel biomass (summed across cohorts \nspecies), landscape-wide relative abundances calculated sum \nspecies biomass across pixels divided sum total biomass across\npixels.Species presences calculated number pixels given species\npresent, species dominance calculated number pixels \nspecies highest relative biomass given pixel. Pixels two \nspecies share highest biomass value classified ‘mixed forest’,\npixels without biomass classified ‘veg.’.Finally, \\(\\Delta\\)B calculated per species final biomass (e.g., year\n2011) minus initial biomass (e.g., year 2001), either pixel- \nlandscape-level.","code":""},{"path":"landr-biomass_validationknn-module.html","id":"bvalid-valid","chapter":"5 LandR Biomass_validationKNN Module","heading":"5.2.2 Validation approaches","text":"","code":""},{"path":"landr-biomass_validationknn-module.html","id":"bvalid-valid-visual","chapter":"5 LandR Biomass_validationKNN Module","heading":"5.2.2.1 Visual validation","text":"module plots metrics barplots showing landscape-level values\n(averaged across replicates simulated data) boxplots showing\npixel-level values. Plotting can live /form exported images\n(turned completely).","code":""},{"path":"landr-biomass_validationknn-module.html","id":"bvalid-valid-MAD","chapter":"5 LandR Biomass_validationKNN Module","heading":"5.2.2.2 Mean absolute deviation","text":"Mean absolute deviance (MAD) values calculated landscape- pixel-level\nspecies relative abundances \\(\\Delta\\)B, landscape-level species presences\ndominance. MAD values calculated per replicate year, except \\(\\Delta\\)B\nMAD values, integrate across years. Output tables MAD values exported landscapeMAD \npixelMAD, module also produces visual inspection values \ndot--whisker plots.","code":""},{"path":"landr-biomass_validationknn-module.html","id":"bvalid-valid-SNLL","chapter":"5 LandR Biomass_validationKNN Module","heading":"5.2.2.3 Sum of negative log-likelihood (SNLL)","text":"provide measure overall goodness fit model set-\ngave rise outputs, set starting conditions, parameters \nsimulation mechanisms generated predictions (includes LandR\nmodules used), Biomass_validationKNN estimates sum negative log-likelihoods\n(SNLL) species presences (landscape-level), simulated species biomasses,\n\\(\\Delta\\)B (latter two landscape pixel levels),\nrespect observed counterparts.precisely, let \\(\\ell\\) log-likelihood function denoting \nprobability observing \\(x\\) \\(X\\) (random variable following continuous\nprobability distribution \\(f(x)\\)), given parameter \\(\\theta\\):case, \\(\\theta\\) equivalent model’s starting conditions \nstructure, \\(X\\) observed data \\(x\\) simulated values, \n\\(f(x)\\) continuous probability distribution \\(X\\). variable \nwanted evaluate simulation replicate, Equation (5.1)\napplied calculate SNLL estimated value \\(x\\) pixel \nlandscape-level, \\(\\):\\(N\\) equal total number pixels. landscape scale \\(N = 1\\).species presences species biomass, draw probability observing\n\\(x_{}\\) (vector species presences/biomasses pixel/landscape \\(\\)) \nmultinomial density distribution\n(\\(f(x_{}) = {\\sf Multi}(n_{}, \\mathrm{p}_{})\\)), \n\\(n_{} = \\sum_{j = 1}^{K} X_{,j}\\) (\\(X\\) observed values biomass \n\\(j = 1, ..., K\\) species pixel/landscape \\(\\)) \\(\\mathrm{p_{}}\\) \nvector simulated values \\(x_{,j}\\).computation SNLL \\(\\Delta\\)B still development. \nfollowing approach currently implemented, presents issues:\\(\\Delta\\)B, draw probability observing \\(x_{,j}\\) (simulated\n\\(\\Delta\\)B \\(j = 1, ..., K\\) species pixel/landscape \\(\\)) \nmultivariate Gaussian distribution,\n\\(f(x_{}) = \\mathcal {N}(\\mu_{}, \\mathrm{M}_{})\\), \\(\\mu_{}\\) \nvector observed mean \\(\\Delta\\)B species \\(j = 1, ..., K\\), \n\\(\\mathrm{M}\\) observed \\(K * K\\) variance-covariance matrix species\n\\(\\Delta\\)B. Unfortunately presenting problems, due \\(\\mathrm{M}\\) \nstrictly positive definite.calculating SNLL across pixels (entire landscape), values \naveraged across replicates overall model estimate exported \nlogLikelihood table.refer Wikipedia pages multinomial\ndistribution \nmultivariate Gaussian\ndistribution\ngood summary two distributions use SNLL estimation.","code":""},{"path":"landr-biomass_validationknn-module.html","id":"bvalid-inputs-list","chapter":"5 LandR Biomass_validationKNN Module","heading":"5.2.3 List of input objects","text":"full list input objects Biomass_validationKNN requires presented\n(Table 5.1). defaults\nexcept studyArea, must provided user, another module., input spatial layers land-cover change (change type year),\nfire perimeters, % species cover, stand age stand biomass \nobtained National Forest Inventory kNN layers years 2001 2011.strongly recommend “starting point layers” (suffixed \n*Start, default correspond 2001) user supplies \nobjects used starting input layers initialise simulation make\nsure match.Note objects suffixed *Start correspond objects \nmain simulation without suffix (e.g. rawBiomassMapStart \nrawBiomassMap Biomass_borealDataPrep), whereas objects like\nstudyArea rasterToMatch names simulation \nexactly object.inputs Table 5.1, \nfollowing deserve special attention:Spatial layersbiomassMap – map simulated stand biomass (\\(g/m^2\\) ) filtered \npixels cohort dynamics simulated. corresponds \nsim$biomassMap object produced Biomass_borealDataPrep \nsim$simulatedBiomassMap produced Biomass_core.biomassMap – map simulated stand biomass (\\(g/m^2\\) ) filtered \npixels cohort dynamics simulated. corresponds \nsim$biomassMap object produced Biomass_borealDataPrep \nsim$simulatedBiomassMap produced Biomass_core.firePerimeters – fire perimeters polygon map used \nexclude recently burned pixels analysis. desired \nuser needs provide empty sf object (e.g., sf::st_polygon()) .firePerimeters – fire perimeters polygon map used \nexclude recently burned pixels analysis. desired \nuser needs provide empty sf object (e.g., sf::st_polygon()) .rawBiomassMapStart – raw biomass data used initialise parametrise\nBiomass_core. default, module uses stand biomass map kNN\nyear 2001. user must make sure appropriate use\ncase, else supply correct raster layer.rawBiomassMapStart – raw biomass data used initialise parametrise\nBiomass_core. default, module uses stand biomass map kNN\nyear 2001. user must make sure appropriate use\ncase, else supply correct raster layer.rawBiomassMapEnd – raw biomass data used validate model \nseveral simulation years. default, module uses kNN stand biomass map\n2011, compared 10th year simulation initialised\nusing kNN 2001 data. user must make sure \nappropriate use case, else supply correct raster layer.rawBiomassMapEnd – raw biomass data used validate model \nseveral simulation years. default, module uses kNN stand biomass map\n2011, compared 10th year simulation initialised\nusing kNN 2001 data. user must make sure \nappropriate use case, else supply correct raster layer.rstLCChange – binary raster layer disturbed pixels \nremoved analyses. Can combined rstLCChangeYr filter\npixels disturbed given time period defined P(sim)$LCChangeYr.\nDefaults Canada’s forest change national map 1985-2011\n(CFS).rstLCChange – binary raster layer disturbed pixels \nremoved analyses. Can combined rstLCChangeYr filter\npixels disturbed given time period defined P(sim)$LCChangeYr.\nDefaults Canada’s forest change national map 1985-2011\n(CFS).rstLCChangeYr – raster layer year disturbance. \noptional layer can combined rstLCChange \nP(sim)$LCChangeYr filter disturbed pixels year disturbance. \nused default. Defaults Canada’s forest change year national map\n1985-2011\n(CFS).rstLCChangeYr – raster layer year disturbance. \noptional layer can combined rstLCChange \nP(sim)$LCChangeYr filter disturbed pixels year disturbance. \nused default. Defaults Canada’s forest change year national map\n1985-2011\n(CFS).speciesLayersStart – rawBiomassMapStart, respect \nspecies % cover data.speciesLayersStart – rawBiomassMapStart, respect \nspecies % cover data.speciesLayersEnd – rawBiomassMapEnd, respect \nspecies % cover data.speciesLayersEnd – rawBiomassMapEnd, respect \nspecies % cover data.studyArea – shapefile. SpatialPolygonsDataFrame single polygon\ndetermining simulation take place. input\nobject must supplied user.studyArea – shapefile. SpatialPolygonsDataFrame single polygon\ndetermining simulation take place. input\nobject must supplied user.Simulation-related objectsallCohortData – OPTIONAL. data.table containing cohortData\nobjects relevant validation (e.g., many cohortData objects \nsimulation replicates times 2, beginning end year). \nsupplied, Biomass_validationKNN attempts produce object using \ncohortData object file listed simulationOutputs . Hence, user\nmust either supply allCohortData pixelGroupMapStk \nsimulationOutputs.allCohortData – OPTIONAL. data.table containing cohortData\nobjects relevant validation (e.g., many cohortData objects \nsimulation replicates times 2, beginning end year). \nsupplied, Biomass_validationKNN attempts produce object using \ncohortData object file listed simulationOutputs . Hence, user\nmust either supply allCohortData pixelGroupMapStk \nsimulationOutputs.pixelGroupMapStk – OPTIONAL. allCohortData, respect \npixelGroupMap objects.pixelGroupMapStk – OPTIONAL. allCohortData, respect \npixelGroupMap objects.simulationOutputs – OPTIONAL. data.frame structure\ndata.frame’s specifying outputs saved \nspades(..., outputs = data.frame(...)). advise passing \ndata.frame supplied spades simulation call, \nfiltered relevant cohortData pixelGroupMap objects ,\npotentially, file paths corrected match current working\ndirectory (see Usage example). used \nallCohortData pixelGroupMapStk supplied.simulationOutputs – OPTIONAL. data.frame structure\ndata.frame’s specifying outputs saved \nspades(..., outputs = data.frame(...)). advise passing \ndata.frame supplied spades simulation call, \nfiltered relevant cohortData pixelGroupMap objects ,\npotentially, file paths corrected match current working\ndirectory (see Usage example). used \nallCohortData pixelGroupMapStk supplied.pixelGroupMap – raster layer pixelGroup IDs per pixel. Pixels\ngrouped based identical ecoregionGroup, speciesCode, age\nB composition, even user supplies initial groupings\n(e.g., possible Biomass_borealDataPrep data module).pixelGroupMap – raster layer pixelGroup IDs per pixel. Pixels\ngrouped based identical ecoregionGroup, speciesCode, age\nB composition, even user supplies initial groupings\n(e.g., possible Biomass_borealDataPrep data module).\nTable 5.1: List Biomass_validationKNN input objects description.\n","code":""},{"path":"landr-biomass_validationknn-module.html","id":"bvalid-params-list","chapter":"5 LandR Biomass_validationKNN Module","heading":"5.2.4 List of parameters","text":"Table 5.2 lists parameters used\nBiomass_validationKNN detailed information. default\nvalues specified module’s metadataOf parameters listed Table\n5.2, following particularly\nimportant:LCChangeYr – integer. Optional parameter defining years \ndisturbance filtered analysis using \nrstLCChangeYr layer. parameter set NULL default, meaning\nrstLCChangeYr used.LCChangeYr – integer. Optional parameter defining years \ndisturbance filtered analysis using \nrstLCChangeYr layer. parameter set NULL default, meaning\nrstLCChangeYr used.sppEquivCol – character. column name speciesEquivalency\ndata.table defines naming convention use throughout \nsimulation.sppEquivCol – character. column name speciesEquivalency\ndata.table defines naming convention use throughout \nsimulation.validationReps – integer. simulation replicates used \nvalidation.validationReps – integer. simulation replicates used \nvalidation.validationYears – integer. simulation years used \nvalidation - year number needs match observed data year. \ninstance, first observed data year 2001, must first\nsimulation year.validationYears – integer. simulation years used \nvalidation - year number needs match observed data year. \ninstance, first observed data year 2001, must first\nsimulation year.\nTable 5.2: List Biomass_validationKNN parameters description.\n","code":""},{"path":"landr-biomass_validationknn-module.html","id":"bvalid-outputs-list","chapter":"5 LandR Biomass_validationKNN Module","heading":"5.2.5 List of outputs","text":"module produces following outputs (Table\n5.3):\nTable 5.3: List Biomass_validationKNN output objects description.\n","code":""},{"path":"landr-biomass_validationknn-module.html","id":"bvalid-sim-flow","chapter":"5 LandR Biomass_validationKNN Module","heading":"5.2.6 Simulation flow and module events","text":"Biomass_validationKNN initialises prepares inputs provided \naccess outputs simulations Biomass_core, internet access\nretrieve observed kNN datasets used \nvalidation9.module compiles simulation output data provided user\nsupplies object names file paths via simulationOutputs input\nobject. Alternatively, user may pass pre-compiled outputs (namely \ncohortData pixelGroupMap objects) via allCohortData \npixelGroupMapStk input objects. See list input\nobjects detail.Future users run Biomass_validationKNN defaults inspect \nobjects like supplying data, alternative data URLs.\nAlternatively, users may develop validation modules using\nBiomass_validationKNN template. expect number validation\nmodules increase validation approaches developed based \nproject needs.general flow Biomass_validationKNN processes (note module\nruns , .e. one “time step”):Preparation necessary objects, namely obtaining observed data\nlayers -line repositories (available stored local copies) \ncompiling simulated data user done previously (see\nlist input objects) – (init event).Preparation necessary objects, namely obtaining observed data\nlayers -line repositories (available stored local copies) \ncompiling simulated data user done previously (see\nlist input objects) – (init event).Calculation summary variables validation (calculateValidVars\nevent), namely :\nrelative biomass per species per pixel across landscape (per year\nper replicate)\nchanges species biomass per pixel across landscape (per\nreplicate), respect first year.\nspecies dominance across landscape\nspecies presences across landscape\nCalculation summary variables validation (calculateValidVars\nevent), namely :relative biomass per species per pixel across landscape (per year\nper replicate)relative biomass per species per pixel across landscape (per year\nper replicate)changes species biomass per pixel across landscape (per\nreplicate), respect first year.changes species biomass per pixel across landscape (per\nreplicate), respect first year.species dominance across landscapespecies dominance across landscapespecies presences across landscapespecies presences across landscapeCalculation validation statistics (validationStats event), namely mean\nabsolute deviations (MAD) sum negative log-likelihoods (SNLL).Calculation validation statistics (validationStats event), namely mean\nabsolute deviations (MAD) sum negative log-likelihoods (SNLL).Assessment relationship observed \\(\\Delta\\)B observed\n\\(\\Delta\\)Age (obsDeltaMaps event) – optional visual diagnostic\nobserved data produces scatterplots \\(\\Delta\\)B ~ \\(\\Delta\\)Age\nthree types:\nraw observed values \\(\\Delta\\)B \\(\\Delta\\)Age\n\\(\\Delta\\)B \\(\\Delta\\)Age calculated observed data \npre-processing (.e., data clean-steps done Biomass_borealDataPrep,\nalso done observed data validation)\ndata shown 2) , filtered pixels \nstand age increment corresponding number years \ntwo validation time points. necessarily correct filter, \nstands may suffered age reduction due loss old cohorts\nbackground mortality (.e., coming disturbances. However, \nusing default input datasets, unlikely widespread\nphenomenon 10 years. remind user disturbed pixels \nremoved analyses validating succession dynamics \nabsence disturbance - default option.\nAssessment relationship observed \\(\\Delta\\)B observed\n\\(\\Delta\\)Age (obsDeltaMaps event) – optional visual diagnostic\nobserved data produces scatterplots \\(\\Delta\\)B ~ \\(\\Delta\\)Age\nthree types:raw observed values \\(\\Delta\\)B \\(\\Delta\\)AgeWith raw observed values \\(\\Delta\\)B \\(\\Delta\\)AgeWith \\(\\Delta\\)B \\(\\Delta\\)Age calculated observed data \npre-processing (.e., data clean-steps done Biomass_borealDataPrep,\nalso done observed data validation)\\(\\Delta\\)B \\(\\Delta\\)Age calculated observed data \npre-processing (.e., data clean-steps done Biomass_borealDataPrep,\nalso done observed data validation)data shown 2) , filtered pixels \nstand age increment corresponding number years \ntwo validation time points. necessarily correct filter, \nstands may suffered age reduction due loss old cohorts\nbackground mortality (.e., coming disturbances. However, \nusing default input datasets, unlikely widespread\nphenomenon 10 years. remind user disturbed pixels \nremoved analyses validating succession dynamics \nabsence disturbance - default option.data shown 2) , filtered pixels \nstand age increment corresponding number years \ntwo validation time points. necessarily correct filter, \nstands may suffered age reduction due loss old cohorts\nbackground mortality (.e., coming disturbances. However, \nusing default input datasets, unlikely widespread\nphenomenon 10 years. remind user disturbed pixels \nremoved analyses validating succession dynamics \nabsence disturbance - default option.Plots (landscapeWidePlots, pixelLevelPlots deltaBComparisons\nevents):\nBarplots landscape-wide pixel-level comparisons observed \nsimulated data, respect relative biomass, dominance presences.\nBoxplots biomass changes (\\(\\Delta\\)B) observed simulated data, \nrespect first year.\nMaps biomass age changes (\\(\\Delta\\)B, \\(\\Delta\\)Age) respect \nfirst year, observed simulated data.\nPlots (landscapeWidePlots, pixelLevelPlots deltaBComparisons\nevents):Barplots landscape-wide pixel-level comparisons observed \nsimulated data, respect relative biomass, dominance presences.Barplots landscape-wide pixel-level comparisons observed \nsimulated data, respect relative biomass, dominance presences.Boxplots biomass changes (\\(\\Delta\\)B) observed simulated data, \nrespect first year.Boxplots biomass changes (\\(\\Delta\\)B) observed simulated data, \nrespect first year.Maps biomass age changes (\\(\\Delta\\)B, \\(\\Delta\\)Age) respect \nfirst year, observed simulated data.Maps biomass age changes (\\(\\Delta\\)B, \\(\\Delta\\)Age) respect \nfirst year, observed simulated data.module default outputs form plots, user can chose \nsave objects (see Table 5.3).","code":""},{"path":"landr-biomass_validationknn-module.html","id":"bvalid-example","chapter":"5 LandR Biomass_validationKNN Module","heading":"5.3 Usage example","text":"","code":""},{"path":"landr-biomass_validationknn-module.html","id":"bvalid-example-libs","chapter":"5 LandR Biomass_validationKNN Module","heading":"5.3.1 Set up R libraries","text":"","code":"\noptions(repos = c(CRAN = \"https://cloud.r-project.org\"))\ntempDir <- tempdir()\n\npkgPath <- file.path(tempDir, \"packages\", version$platform, paste0(version$major,\n    \".\", strsplit(version$minor, \"[.]\")[[1]][1]))\ndir.create(pkgPath, recursive = TRUE)\n.libPaths(pkgPath, include.site = FALSE)\n\nif (!require(Require, lib.loc = pkgPath)) {\n    remotes::install_github(paste0(\"PredictiveEcology/\", \"Require@5c44205bf407f613f53546be652a438ef1248147\"),\n        upgrade = FALSE, force = TRUE)\n    library(Require, lib.loc = pkgPath)\n}\n\nsetLinuxBinaryRepo()"},{"path":"landr-biomass_validationknn-module.html","id":"b-valid-example-pkg-mods","chapter":"5 LandR Biomass_validationKNN Module","heading":"5.3.2 Get the module and module dependencies","text":"Biomass_validationKNN meant validate simulation outputs \nobserved data, need first run simulation forest dynamics \nBiomass_core. get modules’ code PredictiveEcology\nGitHub repository (install necessary packages). Notice \nplacing packages, module code, inputs outputs temporary directories.","code":"\nRequire(paste0(\"PredictiveEcology/\", \"SpaDES.project@6d7de6ee12fc967c7c60de44f1aa3b04e6eeb5db\"),\n    require = FALSE, upgrade = FALSE, standAlone = TRUE)\n\npaths <- list(inputPath = normPath(file.path(tempDir, \"inputs\")),\n    cachePath = normPath(file.path(tempDir, \"cache\")), modulePath = normPath(file.path(tempDir,\n        \"modules\")), outputPath = normPath(file.path(tempDir,\n        \"outputs\")))\n\nSpaDES.project::getModule(modulePath = paths$modulePath, c(\"PredictiveEcology/Biomass_core@master\",\n    \"PredictiveEcology/Biomass_validationKNN@master\"), overwrite = TRUE)\n\n## make sure all necessary packages are installed:\nouts <- SpaDES.project::packagesInModules(modulePath = paths$modulePath)\nRequire(c(unname(unlist(outs)), \"PredictiveEcology/SpaDES.experiment@development\",\n    \"future\"), require = FALSE, standAlone = TRUE)\n\n## load necessary packages\nRequire(c(\"SpaDES.core\", \"LandR\", \"reproducible\", \"pemisc\", \"SpaDES.experiment\",\n    \"future\"), upgrade = FALSE, install = FALSE)"},{"path":"landr-biomass_validationknn-module.html","id":"setup-simulation-2","chapter":"5 LandR Biomass_validationKNN Module","heading":"5.3.3 Setup simulation","text":"","code":"\ntimes <- list(start = 2001, end = 2011)\n\nstudyArea <- Cache(randomStudyArea, size = 1e+07)  # cache this so it creates a random one only once on a machine\n\n# Pick the species you want to work with -- using the\n# naming convention in 'Boreal' column of\n# LandR::sppEquivalencies_CA\nspeciesNameConvention <- \"Boreal\"\nspeciesToUse <- c(\"Pice_Gla\", \"Popu_Tre\", \"Pinu_Con\")\n\nsppEquiv <- sppEquivalencies_CA[get(speciesNameConvention) %in%\n    speciesToUse]\n# Assign a colour convention for graphics for each species\nsppColorVect <- sppColors(sppEquiv, speciesNameConvention, newVals = \"Mixed\",\n    palette = \"Set1\")\n\n## Usage example\nmodules <- as.list(\"Biomass_core\")\nobjects <- list(studyArea = studyArea, sppEquiv = sppEquiv, sppColorVect = sppColorVect)\n\nsuccessionTimestep <- 20L\n\n## keep default values for most parameters (omitted from\n## this list)\nparameters <- list(Biomass_core = list(sppEquivCol = speciesNameConvention,\n    successionTimestep = successionTimestep, .plotInitialTime = times$start,\n    .plotInterval = 1L, .plots = \"png\", .saveInitialTime = times$start,\n    .useCache = \"init\", .useParallel = FALSE))\n\noutputs <- data.frame(expand.grid(objectName = \"cohortData\",\n    saveTime = unique(seq(times$start, times$end, by = 1)), eventPriority = 1,\n    stringsAsFactors = FALSE))\noutputs <- rbind(outputs, data.frame(objectName = \"pixelGroupMap\",\n    saveTime = unique(seq(times$start, times$end, by = 1)), eventPriority = 1))"},{"path":"landr-biomass_validationknn-module.html","id":"run-simulation","chapter":"5 LandR Biomass_validationKNN Module","heading":"5.3.4 Run simulation","text":"run simulation three replicates using experiment2 function\nSpaDES.experiment R package (McIntire & Chubaty 2021), builds \nfolder structure simulation outputs conveniently organised.","code":"\nopts <- options(reproducible.useCache = TRUE, reproducible.destinationPath = paths$inputPath,\n    spades.useRequire = FALSE)\ngraphics.off()\nmySimInit <- simInit(times = times, params = parameters, modules = modules,\n    objects = objects, paths = paths, outputs = outputs)\n\nplan(sequential)\nmySimExperiment <- experiment2(sim1 = mySimInit, clearSimEnv = FALSE,\n    replicates = 3)"},{"path":"landr-biomass_validationknn-module.html","id":"validate-simulation-outputs-with-biomass_validationknn","chapter":"5 LandR Biomass_validationKNN Module","heading":"5.3.5 Validate simulation outputs with Biomass_validationKNN","text":"Note ran Biomass_core using theoretical input data,\ncan expect validation reveal module didn’t great job \nreproducing observed patterns.Note Google Account needed download input files.output figures automatically produced \nBiomass_validationKNN\nFigure 5.1: Biomass_validationKNN automatically generates plots showing visual comparison simulated observed species presences (right) across landscape, relative species biomass per pixel (left).\n\nFigure 5.2: plot landscape-wide mean absolute deviations (MAD) (top bottom) observed mean relative abundance, . presences, . pixels species dominant \\(\\Delta\\)B.\n\nFigure 5.3: Diagnostic plot observed changes biomass age \\(\\Delta\\)B \\(\\Delta\\)Age, respectively).\n","code":"\nsimulationOutputs <- lapply(mySimExperiment, FUN = function(x,\n    localSimPaths) {\n    oldPath <- dirname(outputPath(x))  ## exclude sim*_rep* folder\n    DT <- as.data.table(outputs(x))\n    DT[, `:=`(file, sub(oldPath, localSimPaths$outputPath, file))]\n    DT\n}, localSimPaths = as.list(normPath(paths)))\nsimulationOutputs <- rbindlist(simulationOutputs)\n\nvalidationPaths <- as.list(normPath(paths))\nvalidationPaths$outputPath <- file.path(validationPaths$outputPath,\n    \"validation\")\n\nvalidationTimes <- list(start = 1, end = 1)\nvalidationParams <- list(Biomass_validationKNN = list(sppEquivCol = params(mySimInit)$Biomass_core$sppEquivCol,\n    validationReps = as.integer(1:3)  ## or length of simLists\n,\n    validationYears = as.integer(c(2001, 2011)), .plots = c(\"png\")))\n\n## make an empty fire polygon object to bypass removing\n## fire-disturbed pixels\nnoFires <- sf::st_polygon()\nvalidationObjects <- list(biomassMap = mySimExperiment$sim1_rep1$biomassMap,\n    firePerimeters = noFires, rasterToMatch = mySimExperiment$sim1_rep1$rasterToMatch,\n    rawBiomassMapStart = mySimExperiment$sim1_rep1$biomassMap,\n    simulationOutputs = simulationOutputs, speciesLayersStart = mySimExperiment$sim1_rep1$speciesLayers,\n    sppColorVect = mySimExperiment$sim1_rep1$sppColorVect, sppEquiv = mySimExperiment$sim1_rep1$sppEquiv,\n    studyArea = mySimExperiment$sim1_rep1$studyArea)\n\nmySimValidation <- simInitAndSpades(times = validationTimes,\n    params = validationParams, modules = \"Biomass_validationKNN\",\n    objects = validationObjects, paths = validationPaths, .studyAreaName = SAname)"},{"path":"landr-biomass_validationknn-module.html","id":"bvalid-refs","chapter":"5 LandR Biomass_validationKNN Module","heading":"5.4 References","text":"","code":""}]
