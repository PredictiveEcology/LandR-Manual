<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 2 LandR Biomass_speciesData Module | LandR Manual</title>
<meta name="description" content="2.0.0.1 Authors: Ceres Barros ceres.barros@ubc.ca [aut, cre], Eliot J B McIntire eliot.mcintire@nrcan-rncan.gc.ca [aut], Alex M. Chubaty achubaty@for-cast.ca [aut] This documentation is work in...">
<meta name="generator" content="bookdown 0.29 with bs4_book()">
<meta property="og:title" content="Chapter 2 LandR Biomass_speciesData Module | LandR Manual">
<meta property="og:type" content="book">
<meta property="og:url" content="https://predictiveecology.github.io/LandR-Manual/landr-biomass_speciesdata-module.html">
<meta property="og:image" content="https://predictiveecology.github.io/LandR-Manual/figures/LandRHex.png">
<meta property="og:description" content="2.0.0.1 Authors: Ceres Barros ceres.barros@ubc.ca [aut, cre], Eliot J B McIntire eliot.mcintire@nrcan-rncan.gc.ca [aut], Alex M. Chubaty achubaty@for-cast.ca [aut] This documentation is work in...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 2 LandR Biomass_speciesData Module | LandR Manual">
<meta name="twitter:description" content="2.0.0.1 Authors: Ceres Barros ceres.barros@ubc.ca [aut, cre], Eliot J B McIntire eliot.mcintire@nrcan-rncan.gc.ca [aut], Alex M. Chubaty achubaty@for-cast.ca [aut] This documentation is work in...">
<meta name="twitter:image" content="https://predictiveecology.github.io/LandR-Manual/figures/LandRHex.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="css/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="v. 1.0.1.9000">LandR Manual</a>:
        <small class="text-muted">v. 1.0.1.9000</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="landr-biomass_core-module.html"><span class="header-section-number">1</span> LandR Biomass_core Module</a></li>
<li><a class="" href="landr-data-and-calibration-modules.html">LandR Data and Calibration Modules</a></li>
<li><a class="active" href="landr-biomass_speciesdata-module.html"><span class="header-section-number">2</span> LandR Biomass_speciesData Module</a></li>
<li><a class="" href="landr-biomass_borealdataprep-module.html"><span class="header-section-number">3</span> LandR Biomass_borealDataPrep Module</a></li>
<li><a class="" href="landr-biomass_speciesparameters-module.html"><span class="header-section-number">4</span> LandR Biomass_speciesParameters Module</a></li>
<li><a class="" href="landr-validation-modules.html">LandR Validation Modules</a></li>
<li><a class="" href="landr-biomass_validationknn-module.html"><span class="header-section-number">5</span> LandR Biomass_validationKNN Module</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/PredictiveEcology/LandR-Manual">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="landr-biomass_speciesdata-module" class="section level1" number="2">
<h1>
<span class="header-section-number">2</span> LandR <em>Biomass_speciesData</em> Module<a class="anchor" aria-label="anchor" href="#landr-biomass_speciesdata-module"><i class="fas fa-link"></i></a>
</h1>
<!-- the following are text references used in captions for LaTeX compatibility -->





<p><a href="https://github.com/PredictiveEcology/Biomass_speciesData/commit/1dc71ebc6181b6eb9b0813db2ca4184488312197"><img src="modules/Biomass_speciesData/figures/moduleVersionBadge.png" alt="module-version-Badge"></a></p>
<p><a href="https://github.com/PredictiveEcology/Biomass_speciesData/issues"><img src="modules/Biomass_speciesData/figures/issuesBadge.png" alt="Issues-badge"></a></p>
<div id="authors-1" class="section level4" number="2.0.0.1">
<h4>
<span class="header-section-number">2.0.0.1</span> Authors:<a class="anchor" aria-label="anchor" href="#authors-1"><i class="fas fa-link"></i></a>
</h4>
<p>Ceres Barros <a href="mailto:ceres.barros@ubc.ca" class="email">ceres.barros@ubc.ca</a> [aut, cre], Eliot J B McIntire <a href="mailto:eliot.mcintire@nrcan-rncan.gc.ca" class="email">eliot.mcintire@nrcan-rncan.gc.ca</a> [aut], Alex M. Chubaty <a href="mailto:achubaty@for-cast.ca" class="email">achubaty@for-cast.ca</a> [aut]
<!-- ideally separate authors with new lines, '\n' not working --></p>
<p><strong>This documentation is work in progress. Potential discrepancies and omissions
may exist for the time being. If you find any, contact us using the “Get help”
link above.</strong></p>
</div>
<div id="module-overview-1" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> Module Overview<a class="anchor" aria-label="anchor" href="#module-overview-1"><i class="fas fa-link"></i></a>
</h2>
<div id="quick-links-1" class="section level3" number="2.1.1">
<h3>
<span class="header-section-number">2.1.1</span> Quick links<a class="anchor" aria-label="anchor" href="#quick-links-1"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p><a href="landr-biomass_speciesdata-module.html#bsppdata-general-functioning">General functioning</a></p></li>
<li><p><a href="landr-biomass_speciesdata-module.html#bsppdata-inputs-list">List of input objects</a></p></li>
<li><p><a href="landr-biomass_speciesdata-module.html#bsppdata-params-list">List of parameters</a></p></li>
<li><p><a href="landr-biomass_speciesdata-module.html#bsppdata-outputs-list">List of outputs</a></p></li>
<li><p><a href="landr-biomass_speciesdata-module.html#bsppdata-sim-flow">Simulation flow and module events</a></p></li>
</ul>
</div>
<div id="module-summary" class="section level3" number="2.1.2">
<h3>
<span class="header-section-number">2.1.2</span> Module summary<a class="anchor" aria-label="anchor" href="#module-summary"><i class="fas fa-link"></i></a>
</h3>
<p>LandR <em>Biomass_speciesData</em> (hereafter <em>Biomass_speciesData</em>) downloads and
pre-processes species percent (% cover) data layers used by other
LandR data modules (e.g., <em>Biomass_borealDataPrep</em>) and by the LandR forest
simulation module <em>Biomass_core</em>.</p>
</div>
<div id="bsppdata-links-modules" class="section level3" number="2.1.3">
<h3>
<span class="header-section-number">2.1.3</span> Links to other modules<a class="anchor" aria-label="anchor" href="#bsppdata-links-modules"><i class="fas fa-link"></i></a>
</h3>
<p><em>Biomass_speciesData</em> is intended to be used with any LandR modules that require
species % cover raster layers (see examples below). See
<a href="https://rpubs.com/PredictiveEcology/LandR_Module_Ecosystem">here</a> for all
available modules in the LandR ecosystem and select <em>Biomass_speciesData</em> from
the drop-down menu to see potential linkages.</p>
<ul>
<li><p><a href="https://github.com/PredictiveEcology/Biomass_borealDataPrep"><em>Biomass_borealDataPrep</em></a>:
prepares all parameters and inputs (including initial landscape conditions)
that <em>Biomass_core</em> needs to run a realistic simulation. Default
values/inputs produced are relevant for boreal forests of Western Canada.
Used downstream from <em>Biomass_speciesData</em>;</p></li>
<li><p><a href="https://github.com/PredictiveEcology/Biomass_core"><em>Biomass_core</em></a>: core
forest dynamics simulation module. Used downstream from
<em>Biomass_speciesData</em>.</p></li>
</ul>
</div>
</div>
<div id="module-manual-1" class="section level2" number="2.2">
<h2>
<span class="header-section-number">2.2</span> Module manual<a class="anchor" aria-label="anchor" href="#module-manual-1"><i class="fas fa-link"></i></a>
</h2>
<div id="bsppdata-general-functioning" class="section level3" number="2.2.1">
<h3>
<span class="header-section-number">2.2.1</span> General functioning<a class="anchor" aria-label="anchor" href="#bsppdata-general-functioning"><i class="fas fa-link"></i></a>
</h3>
<p><em>Biomass_speciesData</em> accesses and processes species % cover data
for the parametrisation and initialisation of LandR <em>Biomass_core</em>. This module
ensures 1) that all data use the same geospatial geometries and 2) that these
are correctly re-projected to the study area used for parametrisation
(<code>studyAreaLarge</code> polygon), and 3) attempts to sequentially fill-in and replace
the lowest quality data with higher quality data when several data sources are
used. It’s primary output is a <code>RasterStack</code> of species % cover,
with each layer corresponding to a species.</p>
<p>Currently, the module can access the Canadian National Forest Inventory (NFI)
forest attributes kNN dataset [the default; <span class="citation">Beaudoin <em>et al.</em> (<a href="landr-biomass_validationknn-module.html#ref-BeaudoinEtAl2017" role="doc-biblioref">2017</a>)</span>], the Common
Attribute Schema for Forest Resource Inventories dataset [CASFRI; <span class="citation">Cosco (<a href="landr-biomass_validationknn-module.html#ref-Cosco2011" role="doc-biblioref">2011</a>)</span>],
the Ontario Forest Resource Inventory (ONFRI), a dataset specific to Alberta
compiled by Paul Pickell, and other Alberta forest inventory datasets. However,
<strong>only the NFI kNN data are freely available</strong> and access to the other datasets
must be granted by module developers and data owners, and requires a Google
account. Nevertheless, the module is flexible enough that any user can use it to
process additional datasets, provided that an adequate R function is passed to
the module (see <code>types</code> parameter details in the <a href="landr-biomass_speciesdata-module.html#bsppdata-params-list">list of
parameters</a>)</p>
<p>When multiple data sources are used, the module will replace lower quality data
with higher quality data following the order specified in the <code>types</code> parameter.</p>
<p>When multiple species of a given data source are to be grouped, %
cover is summed across species of the same group within each pixel. Please see
the <code>sppEquiv</code> in the <a href="landr-biomass_speciesdata-module.html#bsppdata-inputs-list">list of input objects</a> for
information on how to define species groups.</p>
<p>The module can also exclude species % cover layers if they don’t
have a minimum % cover value in at least one pixel. The user should
still inspect where species is deemed present (e.g., in how many pixels in
total), as it is possible that some datasets only have a few pixels where the
species is present, but with reported high % cover. In this case,
the user may choose to exclude these species <em>a posteriori</em>. The summary plot
automatically shown by <em>Biomass_speciesData</em> can help diagnose whether certain
species are present in very few pixels (see Fig.
<a href="landr-biomass_speciesdata-module.html#fig:fig-Biomass-speciesDataOutPlots">2.1</a>).</p>
</div>
<div id="bsppdata-inputs-list" class="section level3" number="2.2.2">
<h3>
<span class="header-section-number">2.2.2</span> List of input objects<a class="anchor" aria-label="anchor" href="#bsppdata-inputs-list"><i class="fas fa-link"></i></a>
</h3>
<p>Below is the full list of input objects that <em>Biomass_speciesData</em> requires
(Table <a href="landr-biomass_speciesdata-module.html#tab:moduleInputs2-Biomass-speciesData">2.2</a>). Of these, the only input
that <strong>must</strong> be provided (i.e., <em>Biomass_speciesData</em> does not have a default
for) is <code>studyAreaLarge</code>.</p>
<p>Of the inputs in Table <a href="landr-biomass_speciesdata-module.html#tab:moduleInputs2-Biomass-speciesData">2.2</a>, the
following are particularly important and deserve special attention:</p>
<ul>
<li><p><code>studyAreaLarge</code> – the polygon defining the area for which species cover
data are desired. It can be larger (but never smaller) that the study area
used in the simulation of forest dynamics (i.e., <code>studyArea</code> object in
<em>Biomass_core</em>), in which case it should fully cover it.</p></li>
<li><p><code>sppEquiv</code> – a table of correspondences between different species naming
conventions. This table is used across several LandR modules, including
<em>Biomass_core</em>. It is particularly important here because it will determine
whether and which species (and their cover layers) are merged. For instance,
if the user wishes to simulate a generic <em>Picea spp.</em> that includes, <em>Picea
glauca</em>, <em>Picea mariana</em> and <em>Picea engelmannii</em>, they will need to provide
these three species names in the data column (e.g., <code>KNN</code> if obtaining
forest attribute kNN data layers from the National Forest Inventory), but
the same name (e.g., “Pice_Spp”) in the column chosen for the naming
convention used throughout the simulation (defined by the <code>sppEquivCol</code>
parameter). See Table <a href="landr-biomass_speciesdata-module.html#tab:mergingSpp-Biomass-speciesData">2.1</a> for an
example.</p></li>
</ul>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:mergingSpp-Biomass-speciesData">Table 2.1: </span>Example of species merging for simulation. Here the user wants to model <em>Abies balsamea</em>, <em>A. lasiocarpa</em> and <em>Pinus contorta</em> as separate species, but all <em>Picea spp.</em> as a genus-level group. For this, all six species are separately identified in the ‘KNN’ column, so that their % cover layers can be obtained, but in the ‘Boreal’ column (which defines the naming convention used in the simulation in this example) all <em>Picea spp.</em> have the same name. <em>Biomass_speciesData</em> will merge their % cover data into a single layer by summing their cover per pixel.
</caption>
<thead><tr>
<th style="text-align:left;">
Species
</th>
<th style="text-align:left;">
KNN
</th>
<th style="text-align:left;">
Boreal
</th>
<th style="text-align:left;">
Modelled as
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-style: italic;">
Abies balsamea
</td>
<td style="text-align:left;">
Abie_Bal
</td>
<td style="text-align:left;">
Abie_Bal
</td>
<td style="text-align:left;font-style: italic;">
Abies balsamea
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Abies lasiocarpa
</td>
<td style="text-align:left;">
Abie_Las
</td>
<td style="text-align:left;">
Abie_Las
</td>
<td style="text-align:left;font-style: italic;">
Abies lasiocarpa
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Picea engelmannii
</td>
<td style="text-align:left;">
Pice_Eng
</td>
<td style="text-align:left;">
Pice_Spp
</td>
<td style="text-align:left;font-style: italic;">
Picea spp.
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Picea glauca
</td>
<td style="text-align:left;">
Pice_Gla
</td>
<td style="text-align:left;">
Pice_Spp
</td>
<td style="text-align:left;font-style: italic;">
Picea spp.
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Picea mariana
</td>
<td style="text-align:left;">
Pice_Mar
</td>
<td style="text-align:left;">
Pice_Spp
</td>
<td style="text-align:left;font-style: italic;">
Picea spp.
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Pinus contorta
</td>
<td style="text-align:left;">
Pinu_Con
</td>
<td style="text-align:left;">
Pinu_Con
</td>
<td style="text-align:left;font-style: italic;">
Pinus contorta
</td>
</tr>
</tbody>
</table></div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:moduleInputs2-Biomass-speciesData">Table 2.2: </span>List of <em>Biomass_speciesData</em> input objects and their description.
</caption>
<thead><tr>
<th style="text-align:left;">
objectName
</th>
<th style="text-align:left;">
objectClass
</th>
<th style="text-align:left;">
desc
</th>
<th style="text-align:left;">
sourceURL
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
rasterToMatchLarge
</td>
<td style="text-align:left;">
RasterLayer
</td>
<td style="text-align:left;">
a raster of <code>studyAreaLarge</code> in the same resolution and projection the simulation’s. Defaults to the using the Canadian Forestry Service, National Forest Inventory, kNN-derived stand biomass map.
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
sppColorVect
</td>
<td style="text-align:left;">
character
</td>
<td style="text-align:left;">
A named vector of colors to use for plotting. The names must be in <code>sim$sppEquiv[[sim$sppEquivCol]]</code>, and should also contain a color for ‘Mixed’
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
sppEquiv
</td>
<td style="text-align:left;">
data.table
</td>
<td style="text-align:left;">
table of species equivalencies. See <code><a href="https://landr.predictiveecology.org/reference/sppEquivalencies_CA.html">LandR::sppEquivalencies_CA</a></code>.
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
studyAreaLarge
</td>
<td style="text-align:left;">
SpatialPolygonsDataFrame
</td>
<td style="text-align:left;">
Polygon to use as the parametrisation study area. Must be provided by the user. Note that <code>studyAreaLarge</code> is only used for parameter estimation, and can be larger than the actual study area used for LandR simulations (e.g, larger than <code>studyArea</code> in LandR Biomass_core).
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
studyAreaReporting
</td>
<td style="text-align:left;">
SpatialPolygonsDataFrame
</td>
<td style="text-align:left;">
multipolygon (typically smaller/unbuffered than <code>studyAreaLarge</code> and <code>studyArea</code> in LandR Biomass_core) to use for plotting/reporting. If not provided, will default to <code>studyAreaLarge</code>.
</td>
<td style="text-align:left;">
NA
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="bsppdata-params-list" class="section level3" number="2.2.3">
<h3>
<span class="header-section-number">2.2.3</span> List of parameters<a class="anchor" aria-label="anchor" href="#bsppdata-params-list"><i class="fas fa-link"></i></a>
</h3>
<p>Table <a href="landr-biomass_speciesdata-module.html#tab:moduleParams2-Biomass-speciesData">2.3</a> lists all parameters used in
<em>Biomass_speciesData</em> and their detailed information. All these parameters have
default values specified in the module’s metadata.</p>
<p>Of these parameters, the following are particularly important:</p>
<ul>
<li><p><code>coverThresh</code> – integer. Defines a minimum % cover value (from
0-100) that the species must have in at least one pixel to be considered
present in the study area, otherwise it is excluded from the final stack of
species layers (<code>speciesLayers</code>). Note that this will affect what species
have data for an eventual simulation and the user will need to adjust
simulation parameters accordingly (e.g., species in trait tables will need
to match the species in <code>speciesLayers</code>).</p></li>
<li><p><code>types</code> – character. Which % cover data sources are to be used
(see <a href="landr-biomass_speciesdata-module.html#bsppdata-general-functioning">General functioning</a>). Several data
sources can be passed, in which case the module will overlay the lower
quality layers with higher quality ones following the order of data sources
in <code>types</code>. For instance, if
<code>types == c("KNN", "CASFRI", "ForestInventory")</code>, KNN is assumed to be the
lowest quality data set and ForestInventory the highest, hence values in KNN
layers are replaced with overlapping values from CASFRI layers and values
from KNN and CASFRI layers are replaced with overlapping values of
ForestInventory layers.</p></li>
</ul>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:moduleParams2-Biomass-speciesData">Table 2.3: </span>List of <em>Biomass_speciesData</em> parameters and their description.
</caption>
<thead><tr>
<th style="text-align:left;">
paramName
</th>
<th style="text-align:left;">
paramClass
</th>
<th style="text-align:left;">
default
</th>
<th style="text-align:left;">
min
</th>
<th style="text-align:left;">
max
</th>
<th style="text-align:left;">
paramDesc
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
coverThresh
</td>
<td style="text-align:left;">
integer
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
The minimum % cover a species needs to have (per pixel) in the study area to be considered present
</td>
</tr>
<tr>
<td style="text-align:left;">
dataYear
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
2001
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Passed to <code>paste0('prepSpeciesLayers_', types)</code> function to fetch data from that year (if applicable). Defaults to 2001 as the default kNN year.
</td>
</tr>
<tr>
<td style="text-align:left;">
sppEquivCol
</td>
<td style="text-align:left;">
character
</td>
<td style="text-align:left;">
Boreal
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
The column in <code>sim$sppEquiv</code> data.table to group species by and use as a naming convention. If different species in, e.g., the kNN data have the same name in the chosen column, their data are merged into one species by summing their % cover in each raster cell.
</td>
</tr>
<tr>
<td style="text-align:left;">
types
</td>
<td style="text-align:left;">
character
</td>
<td style="text-align:left;">
KNN
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
The possible data sources. These must correspond to a function named <code>paste0('prepSpeciesLayers_', types)</code>. Defaults to ‘KNN’ to get the Canadian Forestry Service, National Forest Inventory, kNN-derived species cover maps from year ‘dataYear’, using the <code><a href="https://landr.predictiveecology.org/reference/prepSpeciesLayers.html">LandR::prepSpeciesLayers_KNN</a></code> function (see <a href="https://open.canada.ca/" class="uri">https://open.canada.ca/</a> data/en/dataset/ec9e2659-1c29-4ddb-87a2-6aced147a990 for details on these data). Other currently available options are ‘ONFRI’, ‘CASFRI’, ‘Pickell’ and ‘ForestInventory’, which attempt to get proprietary data - the user must be granted access first. A custom function can be used to retrieve any data, just as long as it is accessible by the module (e.g., in the global environment) and is named as <code>paste0('prepSpeciesLayers_', types)</code>.
</td>
</tr>
<tr>
<td style="text-align:left;">
vegLeadingProportion
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
0.8
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
a number that defines whether a species is leading for a given pixel. Only used for plotting.
</td>
</tr>
<tr>
<td style="text-align:left;">
.plotInitialTime
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
This describes the simulation time at which the first plot event should occur
</td>
</tr>
<tr>
<td style="text-align:left;">
.plotInterval
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
This describes the simulation time interval between plot events
</td>
</tr>
<tr>
<td style="text-align:left;">
.saveInitialTime
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
This describes the simulation time at which the first save event should occur
</td>
</tr>
<tr>
<td style="text-align:left;">
.saveInterval
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
This describes the simulation time interval between save events
</td>
</tr>
<tr>
<td style="text-align:left;">
.sslVerify
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
64
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Passed to <code>httr::config(ssl_verifypeer = P(sim)$.sslVerify)</code> when downloading KNN (NFI) datasets. Set to 0L if necessary to bypass checking the SSL certificate (this may be necessary when NFI’s FTP website SSL certificate is down/out-of-date).
</td>
</tr>
<tr>
<td style="text-align:left;">
.studyAreaName
</td>
<td style="text-align:left;">
character
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Human-readable name for the study area used. If NA, a hash of <code>studyAreaLarge</code> will be used.
</td>
</tr>
<tr>
<td style="text-align:left;">
.useCache
</td>
<td style="text-align:left;">
character
</td>
<td style="text-align:left;">
init
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Controls cache; caches the init event by default
</td>
</tr>
<tr>
<td style="text-align:left;">
.useParallel
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
16
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Used in reading csv file with fread. Will be passed to <code><a href="https://Rdatatable.gitlab.io/data.table/reference/openmp-utils.html">data.table::setDTthreads</a></code>.
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="bsppdata-outputs-list" class="section level3" number="2.2.4">
<h3>
<span class="header-section-number">2.2.4</span> List of outputs<a class="anchor" aria-label="anchor" href="#bsppdata-outputs-list"><i class="fas fa-link"></i></a>
</h3>
<p>The module produces the outputs in Table
<a href="landr-biomass_speciesdata-module.html#tab:moduleOutputs-Biomass-speciesData">2.4</a>, and automatically saves the
processed species cover layers in the output path defined in
<code>getPaths(sim)$outputPath</code>.</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:moduleOutputs-Biomass-speciesData">Table 2.4: </span>List of <em>Biomass_speciesData</em> output objects and their description.
</caption>
<thead><tr>
<th style="text-align:left;">
objectName
</th>
<th style="text-align:left;">
objectClass
</th>
<th style="text-align:left;">
desc
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
speciesLayers
</td>
<td style="text-align:left;">
RasterStack
</td>
<td style="text-align:left;">
biomass percentage raster layers by species in Canada species map
</td>
</tr>
<tr>
<td style="text-align:left;">
treed
</td>
<td style="text-align:left;">
data.table
</td>
<td style="text-align:left;">
Table with one logical column for each species, indicating whether there were non-zero cover values in each pixel.
</td>
</tr>
<tr>
<td style="text-align:left;">
numTreed
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
a named vector with number of pixels with non-zero cover values for each species
</td>
</tr>
<tr>
<td style="text-align:left;">
nonZeroCover
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
A single value indicating how many pixels have non-zero cover
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="bsppdata-sim-flow" class="section level3" number="2.2.5">
<h3>
<span class="header-section-number">2.2.5</span> Simulation flow and module events<a class="anchor" aria-label="anchor" href="#bsppdata-sim-flow"><i class="fas fa-link"></i></a>
</h3>
<p><em>Biomass_speciesData</em> initialises itself and prepares all inputs provided that
it has internet access to download the raw data layers, or that these layers
have been previously downloaded and stored in the folder specified by
<code>options("reproducible.destinationPath")</code><a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a>.</p>
<p>The module defaults to processing cover data fo all species listed in the
<code>Boreal</code> column of the default <code>sppEquiv</code> input <code>data.table</code> object, for which
there are available % cover layers in the kNN dataset (Table
<a href="landr-biomass_speciesdata-module.html#tab:defaultSppBiomass-speciesData">2.5</a>; see <code><a href="https://landr.predictiveecology.org/reference/sppEquivalencies_CA.html">?LandR::sppEquivalencies_CA</a></code> for
more information):</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:defaultSppBiomass-speciesData">Table 2.5: </span>List of species cover data downloaded by default by <em>Biomass_speciesData</em>.
</caption>
<thead><tr>
<th style="text-align:left;">
Species
</th>
<th style="text-align:left;">
Generic name
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-style: italic;">
Abies balsamea
</td>
<td style="text-align:left;">
Balsam Fir
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Abies lasiocarpa
</td>
<td style="text-align:left;">
Fir
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Acer negundo
</td>
<td style="text-align:left;">
Boxelder maple
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Acer pensylvanicum
</td>
<td style="text-align:left;">
Striped maple
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Acer saccharum
</td>
<td style="text-align:left;">
Sugar maple
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Acer spicatum
</td>
<td style="text-align:left;">
Mountain maple
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Acer spp.
</td>
<td style="text-align:left;">
Maple
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Alnus spp
</td>
<td style="text-align:left;">
Alder
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Betula alleghaniensis
</td>
<td style="text-align:left;">
Swamp birch
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Betula papyrifera
</td>
<td style="text-align:left;">
Paper birch
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Betula populifolia
</td>
<td style="text-align:left;">
Gray birch
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Betula spp.
</td>
<td style="text-align:left;">
Birch
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Fagus grandifolia
</td>
<td style="text-align:left;">
American beech
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Fraxinus americana
</td>
<td style="text-align:left;">
American ash
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Fraxinus nigra
</td>
<td style="text-align:left;">
Black ash
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Larix laricina
</td>
<td style="text-align:left;">
Tamarack
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Larix lyallii
</td>
<td style="text-align:left;">
Alpine larch
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Larix occidentalis
</td>
<td style="text-align:left;">
Western larch
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Larix spp.
</td>
<td style="text-align:left;">
Larch
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Picea engelmannii
</td>
<td style="text-align:left;">
Engelmann’s spruce
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Picea glauca
</td>
<td style="text-align:left;">
White.Spruce
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Picea mariana
</td>
<td style="text-align:left;">
Black.Spruce
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Picea spp.
</td>
<td style="text-align:left;">
Spruce
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Pinus albicaulis
</td>
<td style="text-align:left;">
Whitebark pine
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Pinus banksiana
</td>
<td style="text-align:left;">
Jack pine
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Pinus contorta
</td>
<td style="text-align:left;">
Lodgepole pine
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Pinus monticola
</td>
<td style="text-align:left;">
Western white pine
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Pinus resinosa
</td>
<td style="text-align:left;">
Red pine
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Pinus spp.
</td>
<td style="text-align:left;">
Pine
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Populus balsamifera v. balsamifera
</td>
<td style="text-align:left;">
Balsam poplar
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Populus trichocarpa
</td>
<td style="text-align:left;">
Black cottonwood
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Populus grandidentata
</td>
<td style="text-align:left;">
White poplar
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Populus spp.
</td>
<td style="text-align:left;">
Poplar
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Populus tremuloides
</td>
<td style="text-align:left;">
Trembling poplar
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Tsuga canadensis
</td>
<td style="text-align:left;">
Eastern hemlock
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Tsuga spp.
</td>
<td style="text-align:left;">
Hemlock
</td>
</tr>
</tbody>
</table></div>
<p><em>Biomass_speciesData</em> only runs two events, the <code>init</code> event where all species
cover layers are processed and a plotting event (<code>initPlot</code>) that plots the
final layers.</p>
<p>The general flow of <em>Biomass_speciesData</em> processes is:</p>
<ol style="list-style-type: decimal">
<li><p>Download (if necessary) and spatial processing of species cover layers from
the first data source listed in the <code>types</code> parameter. Spatial processing
consists in sub-setting the data to the area defined by <code>studyAreaLarge</code> and
ensuring that the spatial projection and resolution match those of
<code>rasterToMatchLarge</code>. After spatial processing, species layers that have no
pixels with values <span class="math inline">\(\ge\)</span> <code>coverThresh</code> are excluded.</p></li>
<li><p>If more than one data source is listed in <code>types</code>, the second set of species
cover layers is downloaded and processed as above.</p></li>
<li><p>The second set of layers is assumed to be the highest quality dataset and
used to replaced overlapping pixel values on the first (including for
species whose layers may have been initially excluded after applying the
<code>coverThresh</code> filter).</p></li>
<li><p>Steps 2 and 3 are repeated for remaining data sources listed in <code>types</code>.</p></li>
<li><p>Final layers are saved to disk and plotted (<code>initPlot</code> event). A summary of
number of pixels with forest cover are calculated (<code>treed</code>and <code>numTreed</code>
output objects; see <a href="landr-biomass_speciesdata-module.html#bsppdata-outputs-list">list of outputs</a>).</p></li>
</ol>
</div>
</div>
<div id="bsppdata-example" class="section level2" number="2.3">
<h2>
<span class="header-section-number">2.3</span> Usage example<a class="anchor" aria-label="anchor" href="#bsppdata-example"><i class="fas fa-link"></i></a>
</h2>
<p>This module can be run stand-alone, but it only compiles species %
cover data into layers used by other modules.</p>
<div id="load-spades-and-other-packages." class="section level3" number="2.3.1">
<h3>
<span class="header-section-number">2.3.1</span> Load <code>SpaDES</code> and other packages.<a class="anchor" aria-label="anchor" href="#load-spades-and-other-packages."><i class="fas fa-link"></i></a>
</h3>
</div>
<div id="bsppdata-example-libs" class="section level3" number="2.3.2">
<h3>
<span class="header-section-number">2.3.2</span> Set up R libraries<a class="anchor" aria-label="anchor" href="#bsppdata-example-libs"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>CRAN <span class="op">=</span> <span class="st">"https://cloud.r-project.org"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># tempDir &lt;- tempdir()</span></span>
<span><span class="va">tempDir</span> <span class="op">&lt;-</span> <span class="st">"C:/Users/cbarros/AppData/Local/Temp/Biomass_sppData-example"</span></span>
<span></span>
<span><span class="va">pkgPath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">tempDir</span>, <span class="st">"packages"</span>, <span class="va">version</span><span class="op">$</span><span class="va">platform</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">version</span><span class="op">$</span><span class="va">major</span>,</span>
<span>    <span class="st">"."</span>, <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">version</span><span class="op">$</span><span class="va">minor</span>, <span class="st">"[.]"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span><span class="op">(</span><span class="va">pkgPath</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/libPaths.html">.libPaths</a></span><span class="op">(</span><span class="va">pkgPath</span>, include.site <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://Require.predictiveecology.org">Require</a></span>, lib.loc <span class="op">=</span> <span class="va">pkgPath</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"PredictiveEcology/Require@5c44205bf407f613f53546be652a438ef1248147"</span>,</span>
<span>        upgrade <span class="op">=</span> <span class="cn">FALSE</span>, force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://Require.predictiveecology.org">Require</a></span>, lib.loc <span class="op">=</span> <span class="va">pkgPath</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://Require.predictiveecology.org/reference/setLinuxBinaryRepo.html">setLinuxBinaryRepo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="bsppdataexample-pkg-mods" class="section level3" number="2.3.3">
<h3>
<span class="header-section-number">2.3.3</span> Get the module and module dependencies<a class="anchor" aria-label="anchor" href="#bsppdataexample-pkg-mods"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://Require.predictiveecology.org/reference/Require.html">Require</a></span><span class="op">(</span><span class="st">"PredictiveEcology/SpaDES.project@6d7de6ee12fc967c7c60de44f1aa3b04e6eeb5db"</span>,</span>
<span>    require <span class="op">=</span> <span class="cn">FALSE</span>, upgrade <span class="op">=</span> <span class="cn">FALSE</span>, standAlone <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>inputPath <span class="op">=</span> <span class="fu"><a href="https://Require.predictiveecology.org/reference/normPath.html">normPath</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">tempDir</span>, <span class="st">"inputs"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    cachePath <span class="op">=</span> <span class="fu"><a href="https://Require.predictiveecology.org/reference/normPath.html">normPath</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">tempDir</span>, <span class="st">"cache"</span><span class="op">)</span><span class="op">)</span>, modulePath <span class="op">=</span> <span class="fu"><a href="https://Require.predictiveecology.org/reference/normPath.html">normPath</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">tempDir</span>,</span>
<span>        <span class="st">"modules"</span><span class="op">)</span><span class="op">)</span>, outputPath <span class="op">=</span> <span class="fu"><a href="https://Require.predictiveecology.org/reference/normPath.html">normPath</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">tempDir</span>,</span>
<span>        <span class="st">"outputs"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">SpaDES.project</span><span class="fu">::</span><span class="fu"><a href="http://spades-project.predictiveecology.org/reference/getModule.html">getModule</a></span><span class="op">(</span>modulePath <span class="op">=</span> <span class="va">paths</span><span class="op">$</span><span class="va">modulePath</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PredictiveEcology/Biomass_speciesData@master"</span><span class="op">)</span>,</span>
<span>    overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## make sure all necessary packages are installed:</span></span>
<span><span class="va">outs</span> <span class="op">&lt;-</span> <span class="fu">SpaDES.project</span><span class="fu">::</span><span class="fu"><a href="http://spades-project.predictiveecology.org/reference/metadata.html">packagesInModules</a></span><span class="op">(</span>modulePath <span class="op">=</span> <span class="va">paths</span><span class="op">$</span><span class="va">modulePath</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://Require.predictiveecology.org/reference/Require.html">Require</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">outs</span><span class="op">)</span><span class="op">)</span>, <span class="st">"SpaDES"</span><span class="op">)</span>, require <span class="op">=</span> <span class="cn">FALSE</span>, standAlone <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## load necessary packages</span></span>
<span><span class="fu"><a href="https://Require.predictiveecology.org/reference/Require.html">Require</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"SpaDES"</span>, <span class="st">"LandR"</span>, <span class="st">"reproducible"</span><span class="op">)</span>, upgrade <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    install <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="setup-simulation" class="section level3" number="2.3.4">
<h3>
<span class="header-section-number">2.3.4</span> Setup simulation<a class="anchor" aria-label="anchor" href="#setup-simulation"><i class="fas fa-link"></i></a>
</h3>
<p>For this demonstration we are using all default parameter values, except
<code>coverThresh</code> , which is lowered to 5%. The species layers (the
major output of interest) are saved automatically, so there is no need to tell
<code>spades</code> what to save using the <code>outputs</code> argument (see
<code><a href="https://spades-core.predictiveecology.org/reference/simList-accessors-outputs.html">?SpaDES.core::outputs</a></code>).</p>
<p>We pass the global parameter <code>.plotInitialTime = 1</code> in the <code>simInitAndSpades</code>
function to activate plotting.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># User may want to set some options -- see</span></span>
<span><span class="co"># ?reproducibleOptions -- e.g., often the path to the</span></span>
<span><span class="co"># 'inputs' folder will be set outside of project by user:</span></span>
<span><span class="co"># options(reproducible.inputPaths =</span></span>
<span><span class="co"># 'E:/Data/LandR_related/') # to re-use datasets across</span></span>
<span><span class="co"># projects</span></span>
<span><span class="va">studyAreaLarge</span> <span class="op">&lt;-</span> <span class="fu">Cache</span><span class="op">(</span><span class="va">randomStudyArea</span>, size <span class="op">=</span> <span class="fl">1e+07</span>, cacheRepo <span class="op">=</span> <span class="va">paths</span><span class="op">$</span><span class="va">cachePath</span><span class="op">)</span>  <span class="co"># cache this so it creates a random one only once on a machine</span></span>
<span></span>
<span><span class="co"># Pick the species you want to work with -- here we use the</span></span>
<span><span class="co"># naming convention in 'Boreal' column of</span></span>
<span><span class="co"># LandR::sppEquivalencies_CA (default)</span></span>
<span><span class="va">speciesNameConvention</span> <span class="op">&lt;-</span> <span class="st">"Boreal"</span></span>
<span><span class="va">speciesToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Pice_Gla"</span>, <span class="st">"Popu_Tre"</span>, <span class="st">"Pinu_Con"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sppEquiv</span> <span class="op">&lt;-</span> <span class="fu">LandR</span><span class="fu">::</span><span class="va"><a href="https://landr.predictiveecology.org/reference/sppEquivalencies_CA.html">sppEquivalencies_CA</a></span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/get.html">get</a></span><span class="op">(</span><span class="va">speciesNameConvention</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span></span>
<span>    <span class="va">speciesToUse</span><span class="op">]</span></span>
<span><span class="co"># Assign a colour convention for graphics for each species</span></span>
<span><span class="va">sppColorVect</span> <span class="op">&lt;-</span> <span class="fu">LandR</span><span class="fu">::</span><span class="fu"><a href="https://landr.predictiveecology.org/reference/sppColors.html">sppColors</a></span><span class="op">(</span><span class="va">sppEquiv</span>, <span class="va">speciesNameConvention</span>,</span>
<span>    newVals <span class="op">=</span> <span class="st">"Mixed"</span>, palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Usage example</span></span>
<span><span class="va">modules</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"Biomass_speciesData"</span><span class="op">)</span></span>
<span><span class="va">objects</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>studyAreaLarge <span class="op">=</span> <span class="va">studyAreaLarge</span>, sppEquiv <span class="op">=</span> <span class="va">sppEquiv</span>,</span>
<span>    sppColorVect <span class="op">=</span> <span class="va">sppColorVect</span><span class="op">)</span></span>
<span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Biomass_speciesData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>coverThresh <span class="op">=</span> <span class="fl">5L</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="run-module" class="section level3" number="2.3.5">
<h3>
<span class="header-section-number">2.3.5</span> Run module<a class="anchor" aria-label="anchor" href="#run-module"><i class="fas fa-link"></i></a>
</h3>
<p>Note that because this is a data module (i.e., only attempts to prepare data for
the simulation) we are not iterating it and so both the start and end times are
set to <code>1</code> here.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">opts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>reproducible.useCache <span class="op">=</span> <span class="cn">TRUE</span>, reproducible.destinationPath <span class="op">=</span> <span class="va">paths</span><span class="op">$</span><span class="va">inputPath</span>,</span>
<span>    <span class="va">reproducible.useCache</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mySimOut</span> <span class="op">&lt;-</span> <span class="fu">simInitAndSpades</span><span class="op">(</span>times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>start <span class="op">=</span> <span class="fl">1</span>, end <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    modules <span class="op">=</span> <span class="va">modules</span>, parameters <span class="op">=</span> <span class="va">params</span>, objects <span class="op">=</span> <span class="va">objects</span>,</span>
<span>    paths <span class="op">=</span> <span class="va">paths</span>, .plotInitialTime <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span><span class="va">opts</span><span class="op">)</span></span></code></pre></div>
<p>Here are some of outputs of <em>Biomass_speciesData</em> (dominant species) in a
randomly generated study area within Canada.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-Biomass-speciesDataOutPlots"></span>
<img src="modules/Biomass_speciesData/figures/testRunFigure.png" alt="Biomass_speciesData automatically generates a plot of species dominance and number of presences in the study area when `.plotInitialTime=1` is passed as an argument." width="70%"><p class="caption">
Figure 2.1: <em>Biomass_speciesData</em> automatically generates a plot of species dominance and number of presences in the study area when <code>.plotInitialTime=1</code> is passed as an argument.
</p>
</div>
</div>
</div>
<div id="bsppdata-refs" class="section level2" number="2.4">
<h2>
<span class="header-section-number">2.4</span> References<a class="anchor" aria-label="anchor" href="#bsppdata-refs"><i class="fas fa-link"></i></a>
</h2>

</div>
</div>
<div class="footnotes">
<hr>
<ol start="7">
<li id="fn7"><p>Raw data layers downloaded by the module are saved in
`dataPath(sim)`, which can be controlled via
`options(reproducible.destinationPath = …)`.<a href="landr-biomass_speciesdata-module.html#fnref7" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="landr-data-and-calibration-modules.html">LandR Data and Calibration Modules</a></div>
<div class="next"><a href="landr-biomass_borealdataprep-module.html"><span class="header-section-number">3</span> LandR Biomass_borealDataPrep Module</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#landr-biomass_speciesdata-module"><span class="header-section-number">2</span> LandR Biomass_speciesData Module</a></li>
<li>
<a class="nav-link" href="#module-overview-1"><span class="header-section-number">2.1</span> Module Overview</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#quick-links-1"><span class="header-section-number">2.1.1</span> Quick links</a></li>
<li><a class="nav-link" href="#module-summary"><span class="header-section-number">2.1.2</span> Module summary</a></li>
<li><a class="nav-link" href="#bsppdata-links-modules"><span class="header-section-number">2.1.3</span> Links to other modules</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#module-manual-1"><span class="header-section-number">2.2</span> Module manual</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#bsppdata-general-functioning"><span class="header-section-number">2.2.1</span> General functioning</a></li>
<li><a class="nav-link" href="#bsppdata-inputs-list"><span class="header-section-number">2.2.2</span> List of input objects</a></li>
<li><a class="nav-link" href="#bsppdata-params-list"><span class="header-section-number">2.2.3</span> List of parameters</a></li>
<li><a class="nav-link" href="#bsppdata-outputs-list"><span class="header-section-number">2.2.4</span> List of outputs</a></li>
<li><a class="nav-link" href="#bsppdata-sim-flow"><span class="header-section-number">2.2.5</span> Simulation flow and module events</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#bsppdata-example"><span class="header-section-number">2.3</span> Usage example</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#load-spades-and-other-packages."><span class="header-section-number">2.3.1</span> Load SpaDES and other packages.</a></li>
<li><a class="nav-link" href="#bsppdata-example-libs"><span class="header-section-number">2.3.2</span> Set up R libraries</a></li>
<li><a class="nav-link" href="#bsppdataexample-pkg-mods"><span class="header-section-number">2.3.3</span> Get the module and module dependencies</a></li>
<li><a class="nav-link" href="#setup-simulation"><span class="header-section-number">2.3.4</span> Setup simulation</a></li>
<li><a class="nav-link" href="#run-module"><span class="header-section-number">2.3.5</span> Run module</a></li>
</ul>
</li>
<li><a class="nav-link" href="#bsppdata-refs"><span class="header-section-number">2.4</span> References</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/PredictiveEcology/LandR-Manual/blob/master/modules/Biomass_speciesData/Biomass_speciesData2.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/PredictiveEcology/LandR-Manual/edit/master/modules/Biomass_speciesData/Biomass_speciesData2.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>LandR Manual</strong>: v. 1.0.1.9000" was written by </p>
<p>Edited by: Ceres Barros, Alex M. Chubaty, Ian M. S. Eddy, Eliot J. B. McIntire</p>. It was last built on Last updated: 2022-10-28.
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
